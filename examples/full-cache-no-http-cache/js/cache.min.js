(function(c,q){function n(){c[g]||(c[g]={});return c[g]}var g="app",h;h=n();h.namespace=h.ns=function(l,f){if(l){l=String(l);var p=l.split("."),d=p.length,a=c[g],b;a||(c[g]={});if(!p)return!1;for(b=0;b<d;b+=1)a[p[b]]||(a[p[b]]={}),b===d-1&&f!==q&&(a[p[b]]=f),a=a[p[b]];return a}return!1};c[g]=h;c.getNamespace=c.getNs=n})(window);
(function(c,q){function n(){if(!(this instanceof n))return new n;this.m=[];this.r=null;this.f=!1}n.prototype=n.fn={add:function(g){this.f?g(this.r):this.m.push(g)},flush:function(g){if(!this.f)for(this.r=g,this.f=!0;this.m[0];)this.m.shift()(g)}};c.ns("helpers.queue",n)})(window.getNs());
(function(c,q,n,g){var h=function(){var c=[];return{isString:function(f){return"string"===typeof f||f instanceof String},isFunction:function(f){return"function"===typeof f||f instanceof Function},isArray:function(f){var c=Array.isArray,d=Object.prototype.toString;h.isArray=c&&"function"===typeof c?function(a){return c(a)}:d&&"function"===d?function(a){return"[object Array]"===d.call(a)}:function(a){return!!a&&!!a.sort&&"function"===typeof a.sort};return h.isArray(f)},inArray:function(f,g,d){h.inArray=
Array.prototype.indexOf?function(a,b,e){return c.indexOf.call(b,a,e)}:function(a,b,e){var m=b.length,u=0;if(e)return b[e]&&b[e]===a?e:-1;for(u=0;u<m;u+=1)if(b[u]===a)return u;return-1};return h.inArray(f,g,d)},callback:function(f){h.isFunction(f)||(f=function(){return g});return f},url:function(f){if(h.isString(f)){var c=q.createElement("a"),d;c.href=f;d=c.pathname.match(/\/([^\/?#]+)$/i);return{source:f,protocol:c.protocol,host:c.hostname,port:c.port,query:c.search,file:d?d[1]:"/",hash:c.hash,path:c.pathname.replace(/^([^\/])/,
"/$1"),extension:function(a){a=a.split(".");return a.length?a[a.length-1]:!1}(f),folder:function(){var a=f.lastIndexOf("/");return f.substr(0,a+1)}()}}},trim:function(f){if(!h.isString(f))return f;h.isFunction(String.prototype.trim)||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});return f.trim()}}}();n.ns("helpers.utils",h)})(window,document,window.getNs());(function(c,q,n,g){n.namespace("helpers.console",{})})(window,document,window.getNs());
(function(c,q,n){var g=function(){var c=q.helpers.utils;return{getXhr:function(){for(var c=null,f=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],g=f.length,d=0,d=0;d<g;d+=1){try{c=f[d]()}catch(a){continue}break}return c},xhr:function(l,f,p,d){var a=g.getXhr(),b,e="GET";f=c.callback(f);if(a)if(l){d!==n?e="POST":d=null;p===n&&(p=!0);b=function(){if(4===
a.readyState&&(200<=a.status&&400>a.status||0===a.status))try{var b=a.responseText;b?f(b):f(!1)}catch(e){f(!1)}else 4===a.readyState&&f(!1)};a.open(e,l,p);try{a.onreadystatechange!==n?a.onreadystatechange=b:a.onload!==n&&(a.onload=b)}catch(m){}a.send(d)}else f(!1);else f(!1)}}}();q.namespace("helpers.ajax",g)})(window,window.getNs());
(function(c,q,n,g){var h=function(){return{on:function(g,f,p){h.on="function"===typeof c.addEventListener?function(d,a,b){d.addEventListener(a,b,!1)}:"function"===typeof q.attachEvent?function(d,a,b){d.attachEvent("on"+a,b)}:function(d,a,b){d["on"+a]=b};h.on(g,f,p)},off:function(g,f,p){h.off="function"===typeof c.removeEventListener?function(d,a,b){d.removeEventListener(a,b,!1)}:"function"===typeof q.detachEvent?function(d,a,b){d.detachEvent("on"+a,b)}:function(d,a){d["on"+a]=null};h.off(g,f,p)}}}();
n.namespace("helpers.events",h)})(window,document,window.getNs());(function(c,q,n,g){var h=function(){var l=null,f=c.JSON;return{getJson:function(){null===l&&f&&f.stringify&&(l=f);return l},jsonToString:function(c,d,a){var b=!1;null===l&&(l=h.getJson());l&&(l.stringify&&c!==g)&&(b=l.stringify(c,d,a));return b},jsonToObject:function(c,d){var a=!1;null===l&&(l=h.getJson());l&&(l.parse&&c!==g)&&(a=l.parse(String(c),d));return a}}}();n.namespace("helpers.json",h)})(window,document,window.getNs());
(function(c,q,n,g){var h=function(){function h(){d===g&&(e(c,"online",h),e(c,"offline",h));d=q.onLine!==g?!!q.onLine:!0}var f,p,d,a,b=(q.userAgent||q.vendor||c.opera).toLowerCase(),e=n.helpers.events.on;return{isMsie:function(){p===g&&(p=null!==b.match(/(msie)/));return p},isOpera:function(){f===g&&(f=null!==b.match(/(opera)/));return f},isOnline:function(){d===g&&h();return d},hasCanvas:function(){if(a===g){var b=document.createElement("canvas");a=!(!b.getContext||!b.getContext("2d"))}return a}}}();
n.ns("helpers.client",h)})(window,window.navigator,window.getNs());
(function(c,q,n){function g(g,f){f&&(f.dom?g=f.dom:f.id&&(g=c.getElementById(f.id)));return g}var h=function(){var l=q.helpers,f=l.utils,p=l.client,d=[],a=[],b=[],e=[],m=c.getElementsByTagName("head")[0];return{nuke:function(){d=[];a=[];b=[];e=[]},createDomNode:function(b,a){var e=c.createElement(b),m;if(a)for(m in a)a.hasOwnProperty(m)&&e.setAttribute(m,a[m]);return e},getAttribute:function(b,a){return b.getAttribute(a)},setAttribute:function(b,a,e){b.setAttribute(a,e)},appendCss:function(b,a,e,
s,k){if(-1===f.inArray(b,d)||k){var r=null,t=!1,v,l,r=g(r,s);if(null!==a){r||(r=h.createDomNode("style",{type:"text/css"}),r.className="lazyloaded");r.onerror=function(){e(!1)};s||m.appendChild(r);try{v=c.createTextNode(a),r.appendChild(v)}catch(n){r.styleSheet.cssText=a}finally{e(!0)}}else null!==b&&(r||(r=h.createDomNode("link",{rel:"stylesheet",type:"text/css"}),r.className="lazyloaded"),r.onerror=r.error=function(){r.onload=r.load=null;t=!0;window.clearTimeout(l);e(!1)},s||m.appendChild(r),p.isMsie()||
p.isOpera()?r.onload=r.load=function(){r.onerror=r.error=null;t=!0;window.clearTimeout(l);e(!0)}:e(!0),r.href=b,l=window.setTimeout(function(){t||e(!1)},4E3));d.push(b)}else e(!0)},appendJs:function(b,e,d,s,k){if(-1===f.inArray(b,a)||k){k=h.createDomNode("script");var r=c.getElementsByTagName("script")[0],t=!1,v=!1,l;(k=g(k,s))?(k.type="text/javascript",k.className="lazyloaded",k.async=!0,k.onreadystatechange=k.onload=function(){v||this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||
(this.onreadystatechange=this.onload=null,t=v=!0,window.clearTimeout(l),a.push(b),d(!0))},k.onerror=function(){this.onload=this.onreadystatechange=this.onerror=null;window.clearTimeout(l);t=!0;d(!1)},s||(r?r.parentNode.insertBefore(k,r):m.appendChild(k)),e&&!v?(k.textContent?k.textContent=e:k.nodeValue?k.nodeValue=e:k.text=e,t=v=!0):null!==b&&(k.src=b),v&&(a.push(b),t=!0,d(!0)),t||(l=window.setTimeout(function(){v||d(!1)},5E3))):d(!1)}else d(!0)},appendImg:function(a,e,m,d){var k=null;(k=g(k,d))||
(k=new Image);k.onerror=function(){k.onload=k.onerror=null;m(!1)};k.onload=function(){k.onload=k.onerror=null;m(!0)};e?k.src=e:a&&(k.src=a);if(k.complete&&k.naturalWidth!==n)k.onload();b.push(a)},appendHtml:function(b,a,m,d){var k=g(null,d);if(k){if(a)try{k.innerHTML=a,d.id&&p.isMsie()&&c.styleSheets[0].addRule("#"+d.id+":after",'content: " ";')}catch(f){k.innerText=a}m(!0);e.push(b)}else m(!1)}}}();q.ns("helpers.dom",h)})(document,window.getNs());
(function(c,q,n){function g(b,a,d){var c=function(b){d(!1)};if("."===a[0]||""===a[0])a=a.slice(1);a[0]?b.getDirectory(a[0],{create:!0},function(b){a.length?g(b,a.slice(1),d):d(!0)},c):d(!0)}function h(b,a,c){a=a.split("/");var f=a.length,h="",s=0;c=d(c);if(f){for(s=0;s<f-1;s+=1)h=h+a[s]+"/";g(b.root,h.split("/"),c)}else c(!0)}function l(b){if(!(this instanceof l))return new l(b);this.adapter=null;this.type=f;this.size=52428800;this.init(b)}var f="fileSystem";n=q.helpers;var p=n.json,d=n.utils.callback,
a=null,b=c.requestFileSystem||c.webkitRequestFileSystem||c.moz_requestFileSystem;l.prototype=l.fn={isSupported:function(){null===a&&(a=!!b&&(!!c.Blob||!!c.BlobBuilder)&&c.FileReader);return a},open:function(e){var m=this,f=m.adapter,g=function(b){e(!1)};e=d(e);a?null===f?(c.requestFileSystem=b,c.requestFileSystem(c.TEMPORARY,m.size,function(b){f=m.adapter=b;try{m.create("test-item",p.jsonToString({test:"test-content"}),function(b){b?m.remove("test-item",function(){e(f)}):e(!1)})}catch(a){e(!1)}},
g)):e(f):e(!1)},create:function(b,m,c){c=d(c);if(b&&a){var f=this.adapter,g=function(b){c(!1,b)};h(f,b,function(){f.root.getFile(b,{create:!0},function(b){b.createWriter(function(b){var a;b.onwriteend=function(){c(!0)};b.onerror=g;try{Blob?(a=new Blob([m],{type:"text/plain"}),b.write(a)):BlobBuilder&&(a=new BlobBuilder,a.append(m),b.write(a.getBlob("application/json")))}catch(e){g(e)}},g)},g)})}else c(!1)},read:function(b,m){m=d(m);if(b&&a){var c=this.adapter,f=function(b){m(!1,b)};h(c,b,function(){c.root.getFile(b,
{create:!1},function(b){b.file(function(b){var a=new FileReader;a.onloadend=function(){m(this.result)};a.onerror=f;a.onabort=f;a.readAsText(b)},f)},f)})}else m(!1)},update:function(b,a,d){this.create(b,a,d)},remove:function(b,m){m=d(m);if(b&&a){var c=this.adapter,f=function(b){m(!1,b)};h(c,b,function(){c.root.getFile(b,{create:!1},function(b){b.remove(function(){m(!0)},f)},f)})}else m(!1)},init:function(b){return this.isSupported()?(b&&b.size&&(this.size=b.size),this):!1}};q.ns("cache.storage.adapter."+
f,l)})(window,window.getNs());
(function(c,q,n){function g(d){if(!(this instanceof g))return new g(d);this.adapter=null;this.type=h;this.dbName="cache";this.dbVersion="1.0";this.dbTable="offline";this.dbDescription="offline cache";this.dbKey="key";this.init(d)}var h="indexedDatabase",l=q.helpers.utils.callback,f=null,p=c.indexedDB||c.webkitIndexedDB||c.mozIndexedDB||c.OIndexedDB||c.msIndexedDB;g.prototype=g.fn={isSupported:function(){null===f&&(f=!!p);return f},create:function(d,a,b){b=l(b);if(d&&f){var e=this.dbTable,m=this.adapter.transaction([e],
"readwrite");d=m.objectStore(e).put({key:d,content:a});m.onerror=function(a){b(!1,a)};d.onerror=function(a){b(!1,a)};d.onsuccess=function(){b(!0)}}else b(!1)},read:function(d,a){a=l(a);if(d&&f){var b=this.dbTable,e=this.adapter.transaction([b],"readonly"),b=e.objectStore(b).get(d);e&&b?(e.onerror=function(b){a(!1,b)},b.onerror=function(b){a(!1,b)},b.onsuccess=function(b){b.target.result&&b.target.result.content?a(b.target.result.content):a(!1)}):a(!1)}else a(!1)},update:function(d,a,b){this.create(d,
a,b)},remove:function(d,a){a=l(a);if(d&&f){var b=this.dbTable,e=this.adapter.transaction([b],"readwrite"),b=e.objectStore(b).put({key:d,content:""});e.onerror=function(b){a(!1,b)};b.onerror=function(b){a(!1,b)};b.onsuccess=function(){a(!0)}}else a(!1)},open:function(d,a){a||(a=!1);d=l(d);var b=this,e=null,m=null,f=null,g=b.dbName,h=b.dbTable,s=function(a){a||d(!1);b.create("test-item",'{test: "test-content"}',function(e){e?b.remove("test-item",function(){d(a)}):d(!1)})},k,r,t,v,q;if(null===b.adapter)if(e=
p){c.webkitIndexedDB!==n&&(c.IDBTransaction=c.webkitIDBTransaction,c.IDBKeyRange=c.webkitIDBKeyRange);k=function(a){a.createIndex(b.dbKey,b.dbKey,{unique:!0});a.createIndex("content","content",{unique:!1})};r=function(a){var e=m.result,c,g;b.adapter=e;b.dbVersion===e.version||!e.setVersion&&"function"!==typeof e.setVersion?(b.adapter=e,s(e)):(f=a.currentTarget.result.setVersion(b.dbVersion),f.onfailure=function(b){d(!1)},f.onsuccess=function(a){c=m.result;try{g=c.createObjectStore(h,{keyPath:b.dbKey}),
k(g)}catch(e){d(!1)}})};t=function(a){a=m.result.createObjectStore(h,{keyPath:b.dbKey});k(a)};v=function(e){a||b.open(d,!0);d(!1)};q=function(b){d(!1)};if(a)try{m=e.open(g,b.dbVersion)}catch(w){m=e.open(g)}else m=e.open(g);m.onsuccess=r;m.onupgradeneeded=t;m.onerror=v;m.onblocked=q}else d(!1);else s(b.adapter)},init:function(d){return this.isSupported()?(d&&(d.name&&(this.dbName=String(d.name)),d.version&&(this.dbVersion=parseInt(d.version,10)),d.table&&(this.dbTable=d.table),d.description&&(this.dbDescription=
String(d.description)),d.key&&(this.dbKey=d.key)),this):!1}};q.ns("cache.storage.adapter."+h,g)})(window,window.getNs());
(function(c,q,n){function g(a,b,e,d,c,f){!f&&a?a.transaction(function(a){a.executeSql(b,e,d,c)}):f?f.executeSql(b,e,d,c):c(null,{code:0,message:l+" isn't available"})}function h(a){if(!(this instanceof h))return new h(a);this.adapter=null;this.type=l;this.dbName="cache";this.dbVersion="1.0";this.dbDescription="resource cache";this.dbTable="websql";this.dbSize=4194304;this.init(a)}var l="webSqlDatabase",f=q.helpers.utils.callback,p=null,d=c.openDatabase;h.prototype=h.fn={isSupported:function(){null===
p&&(p=!!d);return p},create:function(a,b,e){e=f(e);a&&p?g(this.adapter,"INSERT INTO "+this.dbTable+" (key, content) VALUES (?,?);",[a,b],function(){e(!0)},function(b,a){e(!1,a,{transaction:b})}):e(!1)},read:function(a,b){b=f(b);a&&p?g(this.adapter,"SELECT content FROM "+this.dbTable+" WHERE key=?;",[a],function(a,d){var c=!1;d&&(d.rows&&1===d.rows.length)&&(c=d.rows.item(0).content);b(c,null,{transaction:a})},function(a,d){b(!1,d,{transaction:a})}):b(!1)},update:function(a,b,e){e=f(e);a&&p?g(this.adapter,
"UPDATE "+this.dbTable+" SET content = ?  WHERE key=?;",[b,a],function(){e(!0)},function(b,a){e(!1,a,{transaction:b})}):e(!1)},remove:function(a,b){b=f(b);a&&p?g(this.adapter,"DELETE FROM "+this.dbTable+" WHERE key = ?;",[a],function(){b(!0)},function(a,d){b(!1,d,{transaction:a})}):b(!1)},open:function(a){a=f(a);if(p){var b=this,e=b.adapter,m,h=function(e){e||a(!1);m=function(d){d?b.remove("test-item",function(){a(e)}):a(!1)};b.read("test-item",function(a){a?b.update("test-item",'{test: "test-content"}',
m):b.create("test-item",'{test: "test-content"}',m)})},l=function(a,e){g(a,"CREATE TABLE IF NOT EXISTS "+b.dbTable+"(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, key TEXT NOT NULL UNIQUE, content TEXT NOT NULL);",[],function(){h(b.adapter)},function(b){h(!1)},e)},n=function(b){l(null,b)},s=function(b){a(!1)};try{if(null===e&&b.isSupported())if(b.adapter=e=d(b.dbName,"",b.dbDescription,b.dbSize),String(e.version)!==String(b.dbVersion)&&e.changeVersion&&"function"===typeof e.changeVersion)try{e.changeVersion(e.version,
b.dbVersion,n,s)}catch(k){a(!1)}else e=c.openDatabase(b.dbName,b.dbVersion,b.dbDescription,b.dbSize),l(e);else b.isSupported()&&h(e)}catch(r){a(!1)}}else a(!1)},init:function(a){return this.isSupported()?(a&&(a.description&&(this.dbDescription=a.description),a.name&&(this.dbName=a.name),a.size&&(this.dbSize=a.size),a.table&&(this.dbTable=a.table),a.version&&(this.dbVersion=String(a.version))),this):!1}};q.ns("cache.storage.adapter."+l,h)})(window,window.getNs());
(function(c,q,n){function g(b){b=p(b);switch(b){case "local":b="localStorage";break;case "session":b="sessionStorage";break;default:b="localStorage"}return b}function h(b){if(!(this instanceof h))return new h(b);this.adapter=null;this.type=l;this.lifetime="local";this.asynch=!0;this.init(b)}var l="webStorage",f=q.helpers.utils,p=f.trim,d=f.callback,a=null;h.prototype=h.fn={isSupported:function(){var b=g(this.lifetime);if(null===a)try{a=!!c[b]&&!!c[b].getItem}catch(e){a=!1}return a},create:function(b,
a,c){var f=this,g=!0,h=function(b){if(f.asynch)c(b);else return b};c=d(c);if(!b)return h(!1);try{f.adapter.setItem(b,a)}catch(s){g=!g}return h(g)},read:function(b,a){var c=this,f,g=!0,h=function(b){if(c.asynch)a(b);else return b};a=d(a);if(!b)return h(!1);try{g=(f=c.adapter.getItem(b))?f:!1}catch(s){g=!g}return h(g)},update:function(b,a,d){if(this.asynch)this.create(b,a,d);else return this.create(b,a,d)},remove:function(b,a){var c=this,f=!0,g=function(b){if(c.asynch)a(b);else return b};a=d(a);if(!b)return g(!1);
try{c.adapter.removeItem(b)}catch(h){f=!f}return g(f)},open:function(b){var a=this,f=a.adapter,h=g(a.lifetime),l,n,s=function(d){if(a.asynch)b(d);else return d};b=d(b);if(null===f)try{if(f=a.adapter=c[h],a.asynch)a.create("test-item",'{test: "test-content"}',function(d){d?a.remove("test-item",function(){b(f)}):b(!1)});else{if(l=a.create("test-item",'{test: "test-content"}'))if(n=a.remove("test-item"))return f;return!1}}catch(k){return s(!1)}else if(a.isSupported())return s(f)},init:function(b){return this.isSupported()?
(b&&(b.lifetime&&(this.lifetime=p(String(b.lifetime))),b.asynch!==n&&(this.asynch=!!b.asynch)),this):!1}};q.ns("cache.storage.adapter."+l,h)})(window,window.getNs());
(function(c,q,n,g){function h(b,a){a.isLoaded||(a.isLoaded=!0,a.progressCallback(100),c.setTimeout(function(){b()},a.delay))}function l(b){if(!(this instanceof l))return new l(b);this.adapter=null;this.type=f;this.isLoaded=!1;this.delay=0;this.opened=!0;this.message="New version available. Update page?";this.init(b)}var f="applicationCache",p=n.helpers,d=p.dom,a=p.events.on,b=p.utils.callback,e=null,m=q.getElementsByTagName("html")[0],u=c.applicationCache;l.prototype=l.fn={isSupported:function(){null===
e&&(e=!!u&&!!d.getAttribute(m,"manifest"));return e},open:function(d,f){var e=this,k=e.adapter,m=0,l,v;e.opened=!0;d=b(d);f&&f.progress&&(l=f.progress);l=e.progressCallback=b(l);if(e.isSupported()&&null!==k){v=function(){try{k.swapCache()}catch(b){}confirm(e.message)?c.location.reload(!0):h(d,e);return!1};a(k,"noupdate",function(){h(d,e);return!1});a(k,"downloading",function(){m=0;return!1});a(k,"progress",function(b){var a=0;e.delay=500;m+=1;a=b&&b.lengthComputable!==g?Math.round(100*b.loaded/b.total):
Math.round(100*m/20);l(a);return!1});a(k,"cached",function(){h(d,e);return!1});a(k,"updateready",function(){v()});a(k,"obsolete",function(){c.location.reload(!0);return!1});a(k,"error",function(){h(d,e);return!1});switch(k.status){case k.UNCACHED:h(d,e);break;case k.IDLE:h(d,e);break;case k.UPDATEREADY:v();break;case k.OBSOLETE:h(d,e)}a(c,"online",function(){try{k.update()}catch(b){}});c.setTimeout(function(){e.isLoaded||h(d,e)},12E3)}else h(d,e)},init:function(b){this.isSupported()&&(null===this.adapter&&
(this.adapter=u),b&&(b.message&&(this.message=String(b.message)),b.delay!==g&&(this.delay=parseInt(b.delay,10))));return this}};n.ns("cache.storage.adapter."+f,l)})(window,document,window.getNs());
(function(c,q,n,g){function h(b,a,d){d.timeoutXhr=c.setTimeout(function(){a(!1)},4E3);D(b,function(b){c.clearTimeout(d.timeoutXhr);delete d.timeoutXhr;b?a(b):a(!1)})}function l(b){var a=null;try{a=k.jsonToObject(b)}catch(d){}return a}function f(b,a,d){if(x){var e=q.createElement("canvas"),f,c=new Image,k=null,h=0,m=0;d||(d="jpeg");c.onerror=function(){c.onload=c.onerror=null;a()};c.onload=function(){c.onload=c.onerror=null;h=e.height=c.height;m=e.width=c.width;f=e.getContext("2d");f.fillStyle="rgba(50, 50, 50, 0)";
f.fillRect(0,0,m,h);f.drawImage(c,0,0);k=e.toDataURL("image/"+d);a(k)};c.src=b;if(c.complete&&c.naturalWidth!==g)c.onload()}else a(!1)}function p(b){var a=b.data,d=b.url;"css"===b.type&&(d=s.url(d),d=d.folder,a=a.replace(/url\(\../g,"url("+d+".."),a=a.replace(/url\(\'../g,"url('"+d+".."),a=a.replace(/url\(\"../g,'url("'+d+".."),b.data=a);return b}function d(b,a){return{ajax:b.ajax,data:b.data,expires:(new Date).getTime()+(b.lifetime||a.lifetime),group:b.group!==g?b.group:a.group,lastmod:b.lastmod||
a.lastmod,lifetime:b.lifetime!==g?b.lifetime:a.lifetime,type:b.type||a.type,version:b.version||a.version}}function a(b,a,d){var e=b.type,c=b.url,g=b.data;b.ajax?"img"===e?f(c,a):h(c,a,b):g?a(g):d(!1)}function b(b){return B&&B[b]?!!B[b]:!1}function e(b,a){var d=null,c,f;b&&b.length?(c=b[0].type,f=b.slice(1),A[c]?d=new A[c](C):e(f,a),d&&d.isSupported()?d.open(function(c){c?(B=b[0],a(d)):e(f,a)}):e(f,a)):a(!1)}function m(b,a,d){var c=null,f=0,g;if(d)try{A[d]?(c=new A[d](C))&&c.isSupported()?c.open(function(e){if(e){g=
a.length;for(f=0;f<g;f+=1)a[f].type===d&&(B=a[f]);B?b(c):m(b,a)}else m(b,a)}):m(b,a):m(b,a)}catch(k){m(b,a)}else e(a,b)}function u(b,a){if(!(this instanceof u))return new u(b,a);this.isEnabled=!0;this.appCacheAdapter=this.adapter=null;this.adapters={types:E,defaults:C};this.resources={defaults:F};this.init(b,a)}var y=n.helpers,z=y.client,s=y.utils,k=y.json,y=y.ajax,r=s.isArray,t=s.callback,v=k.getJson(),D=y.xhr,w=s.trim,A=n.cache.storage.adapter,x=z.hasCanvas(),E=[{type:"fileSystem",css:!0,js:!0,
html:!0,img:!0},{type:"indexedDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webSqlDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webStorage",css:!0,js:!0,html:!0,img:!0}],C={name:"localcache",table:"cache",description:"local resource cache",size:4194304,version:"1.0",key:"key",lifetime:"local",offline:!0},B=null,F={ajax:!0,lifetime:2E4,group:0,lastmod:(new Date).getTime(),type:"css",version:1};u.prototype=u.fn={create:function(c,e){e=t(e);if(c&&c.url){var f=this,g=c.url,h=c.type;a(c,function(a){if(a)if(c.data=
a,c=p(c),null!==f.adapter&&b(h)){a=k.jsonToString(g);var m=d(c,f.resources.defaults),l=k.jsonToString(m);c.expires=m.expires;c.version=m.version;try{f.adapter.create(a,l,function(b){b?e(c):e(!1)})}catch(t){e(c)}}else e(c);else e(c)},e)}else e(!1)},read:function(a,d){d=t(d);if(a&&a.url){var c=this,e=a.url,f=a.type;if(null!==this.adapter&&b(f))try{c.adapter.read(k.jsonToString(e),function(b){b?(a=l(b))?(a.url=e,d(a,!0)):c.remove({url:e,type:f},function(){d(!1)}):d(!1)})}catch(g){h(e,function(b){a.data=
b;d(a,!0)},a)}else d(a)}else d(!1)},update:function(c,e){e=t(e);if(c&&c.url){var f=this,g=c.url,m=c.type;a(c,function(a){if(a)if(c.data=a,c=p(c),null!==f.adapter&&b(m)){a=k.jsonToString(g);var h=d(c,f.resources.defaults),l=k.jsonToString(h);c.expires=h.expires;c.version=h.version;try{f.adapter.update(a,l,function(b){b?e(c):e(!1)})}catch(t){e(c)}}else e(c);else f.read(c,function(b){b&&b.data?(c.data=b.data,e(c)):e(!1)})},e)}else e(!1)},remove:function(a,c){c=t(c);if(a&&a.url){var d=a.url,e=a.type;
null!==this.adapter&&b(e)?this.adapter.remove(k.jsonToString(d),function(b){b?c(a):c(!1)}):c(a)}else c(!1)},init:function(b,a){var c=this,d=!1,e,f,k,h;b=t(b);a&&a.isEnabled!==g&&(c.isEnabled=!!a.isEnabled);if(c.isEnabled&&v){if(a){if(a.adapters){e=a.adapters;if(e.types&&r(e.types)){f=e.types;k=f.length;for(h=0;h<k;h+=1)f[h].css===g&&(f[h].css=!0),f[h].js===g&&(f[h].js=!0),f[h].img===g&&(f[h].img=!0),f[h].html===g&&(f[h].html=!0);c.adapters.types=f}e.defaults&&(f=e.defaults,k=c.adapters.defaults,f.name&&
(k.name=w(String(f.name))),f.table&&(k.table=w(String(f.table))),f.description&&(k.description=w(String(f.description))),f.size&&(k.size=parseInt(f.size,10)),f.version&&(k.version=w(String(f.version))),f.key&&(k.key=w(String(f.key))),f.lifetime&&(k.lifetime=w(String(f.lifetime))),f.offline!==g&&(k.offline=!!f.offline));e.preferredType&&(d=w(String(e.preferredType)))}a.resources&&(e=a.resources,e.defaults&&(e=e.defaults,f=c.resources.defaults,e.ajax!==g&&(f.ajax=!!e.ajax),e.lifetime!==g&&(f.lifetime=
parseInt(e.lifetime,10)),e.group!==g&&(f.group=parseInt(e.group,10)),e.lastmod!==g&&(f.lastmod=parseInt(e.lastmod,10)),e.type&&(f.type=w(String(e.type))),e.group!==g&&(f.version=parseFloat(e.version)),e.loaded&&(f.loaded=t(e.loaded))))}m(function(a){a||(c.isEnabled=!1);c.adapter=a;b(c)},c.adapters.types,d);c.adapters.defaults.offline&&(A.applicationCache&&!c.appCacheAdapter)&&(c.appCacheAdapter=new A.applicationCache(C))}else b(c)}};n.ns("cache.storage.controller",u)})(window,document,window.getNs());
(function(c,q){function n(b){var c=a(b.type);if("js"!==c||"css"!==c||"html"!==c||"img"!==c||"custom"!==c){switch(f.url(b.url).extension){case "js":b="js";break;case "css":b="css";break;case "html":b="html";break;case "jpg":case "jpeg":case "png":b="img";break;default:b="custom"}c=b}return c}function g(b,a){if(!(this instanceof g))return new g(b,a);this.storage=null;this.init(b,a)}var h=c.helpers,l=h.dom,f=h.utils,p=h.client,d=f.isArray,a=f.trim,b=f.callback;g.prototype=g.fn={load:function(c,f){var g=
this,h=(new Date).getTime(),z=function(){var b=0,a=0,c=null;return{init:function(f,d){c=d;b=f;a=0},loaded:function(){a+=1;a===b&&c()}}}(),s=function(b,a,c){var f=b.url,d=function(){b.loaded(b);z.loaded()},e=b.node||null;c=!!c;switch(b.type){case "js":l.appendJs(f,a,d,e,c);break;case "css":l.appendCss(f,a,d,e,c);break;case "img":l.appendImg(f,a,d,e,c);break;case "html":l.appendHtml(f,a,d,e,c);break;default:d()}},k=function(a){var c=a.data||null,f=function(a,b){a&&a.data?s(a,a.data,b):s(a,null,b)},
d=g.storage,e=d.resources.defaults;a.ajax=a.ajax!==q?!!a.ajax:e.ajax;a.loaded=a.loaded!==q?b(a.loaded):b(e.loaded);d.read(a,function(b){if(b&&b.data){var e=a,k=g.storage.resources.defaults,m=parseInt(b.lifetime,10),l=b.version,t=b.lastmod?b.lastmod:0,n=!1,r,x=e.lastmod?e.lastmod:0,n=!0;r=!1;e.version=r=e.version!==q?parseFloat(e.version):k.version;e.group=e.group!==q?parseFloat(e.group):k.group;x&&t?(e.lastmod=parseInt(x,10),n=t===e.lastmod):!x&&t?x=t:x||(x=k.lastmod);n=n&&r===l;r=0!==m&&(-1!==m&&
n&&b.expires>h||-1===m&&n);e.lastmod=x;e.isValid=r;a=e;a.isValid||!p.isOnline()?(c=b.data)&&s(a,c):d.update(a,f)}else d.create(a,f)})},r=function(b,c){var e=0,d=b.length,f=null;z.init(d,c);for(e=0;e<d;e+=1)(f=b[e])&&f.url&&(f.url=a(f.url),f.type=n(f),k(f))},t=function(b,a,c){var e=b.length;for(c||(c=0);!b[c]&&c<e;)c+=1;c>=e?a(g):(e=b[c],r(e,function(){t(b,a,c+1)}))};(function(a,c){a&&d(a)||(a=[]);for(var e=a,g=[],k,h=0,l,n=e.length,h=0;h<n;h+=1)l=e[h],(k=l.group)||(k=0),k=g[k]?g[k]:g[k]=[],k.push(l);
a=g;c=b(f);t(a,c)})(c,f)},remove:function(c,f){var g=this.storage,h=function(b,c){var e=b.length,f,d,h=function(b,a){b===e-1&&c()};if(e)for(f=0;f<e;f+=1)(d=b[f])&&d.url&&(d.url=a(d.url),d.type=n(d),g.remove(d,h(f,d.url)));else c()};(function(a,c){a&&d(a)||(a=[]);c=b(f);h(a,c)})(c,f)},init:function(a,f){var d=this;a=b(a);c.cache.storage.controller(function(b){d.storage=b;a(b)},f);return d}};c.ns("cache.controller",g)})(window.getNs());
(function(c,q,n){function g(a){this.storage=this.controller=null;this.params=a;this.queue=new d;this.timeout=this.interval=this.calls=0}function h(a){var c=null,d=f.length,h;a||(a=z);if(b)for(h=0;h<d;h+=1)e(f[h].params)===e(a)&&(c=f[h]);c||(c=new g(a),f.push(c));return c}function l(a,b,f){var d=h(a),e,g,l,m=function(){e=d.interval;c.clearInterval(e);e=c.setInterval(function(){d.timeout=g=d.timeout+u;l=d.storage;d.controller&&(l&&(l.adapter||!l.isEnabled))&&(c.clearInterval(e),d.queue.flush());g>y&&
(c.clearInterval(e),f())},u)};d?d.storage?b(d):(d.queue.add(function(){b(d)}),d.calls+=1,1===d.calls?d.controller=new q.cache.controller(function(a){d.storage=a;d.controller?d.queue.flush():m()},a):m()):f()}var f=[],p=q.helpers,d=p.queue;n=p.utils;var p=p.json,a=n.isArray,b=p.getJson(),e=p.jsonToString,m=n.callback,u=15,y=5E3,z={};n=function(){return{load:function(b,c,d){c=m(c);l(d,function(e){a(b)?e.controller.load(b,c):"applicationCache"===b?(e=e.storage)&&e.appCacheAdapter?e.appCacheAdapter.open(c,
d):c(!1):c(!1)},function(){c(!1)});return this},remove:function(b,c,d){c=m(c);l(d,function(d){a(b)?d.controller.remove(b,c):c(!1)},function(){c(!1)});return this},setup:function(a){a&&(z=a);return this}}}();q.ns("cache.load",n.load);q.ns("cache.remove",n.remove);q.ns("cache.setup",n.setup)})(window,window.getNs());
