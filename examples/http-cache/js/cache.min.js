(function(k,s){function r(){k[h]||(k[h]={});return k[h]}var h="app",g;g=r();g.namespace=g.ns=function(g,m){if(g){g=String(g);var d=g.split("."),e=d.length,b=k[h],a;b||(k[h]={});if(!d)return!1;for(a=0;a<e;a+=1)b[d[a]]||(b[d[a]]={}),a===e-1&&m!==s&&(b[d[a]]=m),b=b[d[a]];return b}return!1};k[h]=g;k.getNamespace=k.getNs=r})(window);
(function(k,s){function r(){if(!(this instanceof r))return new r;this.m=[];this.r=null;this.f=!1}r.prototype=r.fn={add:function(h){this.f?h(this.r):this.m.push(h)},flush:function(h){if(!this.f)for(this.r=h,this.f=!0;this.m[0];)this.m.shift()(h)}};k.ns("helpers.queue",r)})(window.getNs());
(function(k,s,r,h){var g=function(){var l=null,m=[];return{isString:function(d){return"string"===typeof d||d instanceof String},isFunction:function(d){return"function"===typeof d||d instanceof Function},isArray:function(d){var e=Array.isArray,b=Object.prototype.toString;g.isArray=e&&"function"===typeof e?function(a){return e(a)}:b&&"function"===b?function(a){return"[object Array]"===b.call(a)}:function(a){return!!a&&!!a.sort&&"function"===typeof a.sort};return g.isArray(d)},inArray:function(d,e,b){g.inArray=
Array.prototype.indexOf?function(a,c,f){return m.indexOf.call(c,a,f)}:function(a,c,f){var b=c.length,e=0;if(f)return c[f]&&c[f]===a?f:-1;for(e=0;e<b;e+=1)if(c[e]===a)return e;return-1};return g.inArray(d,e,b)},callback:function(d){g.isFunction(d)||(d=function(){return h});return d},on:function(d,e,b){g.on="function"===typeof k.addEventListener?function(a,c,f){a.addEventListener(c,f,!1)}:"function"===typeof s.attachEvent?function(a,c,f){a.attachEvent("on"+c,f)}:function(a,c,f){a["on"+c]=f};g.on(d,
e,b)},off:function(d,e,b){g.off="function"===typeof k.removeEventListener?function(a,c,f){a.removeEventListener(c,f,!1)}:"function"===typeof s.detachEvent?function(a,c,f){a.detachEvent("on"+c,f)}:function(a,c){a["on"+c]=null};g.off(d,e,b)},getXhr:function(){for(var d=null,e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],b=e.length,a=0,a=0;a<
b;a+=1){try{d=e[a]()}catch(c){continue}break}return d},xhr:function(d,e,b,a){var c=g.getXhr(),f,w="GET";e=g.callback(e);if(c)if(d){a!==h?w="POST":a=null;b===h&&(b=!0);f=function(){if(4===c.readyState&&(200<=c.status&&400>c.status||0===c.status))try{var a=c.responseText;a?e(a):e(!1)}catch(f){e(!1)}else 4===c.readyState&&e(!1)};c.open(w,d,b);try{c.onreadystatechange!==h?c.onreadystatechange=f:c.onload!==h&&(c.onload=f)}catch(x){}c.send(a)}else e(!1);else e(!1)},getJson:function(){null===l&&(k.JSON&&
k.JSON.stringify)&&(l=k.JSON);return l},jsonToString:function(d){var e=!1;null===l&&(l=g.getJson());l&&d!==h&&(e=l.stringify(d));return e},jsonToObject:function(d){var e=!1;null===l&&(l=g.getJson());l&&d!==h&&(e=l.parse(d));return e},url:function(d){if(g.isString(d)){var e=s.createElement("a"),b;e.href=d;b=e.pathname.match(/\/([^\/?#]+)$/i);return{source:d,protocol:e.protocol,host:e.hostname,port:e.port,query:e.search,file:b?b[1]:"/",hash:e.hash,path:e.pathname.replace(/^([^\/])/,"/$1"),extension:function(a){a=
a.split(".");return a.length?a[a.length-1]:!1}(d),folder:function(){var a=d.lastIndexOf("/");return d.substr(0,a+1)}()}}},trim:function(d){if(!g.isString(d))return d;g.isFunction(String.prototype.trim)||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});return d.trim()}}}();r.ns("helpers.utils",g)})(window,document,window.getNs());
(function(k,s,r,h){var g=function(){function g(){e===h&&(c(k,"online",g),c(k,"offline",g));e=s.onLine!==h?!!s.onLine:!0}var m,d,e,b,a=(s.userAgent||s.vendor||k.opera).toLowerCase(),c=r.helpers.utils.on;return{isMsie:function(){d===h&&(d=null!==a.match(/(msie)/));return d},isOpera:function(){m===h&&(m=null!==a.match(/(opera)/));return m},isOnline:function(){e===h&&g();return e},hasCanvas:function(){if(b===h){var a=document.createElement("canvas");b=!(!a.getContext||!a.getContext("2d"))}return b}}}();
r.ns("helpers.client",g)})(window,window.navigator,window.getNs());
(function(k,s,r){function h(h,g){g&&(g.dom?h=g.dom:g.id&&(h=k.getElementById(g.id)));return h}var g=function(){var l=s.helpers,m=l.utils,d=l.client,e=[],b=[],a=[],c=[],f=k.getElementsByTagName("head")[0];return{nuke:function(){e=[];b=[];a=[];c=[]},createDomNode:function(a,c){var f=k.createElement(a),b;if(c)for(b in c)c.hasOwnProperty(b)&&f.setAttribute(b,c[b]);return f},getAttribute:function(a,c){return a.getAttribute(c)},setAttribute:function(a,c,f){a.setAttribute(c,f)},appendCss:function(a,c,b,
p,q){if(-1===m.inArray(a,e)||q){var n=null,l=!1,u,v,n=h(n,p);if(null!==c){n||(n=g.createDomNode("style",{type:"text/css"}),n.className="lazyloaded");n.onerror=function(){b(!1)};p||f.appendChild(n);try{u=k.createTextNode(c),n.appendChild(u)}catch(z){n.styleSheet.cssText=c}finally{b(!0)}}else null!==a&&(n||(n=g.createDomNode("link",{rel:"stylesheet",type:"text/css"}),n.className="lazyloaded"),n.onerror=n.error=function(){n.onload=n.load=null;l=!0;window.clearTimeout(v);b(!1)},p||f.appendChild(n),d.isMsie()||
d.isOpera()?n.onload=n.load=function(){n.onerror=n.error=null;l=!0;window.clearTimeout(v);b(!0)}:b(!0),n.href=a,v=window.setTimeout(function(){l||b(!1)},4E3));e.push(a)}else b(!0)},appendJs:function(a,c,e,p,q){if(-1===m.inArray(a,b)||q){q=g.createDomNode("script");var n=k.getElementsByTagName("script")[0],d=!1,u=!1,l;(q=h(q,p))?(q.type="text/javascript",q.className="lazyloaded",q.async=!0,q.onreadystatechange=q.onload=function(){u||this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||
(this.onreadystatechange=this.onload=null,d=u=!0,window.clearTimeout(l),b.push(a),e(!0))},q.onerror=function(){this.onload=this.onreadystatechange=this.onerror=null;window.clearTimeout(l);d=!0;e(!1)},p||(n?n.parentNode.insertBefore(q,n):f.appendChild(q)),c&&!u?(q.textContent?q.textContent=c:q.nodeValue?q.nodeValue=c:q.text=c,d=u=!0):null!==a&&(q.src=a),u&&(b.push(a),d=!0,e(!0)),d||(l=window.setTimeout(function(){u||e(!1)},5E3))):e(!1)}else e(!0)},appendImg:function(c,f,b,e){var q=null;(q=h(q,e))||
(q=new Image);q.onerror=function(){q.onload=q.onerror=null;b(!1)};q.onload=function(){q.onload=q.onerror=null;b(!0)};f?q.src=f:c&&(q.src=c);if(q.complete&&q.naturalWidth!==r)q.onload();a.push(c)},appendHtml:function(a,f,b,e){var q=h(null,e);if(q){if(f)try{q.innerHTML=f,e.id&&d.isMsie()&&k.styleSheets[0].addRule("#"+e.id+":after",'content: " ";')}catch(n){q.innerText=f}b(!0);c.push(a)}else b(!1)}}}();s.ns("helpers.dom",g)})(document,window.getNs());
(function(k,s,r){function h(a,f,b){var e=function(a){b(!1)};if("."===f[0]||""===f[0])f=f.slice(1);f[0]?a.getDirectory(f[0],{create:!0},function(a){f.length?h(a,f.slice(1),b):b(!0)},e):b(!0)}function g(a,f,b){f=f.split("/");var d=f.length,t="",p=0;b=e(b);if(d){for(p=0;p<d-1;p+=1)t=t+f[p]+"/";h(a.root,t.split("/"),b)}else b(!0)}function l(a){if(!(this instanceof l))return new l(a);this.adapter=null;this.type=m;this.size=52428800;this.init(a)}var m="fileSystem",d=s.helpers.utils,e=d.callback,b=null,
a=k.requestFileSystem||k.webkitRequestFileSystem||k.moz_requestFileSystem;l.prototype=l.fn={isSupported:function(){null===b&&(b=!!a&&(!!k.Blob||!!k.BlobBuilder)&&k.FileReader);return b},open:function(c){var f=this,g=f.adapter,h=function(a){c(!1)};c=e(c);b?null===g?(k.requestFileSystem=a,k.requestFileSystem(k.TEMPORARY,f.size,function(a){g=f.adapter=a;try{f.create("test-item",d.jsonToString({test:"test-content"}),function(a){a?f.remove("test-item",function(){c(g)}):c(!1)})}catch(b){c(!1)}},h)):c(g):
c(!1)},create:function(a,f,d){d=e(d);if(a&&b){var h=this.adapter,t=function(a){d(!1,a)};g(h,a,function(){h.root.getFile(a,{create:!0},function(a){a.createWriter(function(a){var c;a.onwriteend=function(){d(!0)};a.onerror=t;try{Blob?(c=new Blob([f],{type:"text/plain"}),a.write(c)):BlobBuilder&&(c=new BlobBuilder,c.append(f),a.write(c.getBlob("application/json")))}catch(b){t(b)}},t)},t)})}else d(!1)},read:function(a,f){f=e(f);if(a&&b){var d=this.adapter,h=function(a){f(!1,a)};g(d,a,function(){d.root.getFile(a,
{create:!1},function(a){a.file(function(a){var c=new FileReader;c.onloadend=function(){f(this.result)};c.onerror=h;c.onabort=h;c.readAsText(a)},h)},h)})}else f(!1)},update:function(a,f,b){this.create(a,f,b)},remove:function(a,f){f=e(f);if(a&&b){var d=this.adapter,h=function(a){f(!1,a)};g(d,a,function(){d.root.getFile(a,{create:!1},function(a){a.remove(function(){f(!0)},h)},h)})}else f(!1)},init:function(a){return this.isSupported()?(a&&a.size&&(this.size=a.size),this):!1}};s.ns("cache.storage.adapter."+
m,l)})(window,window.getNs());
(function(k,s,r){function h(e){if(!(this instanceof h))return new h(e);this.adapter=null;this.type=g;this.dbName="cache";this.dbVersion="1.0";this.dbTable="offline";this.dbDescription="offline cache";this.dbKey="key";this.init(e)}var g="indexedDatabase",l=s.helpers.utils.callback,m=null,d=k.indexedDB||k.webkitIndexedDB||k.mozIndexedDB||k.OIndexedDB||k.msIndexedDB;h.prototype=h.fn={isSupported:function(){null===m&&(m=!!d);return m},create:function(e,b,a){a=l(a);if(e&&m){var c=this.dbTable,f=this.adapter.transaction([c],
"readwrite");e=f.objectStore(c).put({key:e,content:b});f.onerror=function(c){a(!1,c)};e.onerror=function(c){a(!1,c)};e.onsuccess=function(){a(!0)}}else a(!1)},read:function(e,b){b=l(b);if(e&&m){var a=this.dbTable,c=this.adapter.transaction([a],"readonly"),a=c.objectStore(a).get(e);c&&a?(c.onerror=function(a){b(!1,a)},a.onerror=function(a){b(!1,a)},a.onsuccess=function(a){a.target.result&&a.target.result.content?b(a.target.result.content):b(!1)}):b(!1)}else b(!1)},update:function(e,b,a){this.create(e,
b,a)},remove:function(e,b){b=l(b);if(e&&m){var a=this.dbTable,c=this.adapter.transaction([a],"readwrite"),a=c.objectStore(a).put({key:e,content:""});c.onerror=function(a){b(!1,a)};a.onerror=function(a){b(!1,a)};a.onsuccess=function(){b(!0)}}else b(!1)},open:function(e,b){b||(b=!1);e=l(e);var a=this,c=null,f=null,h=null,g=a.dbName,t=a.dbTable,p=function(c){c||e(!1);a.create("test-item",'{test: "test-content"}',function(b){b?a.remove("test-item",function(){e(c)}):e(!1)})},q,n,m,u,v;if(null===a.adapter)if(c=
d){k.webkitIndexedDB!==r&&(k.IDBTransaction=k.webkitIDBTransaction,k.IDBKeyRange=k.webkitIDBKeyRange);q=function(c){c.createIndex(a.dbKey,a.dbKey,{unique:!0});c.createIndex("content","content",{unique:!1})};n=function(c){var b=f.result,d,n;a.adapter=b;a.dbVersion===b.version||!b.setVersion&&"function"!==typeof b.setVersion?(a.adapter=b,p(b)):(h=c.currentTarget.result.setVersion(a.dbVersion),h.onfailure=function(a){e(!1)},h.onsuccess=function(c){d=f.result;try{n=d.createObjectStore(t,{keyPath:a.dbKey}),
q(n)}catch(b){e(!1)}})};m=function(c){c=f.result.createObjectStore(t,{keyPath:a.dbKey});q(c)};u=function(c){b||a.open(e,!0);e(!1)};v=function(a){e(!1)};if(b)try{f=c.open(g,a.dbVersion)}catch(z){f=c.open(g)}else f=c.open(g);f.onsuccess=n;f.onupgradeneeded=m;f.onerror=u;f.onblocked=v}else e(!1);else p(a.adapter)},init:function(e){return this.isSupported()?(e&&(e.name&&(this.dbName=String(e.name)),e.version&&(this.dbVersion=parseInt(e.version,10)),e.table&&(this.dbTable=e.table),e.description&&(this.dbDescription=
String(e.description)),e.key&&(this.dbKey=e.key)),this):!1}};s.ns("cache.storage.adapter."+g,h)})(window,window.getNs());
(function(k,s,r){function h(b,a,c,f,e,d){!d&&b?b.transaction(function(b){b.executeSql(a,c,f,e)}):d?d.executeSql(a,c,f,e):e(null,{code:0,message:l+" isn't available"})}function g(b){if(!(this instanceof g))return new g(b);this.adapter=null;this.type=l;this.dbName="cache";this.dbVersion="1.0";this.dbDescription="resource cache";this.dbTable="websql";this.dbSize=4194304;this.init(b)}var l="webSqlDatabase",m=s.helpers.utils.callback,d=null,e=k.openDatabase;g.prototype=g.fn={isSupported:function(){null===
d&&(d=!!e);return d},create:function(b,a,c){c=m(c);b&&d?h(this.adapter,"INSERT INTO "+this.dbTable+" (key, content) VALUES (?,?);",[b,a],function(){c(!0)},function(a,b){c(!1,b,{transaction:a})}):c(!1)},read:function(b,a){a=m(a);b&&d?h(this.adapter,"SELECT content FROM "+this.dbTable+" WHERE key=?;",[b],function(c,b){var e=!1;b&&(b.rows&&1===b.rows.length)&&(e=b.rows.item(0).content);a(e,null,{transaction:c})},function(c,b){a(!1,b,{transaction:c})}):a(!1)},update:function(b,a,c){c=m(c);b&&d?h(this.adapter,
"UPDATE "+this.dbTable+" SET content = ?  WHERE key=?;",[a,b],function(){c(!0)},function(a,b){c(!1,b,{transaction:a})}):c(!1)},remove:function(b,a){a=m(a);b&&d?h(this.adapter,"DELETE FROM "+this.dbTable+" WHERE key = ?;",[b],function(){a(!0)},function(c,b){a(!1,b,{transaction:c})}):a(!1)},open:function(b){b=m(b);if(d){var a=this,c=a.adapter,f,g=function(c){c||b(!1);f=function(f){f?a.remove("test-item",function(){b(c)}):b(!1)};a.read("test-item",function(c){c?a.update("test-item",'{test: "test-content"}',
f):a.create("test-item",'{test: "test-content"}',f)})},l=function(c,b){h(c,"CREATE TABLE IF NOT EXISTS "+a.dbTable+"(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, key TEXT NOT NULL UNIQUE, content TEXT NOT NULL);",[],function(){g(a.adapter)},function(a){g(!1)},b)},t=function(a){l(null,a)},p=function(a){b(!1)};try{if(null===c&&a.isSupported())if(a.adapter=c=e(a.dbName,"",a.dbDescription,a.dbSize),String(c.version)!==String(a.dbVersion)&&c.changeVersion&&"function"===typeof c.changeVersion)try{c.changeVersion(c.version,
a.dbVersion,t,p)}catch(q){b(!1)}else c=k.openDatabase(a.dbName,a.dbVersion,a.dbDescription,a.dbSize),l(c);else a.isSupported()&&g(c)}catch(n){b(!1)}}else b(!1)},init:function(b){return this.isSupported()?(b&&(b.description&&(this.dbDescription=b.description),b.name&&(this.dbName=b.name),b.size&&(this.dbSize=b.size),b.table&&(this.dbTable=b.table),b.version&&(this.dbVersion=String(b.version))),this):!1}};s.ns("cache.storage.adapter."+l,g)})(window,window.getNs());
(function(k,s,r){function h(a){a=d(a);switch(a){case "local":a="localStorage";break;case "session":a="sessionStorage";break;default:a="localStorage"}return a}function g(a){if(!(this instanceof g))return new g(a);this.adapter=null;this.type=l;this.lifetime="local";this.asynch=!0;this.init(a)}var l="webStorage",m=s.helpers.utils,d=m.trim,e=m.callback,b=null;g.prototype=g.fn={isSupported:function(){var a=h(this.lifetime);if(null===b)try{b=!!k[a]&&!!k[a].getItem}catch(c){b=!1}return b},create:function(a,
c,b){var d=this,h=!0,g=function(a){if(d.asynch)b(a);else return a};b=e(b);if(!a)return g(!1);try{d.adapter.setItem(a,c)}catch(p){h=!h}return g(h)},read:function(a,c){var b=this,d,h=!0,g=function(a){if(b.asynch)c(a);else return a};c=e(c);if(!a)return g(!1);try{h=(d=b.adapter.getItem(a))?d:!1}catch(p){h=!h}return g(h)},update:function(a,c,b){if(this.asynch)this.create(a,c,b);else return this.create(a,c,b)},remove:function(a,c){var b=this,d=!0,h=function(a){if(b.asynch)c(a);else return a};c=e(c);if(!a)return h(!1);
try{b.adapter.removeItem(a)}catch(g){d=!d}return h(d)},open:function(a){var c=this,b=c.adapter,d=h(c.lifetime),g,t,p=function(b){if(c.asynch)a(b);else return b};a=e(a);if(null===b)try{if(b=c.adapter=k[d],c.asynch)c.create("test-item",'{test: "test-content"}',function(e){e?c.remove("test-item",function(){a(b)}):a(!1)});else{if(g=c.create("test-item",'{test: "test-content"}'))if(t=c.remove("test-item"))return b;return!1}}catch(q){return p(!1)}else if(c.isSupported())return p(b)},init:function(a){return this.isSupported()?
(a&&(a.lifetime&&(this.lifetime=d(String(a.lifetime))),a.asynch!==r&&(this.asynch=!!a.asynch)),this):!1}};s.ns("cache.storage.adapter."+l,g)})(window,window.getNs());
(function(k,s,r,h){function g(a,b){b.isLoaded||(b.isLoaded=!0,b.progressCallback(100),k.setTimeout(function(){a()},b.delay))}function l(a){if(!(this instanceof l))return new l(a);this.adapter=null;this.type=m;this.isLoaded=!1;this.delay=0;this.opened=!0;this.message="New version available. Update page?";this.init(a)}var m="applicationCache",d=r.helpers,e=d.utils,b=d.dom,a=e.on,c=e.callback,f=null,w=s.getElementsByTagName("html")[0],x=k.applicationCache;l.prototype=l.fn={isSupported:function(){null===
f&&(f=!!x&&!!b.getAttribute(w,"manifest"));return f},open:function(b,e){var f=this,d=f.adapter,l=0,u,m;f.opened=!0;b=c(b);e&&e.progress&&(u=e.progress);u=f.progressCallback=c(u);if(f.isSupported()&&null!==d){m=function(){try{d.swapCache()}catch(a){}confirm(f.message)?k.location.reload(!0):g(b,f);return!1};a(d,"noupdate",function(){g(b,f);return!1});a(d,"downloading",function(){l=0;return!1});a(d,"progress",function(a){var b=0;f.delay=500;l+=1;b=a&&a.lengthComputable!==h?Math.round(100*a.loaded/a.total):
Math.round(100*l/20);u(b);return!1});a(d,"cached",function(){g(b,f);return!1});a(d,"updateready",function(){m()});a(d,"obsolete",function(){k.location.reload(!0);return!1});a(d,"error",function(){g(b,f);return!1});switch(d.status){case d.UNCACHED:g(b,f);break;case d.IDLE:g(b,f);break;case d.UPDATEREADY:m();break;case d.OBSOLETE:g(b,f)}a(k,"online",function(){try{d.update()}catch(a){}});k.setTimeout(function(){f.isLoaded||g(b,f)},12E3)}else g(b,f)},init:function(a){this.isSupported()&&(null===this.adapter&&
(this.adapter=x),a&&(a.message&&(this.message=String(a.message)),a.delay!==h&&(this.delay=parseInt(a.delay,10))));return this}};r.ns("cache.storage.adapter."+m,l)})(window,document,window.getNs());
(function(k,s,r,h){function g(a,b,c){c.timeout=k.setTimeout(function(){b(!1)},4E3);u(a,function(a){k.clearTimeout(c.timeout);delete c.timeout;a?b(a):b(!1)})}function l(a){var b=null;try{b=p.jsonToObject(a)}catch(c){}return b}function m(a,b,c){if(D){var e=s.createElement("canvas"),f,d=new Image,g=null,n=0,k=0;c||(c="jpeg");d.onerror=function(){d.onload=d.onerror=null;b()};d.onload=function(){d.onload=d.onerror=null;n=e.height=d.height;k=e.width=d.width;f=e.getContext("2d");f.fillStyle="rgba(50, 50, 50, 0)";
f.fillRect(0,0,k,n);f.drawImage(d,0,0);g=e.toDataURL("image/"+c);b(g)};d.src=a;if(d.complete&&d.naturalWidth!==h)d.onload()}else b(!1)}function d(a){var b=a.data,c=a.url;"css"===a.type&&(c=p.url(c),c=c.folder,b=b.replace(/url\(\../g,"url("+c+".."),b=b.replace(/url\(\'../g,"url('"+c+".."),b=b.replace(/url\(\"../g,'url("'+c+".."),a.data=b);return a}function e(a,b){return{ajax:a.ajax,data:a.data,expires:(new Date).getTime()+(a.lifetime||b.lifetime),group:a.group!==h?a.group:b.group,lastmod:a.lastmod||
b.lastmod,lifetime:a.lifetime!==h?a.lifetime:b.lifetime,type:a.type||b.type,version:a.version||b.version}}function b(a,b,c){var e=a.type,d=a.url,f=a.data;a.ajax?"img"===e?m(d,b):g(d,b,a):f?b(f):c(!1)}function a(a){return A&&A[a]?!!A[a]:!1}function c(a,b){var e=null,d,f;a&&a.length?(d=a[0].type,f=a.slice(1),z[d]?e=new z[d](B):c(f,b),e&&e.isSupported()?e.open(function(d){d?(A=a[0],b(e)):c(f,b)}):c(f,b)):b(!1)}function f(a,b,e){var d=null,h=0,g;if(e)try{z[e]?(d=new z[e](B))&&d.isSupported()?d.open(function(c){if(c){g=
b.length;for(h=0;h<g;h+=1)b[h].type===e&&(A=b[h]);A?a(d):f(a,b)}else f(a,b)}):f(a,b):f(a,b)}catch(n){f(a,b)}else c(b,a)}function w(a,b){if(!(this instanceof w))return new w(a,b);this.isEnabled=!0;this.appCacheAdapter=this.adapter=null;this.adapters={types:y,defaults:B};this.resources={defaults:E};this.init(a,b)}var x=r.helpers,t=x.client,p=x.utils,q=p.isArray,n=p.callback,C=p.getJson(),u=p.xhr,v=p.trim,z=r.cache.storage.adapter,D=t.hasCanvas(),y=[{type:"fileSystem",css:!0,js:!0,html:!0,img:!0},{type:"indexedDatabase",
css:!0,js:!0,html:!0,img:!0},{type:"webSqlDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webStorage",css:!0,js:!0,html:!0,img:!0}],B={name:"localcache",table:"cache",description:"local resource cache",size:4194304,version:"1.0",key:"key",lifetime:"local",offline:!0},A=null,E={ajax:!0,lifetime:2E4,group:0,lastmod:(new Date).getTime(),type:"css",version:1};w.prototype=w.fn={create:function(c,f){f=n(f);if(c&&c.url){var h=this,g=c.url,k=c.type;b(c,function(b){if(b)if(c.data=b,c=d(c),null!==h.adapter&&
a(k)){b=p.jsonToString(g);var n=e(c,h.resources.defaults),l=p.jsonToString(n);c.expires=n.expires;c.version=n.version;try{h.adapter.create(b,l,function(a){a?f(c):f(!1)})}catch(q){f(c)}}else f(c);else f(c)},f)}else f(!1)},read:function(b,c){c=n(c);if(b&&b.url){var f=this,e=b.url,d=b.type;if(null!==this.adapter&&a(d))try{f.adapter.read(p.jsonToString(e),function(a){a?(b=l(a))?(b.url=e,c(b,!0)):f.remove({url:e,type:d},function(){c(!1)}):c(!1)})}catch(h){g(e,function(a){b.data=a;c(b,!0)},b)}else c(b)}else c(!1)},
update:function(c,f){f=n(f);if(c&&c.url){var h=this,g=c.url,k=c.type;b(c,function(b){if(b)if(c.data=b,c=d(c),null!==h.adapter&&a(k)){b=p.jsonToString(g);var n=e(c,h.resources.defaults),l=p.jsonToString(n);c.expires=n.expires;c.version=n.version;try{h.adapter.update(b,l,function(a){a?f(c):f(!1)})}catch(q){f(c)}}else f(c);else h.read(c,function(a){a&&a.data?(c.data=a.data,f(c)):f(!1)})},f)}else f(!1)},remove:function(b,c){c=n(c);if(b&&b.url){var f=b.url,e=b.type;null!==this.adapter&&a(e)?this.adapter.remove(p.jsonToString(f),
function(a){a?c(b):c(!1)}):c(b)}else c(!1)},init:function(a,b){var c=this,e=!1,d,g,k,p;a=n(a);b&&b.isEnabled!==h&&(c.isEnabled=!!b.isEnabled);if(c.isEnabled&&C){if(b){if(b.adapters){d=b.adapters;if(d.types&&q(d.types)){g=d.types;k=g.length;for(p=0;p<k;p+=1)g[p].css===h&&(g[p].css=!0),g[p].js===h&&(g[p].js=!0),g[p].img===h&&(g[p].img=!0),g[p].html===h&&(g[p].html=!0);c.adapters.types=g}d.defaults&&(g=d.defaults,k=c.adapters.defaults,g.name&&(k.name=v(String(g.name))),g.table&&(k.table=v(String(g.table))),
g.description&&(k.description=v(String(g.description))),g.size&&(k.size=parseInt(g.size,10)),g.version&&(k.version=v(String(g.version))),g.key&&(k.key=v(String(g.key))),g.lifetime&&(k.lifetime=v(String(g.lifetime))),g.offline!==h&&(k.offline=!!g.offline));d.preferredType&&(e=v(String(d.preferredType)))}b.resources&&(d=b.resources,d.defaults&&(d=d.defaults,g=c.resources.defaults,d.ajax!==h&&(g.ajax=!!d.ajax),d.lifetime!==h&&(g.lifetime=parseInt(d.lifetime,10)),d.group!==h&&(g.group=parseInt(d.group,
10)),d.lastmod!==h&&(g.lastmod=parseInt(d.lastmod,10)),d.type&&(g.type=v(String(d.type))),d.group!==h&&(g.version=parseFloat(d.version)),d.loaded&&(g.loaded=n(d.loaded))))}f(function(b){b||(c.isEnabled=!1);c.adapter=b;a(c)},c.adapters.types,e);c.adapters.defaults.offline&&(z.applicationCache&&!c.appCacheAdapter)&&(c.appCacheAdapter=new z.applicationCache(B))}else a(c)}};r.ns("cache.storage.controller",w)})(window,document,window.getNs());
(function(k,s){function r(a){var d=b(a.type);if("js"!==d||"css"!==d||"html"!==d||"img"!==d||"custom"!==d){switch(m.url(a.url).extension){case "js":a="js";break;case "css":a="css";break;case "html":a="html";break;case "jpg":case "jpeg":case "png":a="img";break;default:a="custom"}d=a}return d}function h(a,b){if(!(this instanceof h))return new h(a,b);this.storage=null;this.init(a,b)}var g=k.helpers,l=g.dom,m=g.utils,d=g.client,e=m.isArray,b=m.trim,a=m.callback;h.prototype=h.fn={load:function(c,f){var g=
this,h=(new Date).getTime(),k=function(){var a=0,b=0,c=null;return{init:function(d,e){c=e;a=d;b=0},loaded:function(){b+=1;b===a&&c()}}}(),p=function(a,b,c){var d=a.url,e=function(){a.loaded(a);k.loaded()},f=a.node||null;c=!!c;switch(a.type){case "js":l.appendJs(d,b,e,f,c);break;case "css":l.appendCss(d,b,e,f,c);break;case "img":l.appendImg(d,b,e,f,c);break;case "html":l.appendHtml(d,b,e,f,c);break;default:e()}},q=function(b){var c=b.data||null,e=function(a,b){a&&a.data?p(a,a.data,b):p(a,null,b)},
f=g.storage,k=f.resources.defaults;b.ajax=b.ajax!==s?!!b.ajax:k.ajax;b.loaded=b.loaded!==s?a(b.loaded):a(k.loaded);f.read(b,function(a){if(a&&a.data){var k=b,n=g.storage.resources.defaults,l=parseInt(a.lifetime,10),q=a.version,m=a.lastmod?a.lastmod:0,t=!1,r,y=k.lastmod?k.lastmod:0,t=!0;r=!1;k.version=r=k.version!==s?parseFloat(k.version):n.version;k.group=k.group!==s?parseFloat(k.group):n.group;y&&m?(k.lastmod=parseInt(y,10),t=m===k.lastmod):!y&&m?y=m:y||(y=n.lastmod);t=t&&r===q;r=0!==l&&(-1!==l&&
t&&a.expires>h||-1===l&&t);k.lastmod=y;k.isValid=r;b=k;b.isValid||!d.isOnline()?(c=a.data)&&p(b,c):f.update(b,e)}else f.create(b,e)})},n=function(a,c){var d=0,e=a.length,f=null;k.init(e,c);for(d=0;d<e;d+=1)(f=a[d])&&f.url&&(f.url=b(f.url),f.type=r(f),q(f))},m=function(a,b,c){var d=a.length;for(c||(c=0);!a[c]&&c<d;)c+=1;c>=d?b(g):(d=a[c],n(d,function(){m(a,b,c+1)}))};(function(b,c){b&&e(b)||(b=[]);for(var d=b,g=[],h,k=0,n,p=d.length,k=0;k<p;k+=1)n=d[k],(h=n.group)||(h=0),h=g[h]?g[h]:g[h]=[],h.push(n);
b=g;c=a(f);m(b,c)})(c,f)},remove:function(c,d){var g=this.storage,h=function(a,c){var d=a.length,e,f,h=function(a,b){a===d-1&&c()};if(d)for(e=0;e<d;e+=1)(f=a[e])&&f.url&&(f.url=b(f.url),f.type=r(f),g.remove(f,h(e,f.url)));else c()};(function(b,c){b&&e(b)||(b=[]);c=a(d);h(b,c)})(c,d)},init:function(b,d){var e=this;b=a(b);k.cache.storage.controller(function(a){e.storage=a;b(a)},d);return e}};k.ns("cache.controller",h)})(window.getNs());
(function(k,s,r){function h(a){this.storage=this.controller=null;this.params=a;this.queue=new d;this.timeout=this.interval=this.calls=0}function g(c){var d=null,e=m.length,f;c||(c=x);if(b)for(f=0;f<e;f+=1)a(m[f].params)===a(c)&&(d=m[f]);d||(d=new h(c),m.push(d));return d}function l(a,b,c){var d=g(a),e,h,l,m=function(){e=d.interval;k.clearInterval(e);e=k.setInterval(function(){d.timeout=h=d.timeout+f;l=d.storage;d.controller&&(l&&(l.adapter||!l.isEnabled))&&(k.clearInterval(e),d.queue.flush());h>w&&
(k.clearInterval(e),c())},f)};d?d.storage?b(d):(d.queue.add(function(){b(d)}),d.calls+=1,1===d.calls?d.controller=new s.cache.controller(function(a){d.storage=a;d.controller?d.queue.flush():m()},a):m()):c()}var m=[];r=s.helpers;var d=r.queue;r=r.utils;var e=r.isArray,b=r.getJson(),a=r.jsonToString,c=r.callback,f=15,w=5E3,x={};r=function(){return{load:function(a,b,d){b=c(b);l(d,function(c){e(a)?c.controller.load(a,b):"applicationCache"===a?(c=c.storage)&&c.appCacheAdapter?c.appCacheAdapter.open(b,
d):b(!1):b(!1)},function(){b(!1)});return this},remove:function(a,b,d){b=c(b);l(d,function(c){e(a)?c.controller.remove(a,b):b(!1)},function(){b(!1)});return this},setup:function(a){a&&(x=a);return this}}}();s.ns("cache.load",r.load);s.ns("cache.remove",r.remove);s.ns("cache.setup",r.setup)})(window,window.getNs());
