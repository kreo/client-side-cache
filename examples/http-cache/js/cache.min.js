(function(g,q){function n(){g[c]||(g[c]={});return g[c]}var c="app",h;h=n();h.namespace=h.ns=function(l,d){if(l){l=String(l);var p=l.split("."),e=p.length,a=g[c],b;a||(g[c]={});if(!p)return!1;for(b=0;b<e;b+=1)a[p[b]]||(a[p[b]]={}),b===e-1&&d!==q&&(a[p[b]]=d),a=a[p[b]];return a}return!1};g[c]=h;g.getNamespace=g.getNs=n})(window);
(function(g,q){function n(){if(!(this instanceof n))return new n;this.m=[];this.r=null;this.f=!1}n.prototype=n.fn={add:function(c){this.f?c(this.r):this.m.push(c)},flush:function(c){if(!this.f)for(this.r=c,this.f=!0;this.m[0];)this.m.shift()(c)}};g.ns("helpers.queue",n)})(window.getNs());
(function(g,q,n,c){var h=function(){var g=[];return{isString:function(d){return"string"===typeof d||d instanceof String},isFunction:function(d){return"function"===typeof d||d instanceof Function},isArray:function(d){var c=Array.isArray,e=Object.prototype.toString;h.isArray=c&&"function"===typeof c?function(a){return c(a)}:e&&"function"===e?function(a){return"[object Array]"===e.call(a)}:function(a){return!!a&&!!a.sort&&"function"===typeof a.sort};return h.isArray(d)},inArray:function(d,c,e){h.inArray=
Array.prototype.indexOf?function(a,b,f){return g.indexOf.call(b,a,f)}:function(a,b,f){var m=b.length,u=0;if(f)return b[f]&&b[f]===a?f:-1;for(u=0;u<m;u+=1)if(b[u]===a)return u;return-1};return h.inArray(d,c,e)},callback:function(d){h.isFunction(d)||(d=function(){return c});return d},url:function(d){if(h.isString(d)){var c=q.createElement("a"),e;c.href=d;e=c.pathname.match(/\/([^\/?#]+)$/i);return{source:d,protocol:c.protocol,host:c.hostname,port:c.port,query:c.search,file:e?e[1]:"/",hash:c.hash,path:c.pathname.replace(/^([^\/])/,
"/$1"),extension:function(a){a=a.split(".");return a.length?a[a.length-1]:!1}(d),folder:function(){var a=d.lastIndexOf("/");return d.substr(0,a+1)}()}}},trim:function(c){if(!h.isString(c))return c;h.isFunction(String.prototype.trim)||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});return c.trim()}}}();n.ns("helpers.utils",h)})(window,document,window.getNs());(function(g,q,n,c){n.namespace("helpers.console",{})})(window,document,window.getNs());
(function(g,q,n){var c=function(){var g=q.helpers.utils;return{getXhr:function(){for(var c=null,d=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],g=d.length,e=0,e=0;e<g;e+=1){try{c=d[e]()}catch(a){continue}break}return c},xhr:function(l,d,p,e){var a=c.getXhr(),b,f="GET";d=g.callback(d);if(a)if(l){e!==n?f="POST":e=null;p===n&&(p=!0);b=function(){if(4===
a.readyState&&(200<=a.status&&400>a.status||0===a.status))try{var b=a.responseText;b?d(b):d(!1)}catch(f){d(!1)}else 4===a.readyState&&d(!1)};a.open(f,l,p);try{a.onreadystatechange!==n?a.onreadystatechange=b:a.onload!==n&&(a.onload=b)}catch(m){}a.send(e)}else d(!1);else d(!1)}}}();q.namespace("helpers.ajax",c)})(window,window.getNs());
(function(g,q,n,c){var h=function(){return{on:function(c,d,p){h.on="function"===typeof g.addEventListener?function(e,a,b){e.addEventListener(a,b,!1)}:"function"===typeof q.attachEvent?function(e,a,b){e.attachEvent("on"+a,b)}:function(e,a,b){e["on"+a]=b};h.on(c,d,p)},off:function(c,d,p){h.off="function"===typeof g.removeEventListener?function(e,a,b){e.removeEventListener(a,b,!1)}:"function"===typeof q.detachEvent?function(e,a,b){e.detachEvent("on"+a,b)}:function(e,a){e["on"+a]=null};h.off(c,d,p)}}}();
n.namespace("helpers.events",h)})(window,document,window.getNs());(function(g,q,n,c){var h=function(){var l=null,d=g.JSON;return{getJson:function(){null===l&&d&&d.stringify&&(l=d);return l},jsonToString:function(d,e,a){var b=!1;null===l&&(l=h.getJson());l&&(l.stringify&&d!==c)&&(b=l.stringify(d,e,a));return b},jsonToObject:function(d,e){var a=!1;null===l&&(l=h.getJson());l&&(l.parse&&d!==c)&&(a=l.parse(String(d),e));return a}}}();n.namespace("helpers.json",h)})(window,document,window.getNs());
(function(g,q,n,c){var h=function(){function h(){a===c&&(m(g,"online",h),m(g,"offline",h));a=q.onLine!==c?!!q.onLine:!0}var d,p,e,a,b,f=(q.userAgent||q.vendor||g.opera).toLowerCase(),m=n.helpers.events.on;return{isWebkit:function(){d===c&&(d=null!==f.match(/(webkit)/));return d},isMsie:function(){e===c&&(e=null!==f.match(/(msie)/));return e},isOpera:function(){p===c&&(p=null!==f.match(/(opera)/));return p},isOnline:function(){a===c&&h();return a},hasCanvas:function(){if(b===c){var a=document.createElement("canvas");
b=!(!a.getContext||!a.getContext("2d"))}return b}}}();n.ns("helpers.client",h)})(window,window.navigator,window.getNs());
(function(g,q,n){function c(c,d){d&&(d.dom?c=d.dom:d.id&&(c=g.getElementById(d.id)));return c}var h=function(){var l=q.helpers,d=l.utils,p=l.client,e=[],a=[],b=[],f=[],m=g.getElementsByTagName("head")[0];return{nuke:function(){e=[];a=[];b=[];f=[]},createDomNode:function(b,a){var f=g.createElement(b),m;if(a)for(m in a)a.hasOwnProperty(m)&&f.setAttribute(m,a[m]);return f},getAttribute:function(b,a){return b.getAttribute(a)},setAttribute:function(b,a,f){b.setAttribute(a,f)},appendCss:function(b,a,f,
s,k){if(-1===d.inArray(b,e)||k){var r=null,t=!1,v,l,r=c(r,s);if(null!==a){r||(r=h.createDomNode("style",{type:"text/css"}),r.className="lazyloaded");r.onerror=function(){f(!1)};s||m.appendChild(r);try{v=g.createTextNode(a),r.appendChild(v)}catch(n){r.styleSheet.cssText=a}finally{f(!0)}}else null!==b&&(r||(r=h.createDomNode("link",{rel:"stylesheet",type:"text/css"}),r.className="lazyloaded"),r.onerror=r.error=function(){r.onload=r.load=null;t=!0;window.clearTimeout(l);f(!1)},s||m.appendChild(r),p.isMsie()||
p.isOpera()?r.onload=r.load=function(){r.onerror=r.error=null;t=!0;window.clearTimeout(l);f(!0)}:f(!0),r.href=b,l=window.setTimeout(function(){t||f(!1)},4E3));e.push(b)}else f(!0)},appendJs:function(b,f,e,s,k){if(-1===d.inArray(b,a)||k){k=h.createDomNode("script");var r=g.getElementsByTagName("script")[0],t=!1,v=!1,l;(k=c(k,s))?(k.type="text/javascript",k.className="lazyloaded",k.async=!0,k.onreadystatechange=k.onload=function(){v||this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||
(this.onreadystatechange=this.onload=null,t=v=!0,window.clearTimeout(l),a.push(b),e(!0))},k.onerror=function(){this.onload=this.onreadystatechange=this.onerror=null;window.clearTimeout(l);t=!0;e(!1)},s||(r?r.parentNode.insertBefore(k,r):m.appendChild(k)),f&&!v?(k.textContent?k.textContent=f:k.nodeValue?k.nodeValue=f:k.text=f,t=v=!0):null!==b&&(k.src=b),v&&(a.push(b),t=!0,e(!0)),t||(l=window.setTimeout(function(){v||e(!1)},5E3))):e(!1)}else e(!0)},appendImg:function(a,f,m,e){var k=null;(k=c(k,e))||
(k=new Image);k.onerror=function(){k.onload=k.onerror=null;m(!1)};k.onload=function(){k.onload=k.onerror=null;m(!0)};f?k.src=f:a&&(k.src=a);if(k.complete&&k.naturalWidth!==n)k.onload();b.push(a)},appendHtml:function(b,a,m,e){var k=c(null,e);if(k){if(a)try{k.innerHTML=a,e.id&&p.isMsie()&&g.styleSheets[0].addRule("#"+e.id+":after",'content: " ";')}catch(d){k.innerText=a}m(!0);f.push(b)}else m(!1)}}}();q.ns("helpers.dom",h)})(document,window.getNs());
(function(g,q,n){function c(b,a,e){var d=function(a){e(!1)};if("."===a[0]||""===a[0])a=a.slice(1);a[0]?b.getDirectory(a[0],{create:!0},function(b){a.length?c(b,a.slice(1),e):e(!0)},d):e(!0)}function h(a,b,d){b=b.split("/");var g=b.length,h="",s=0;d=e(d);if(g){for(s=0;s<g-1;s+=1)h=h+b[s]+"/";c(a.root,h.split("/"),d)}else d(!0)}function l(b){if(!(this instanceof l))return new l(b);this.adapter=null;this.type=d;this.size=52428800;this.init(b)}var d="fileSystem";n=q.helpers;var p=n.json,e=n.utils.callback,
a=null,b=g.requestFileSystem||g.webkitRequestFileSystem||g.moz_requestFileSystem;l.prototype=l.fn={isSupported:function(){null===a&&(a=!!b&&(!!g.Blob||!!g.BlobBuilder)&&g.FileReader);return a},open:function(f){var m=this,c=m.adapter,d=function(b){f(!1)};f=e(f);a?null===c?(g.requestFileSystem=b,g.requestFileSystem(g.TEMPORARY,m.size,function(b){c=m.adapter=b;try{m.create("test-item",p.jsonToString({test:"test-content"}),function(b){b?m.remove("test-item",function(){f(c)}):f(!1)})}catch(a){f(!1)}},
d)):f(c):f(!1)},create:function(b,m,c){c=e(c);if(b&&a){var d=this.adapter,g=function(b){c(!1,b)};h(d,b,function(){d.root.getFile(b,{create:!0},function(b){b.createWriter(function(b){var a;b.onwriteend=function(){c(!0)};b.onerror=g;try{Blob?(a=new Blob([m],{type:"text/plain"}),b.write(a)):BlobBuilder&&(a=new BlobBuilder,a.append(m),b.write(a.getBlob("application/json")))}catch(f){g(f)}},g)},g)})}else c(!1)},read:function(b,m){m=e(m);if(b&&a){var c=this.adapter,d=function(b){m(!1,b)};h(c,b,function(){c.root.getFile(b,
{create:!1},function(b){b.file(function(b){var a=new FileReader;a.onloadend=function(){m(this.result)};a.onerror=d;a.onabort=d;a.readAsText(b)},d)},d)})}else m(!1)},update:function(b,a,e){this.create(b,a,e)},remove:function(b,m){m=e(m);if(b&&a){var c=this.adapter,d=function(b){m(!1,b)};h(c,b,function(){c.root.getFile(b,{create:!1},function(b){b.remove(function(){m(!0)},d)},d)})}else m(!1)},init:function(b){return this.isSupported()?(b&&b.size&&(this.size=b.size),this):!1}};q.ns("cache.storage.adapter."+
d,l)})(window,window.getNs());
(function(g,q,n){function c(e){if(!(this instanceof c))return new c(e);this.adapter=null;this.type=h;this.dbName="cache";this.dbVersion="1.0";this.dbTable="offline";this.dbDescription="offline cache";this.dbKey="key";this.init(e)}var h="indexedDatabase",l=q.helpers.utils.callback,d=null,p=g.indexedDB||g.webkitIndexedDB||g.mozIndexedDB||g.OIndexedDB||g.msIndexedDB;c.prototype=c.fn={isSupported:function(){null===d&&(d=!!p);return d},create:function(e,a,b){b=l(b);if(e&&d){var f=this.dbTable,m=this.adapter.transaction([f],
"readwrite");e=m.objectStore(f).put({key:e,content:a});m.onerror=function(a){b(!1,a)};e.onerror=function(a){b(!1,a)};e.onsuccess=function(){b(!0)}}else b(!1)},read:function(e,a){a=l(a);if(e&&d){var b=this.dbTable,f=this.adapter.transaction([b],"readonly"),b=f.objectStore(b).get(e);f&&b?(f.onerror=function(b){a(!1,b)},b.onerror=function(b){a(!1,b)},b.onsuccess=function(b){b.target.result&&b.target.result.content?a(b.target.result.content):a(!1)}):a(!1)}else a(!1)},update:function(e,a,b){this.create(e,
a,b)},remove:function(e,a){a=l(a);if(e&&d){var b=this.dbTable,f=this.adapter.transaction([b],"readwrite"),b=f.objectStore(b).put({key:e,content:""});f.onerror=function(b){a(!1,b)};b.onerror=function(b){a(!1,b)};b.onsuccess=function(){a(!0)}}else a(!1)},open:function(e,a){a||(a=!1);e=l(e);var b=this,f=null,c=null,d=null,h=b.dbName,q=b.dbTable,s=function(a){a||e(!1);b.create("test-item",'{test: "test-content"}',function(f){f?b.remove("test-item",function(){e(a)}):e(!1)})},k,r,t,v,C;if(null===b.adapter)if(f=
p){g.webkitIndexedDB!==n&&(g.IDBTransaction=g.webkitIDBTransaction,g.IDBKeyRange=g.webkitIDBKeyRange);k=function(a){a.createIndex(b.dbKey,b.dbKey,{unique:!0});a.createIndex("content","content",{unique:!1})};r=function(a){var f=c.result,g,h;b.adapter=f;b.dbVersion===f.version||!f.setVersion&&"function"!==typeof f.setVersion?(b.adapter=f,s(f)):(d=a.currentTarget.result.setVersion(b.dbVersion),d.onfailure=function(b){e(!1)},d.onsuccess=function(a){g=c.result;try{h=g.createObjectStore(q,{keyPath:b.dbKey}),
k(h)}catch(f){e(!1)}})};t=function(a){a=c.result.createObjectStore(q,{keyPath:b.dbKey});k(a)};v=function(f){a||b.open(e,!0);e(!1)};C=function(b){e(!1)};if(a)try{c=f.open(h,b.dbVersion)}catch(w){c=f.open(h)}else c=f.open(h);c.onsuccess=r;c.onupgradeneeded=t;c.onerror=v;c.onblocked=C}else e(!1);else s(b.adapter)},init:function(c){return this.isSupported()?(c&&(c.name&&(this.dbName=String(c.name)),c.version&&(this.dbVersion=parseInt(c.version,10)),c.table&&(this.dbTable=c.table),c.description&&(this.dbDescription=
String(c.description)),c.key&&(this.dbKey=c.key)),this):!1}};q.ns("cache.storage.adapter."+h,c)})(window,window.getNs());
(function(g,q,n){function c(a,b,f,c,d,e){!e&&a?a.transaction(function(a){a.executeSql(b,f,c,d)}):e?e.executeSql(b,f,c,d):d(null,{code:0,message:l+" isn't available"})}function h(a){if(!(this instanceof h))return new h(a);this.adapter=null;this.type=l;this.dbName="cache";this.dbVersion="1.0";this.dbDescription="resource cache";this.dbTable="websql";this.dbSize=4194304;this.init(a)}var l="webSqlDatabase",d=q.helpers.utils.callback,p=null,e=g.openDatabase;h.prototype=h.fn={isSupported:function(){null===
p&&(p=!!e);return p},create:function(a,b,f){f=d(f);a&&p?c(this.adapter,"INSERT INTO "+this.dbTable+" (key, content) VALUES (?,?);",[a,b],function(){f(!0)},function(b,a){f(!1,a,{transaction:b})}):f(!1)},read:function(a,b){b=d(b);a&&p?c(this.adapter,"SELECT content FROM "+this.dbTable+" WHERE key=?;",[a],function(a,c){var d=!1;c&&(c.rows&&1===c.rows.length)&&(d=c.rows.item(0).content);b(d,null,{transaction:a})},function(a,c){b(!1,c,{transaction:a})}):b(!1)},update:function(a,b,f){f=d(f);a&&p?c(this.adapter,
"UPDATE "+this.dbTable+" SET content = ?  WHERE key=?;",[b,a],function(){f(!0)},function(b,a){f(!1,a,{transaction:b})}):f(!1)},remove:function(a,b){b=d(b);a&&p?c(this.adapter,"DELETE FROM "+this.dbTable+" WHERE key = ?;",[a],function(){b(!0)},function(a,c){b(!1,c,{transaction:a})}):b(!1)},open:function(a){a=d(a);if(p){var b=this,f=b.adapter,m,h=function(c){c||a(!1);m=function(f){f?b.remove("test-item",function(){a(c)}):a(!1)};b.read("test-item",function(a){a?b.update("test-item",'{test: "test-content"}',
m):b.create("test-item",'{test: "test-content"}',m)})},l=function(a,f){c(a,"CREATE TABLE IF NOT EXISTS "+b.dbTable+"(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, key TEXT NOT NULL UNIQUE, content TEXT NOT NULL);",[],function(){h(b.adapter)},function(b){h(!1)},f)},n=function(b){l(null,b)},s=function(b){a(!1)};try{if(null===f&&b.isSupported())if(b.adapter=f=e(b.dbName,"",b.dbDescription,b.dbSize),String(f.version)!==String(b.dbVersion)&&f.changeVersion&&"function"===typeof f.changeVersion)try{f.changeVersion(f.version,
b.dbVersion,n,s)}catch(k){a(!1)}else f=g.openDatabase(b.dbName,b.dbVersion,b.dbDescription,b.dbSize),l(f);else b.isSupported()&&h(f)}catch(r){a(!1)}}else a(!1)},init:function(a){return this.isSupported()?(a&&(a.description&&(this.dbDescription=a.description),a.name&&(this.dbName=a.name),a.size&&(this.dbSize=a.size),a.table&&(this.dbTable=a.table),a.version&&(this.dbVersion=String(a.version))),this):!1}};q.ns("cache.storage.adapter."+l,h)})(window,window.getNs());
(function(g,q,n){function c(b){b=p(b);switch(b){case "local":b="localStorage";break;case "session":b="sessionStorage";break;default:b="localStorage"}return b}function h(b){if(!(this instanceof h))return new h(b);this.adapter=null;this.type=l;this.lifetime="local";this.asynch=!0;this.init(b)}var l="webStorage",d=q.helpers.utils,p=d.trim,e=d.callback,a=null;h.prototype=h.fn={isSupported:function(){var b=c(this.lifetime);if(null===a)try{a=!!g[b]&&!!g[b].getItem}catch(f){a=!1}return a},create:function(b,
a,c){var d=this,g=!0,h=function(b){if(d.asynch)c(b);else return b};c=e(c);if(!b)return h(!1);try{d.adapter.setItem(b,a)}catch(s){g=!g}return h(g)},read:function(b,a){var c=this,d,g=!0,h=function(b){if(c.asynch)a(b);else return b};a=e(a);if(!b)return h(!1);try{g=(d=c.adapter.getItem(b))?d:!1}catch(s){g=!g}return h(g)},update:function(b,a,c){if(this.asynch)this.create(b,a,c);else return this.create(b,a,c)},remove:function(b,a){var c=this,d=!0,g=function(b){if(c.asynch)a(b);else return b};a=e(a);if(!b)return g(!1);
try{c.adapter.removeItem(b)}catch(h){d=!d}return g(d)},open:function(b){var a=this,d=a.adapter,h=c(a.lifetime),l,n,s=function(c){if(a.asynch)b(c);else return c};b=e(b);if(null===d)try{if(d=a.adapter=g[h],a.asynch)a.create("test-item",'{test: "test-content"}',function(c){c?a.remove("test-item",function(){b(d)}):b(!1)});else{if(l=a.create("test-item",'{test: "test-content"}'))if(n=a.remove("test-item"))return d;return!1}}catch(k){return s(!1)}else if(a.isSupported())return s(d)},init:function(b){return this.isSupported()?
(b&&(b.lifetime&&(this.lifetime=p(String(b.lifetime))),b.asynch!==n&&(this.asynch=!!b.asynch)),this):!1}};q.ns("cache.storage.adapter."+l,h)})(window,window.getNs());
(function(g,q,n,c){function h(b,a){a.isLoaded||(a.isLoaded=!0,a.progressCallback(100),g.setTimeout(function(){b()},a.delay))}function l(b){if(!(this instanceof l))return new l(b);this.adapter=null;this.type=d;this.isLoaded=!1;this.delay=0;this.opened=!0;this.message="New version available. Update page?";this.init(b)}var d="applicationCache",p=n.helpers,e=p.dom,a=p.events.on,b=p.utils.callback,f=null,m=q.getElementsByTagName("html")[0],u=g.applicationCache;l.prototype=l.fn={isSupported:function(){null===
f&&(f=!!u&&!!e.getAttribute(m,"manifest"));return f},open:function(d,f){var e=this,k=e.adapter,m=0,l,v;e.opened=!0;d=b(d);f&&f.progress&&(l=f.progress);l=e.progressCallback=b(l);if(e.isSupported()&&null!==k){v=function(){try{k.swapCache()}catch(b){}confirm(e.message)?g.location.reload(!0):h(d,e);return!1};a(k,"noupdate",function(){h(d,e);return!1});a(k,"downloading",function(){m=0;return!1});a(k,"progress",function(b){var a=0;e.delay=500;m+=1;a=b&&b.lengthComputable!==c?Math.round(100*b.loaded/b.total):
Math.round(100*m/20);l(a);return!1});a(k,"cached",function(){h(d,e);return!1});a(k,"updateready",function(){v()});a(k,"obsolete",function(){g.location.reload(!0);return!1});a(k,"error",function(){h(d,e);return!1});switch(k.status){case k.UNCACHED:h(d,e);break;case k.IDLE:h(d,e);break;case k.UPDATEREADY:v();break;case k.OBSOLETE:h(d,e)}a(g,"online",function(){try{k.update()}catch(b){}});g.setTimeout(function(){e.isLoaded||h(d,e)},12E3)}else h(d,e)},init:function(b){this.isSupported()&&(null===this.adapter&&
(this.adapter=u),b&&(b.message&&(this.message=String(b.message)),b.delay!==c&&(this.delay=parseInt(b.delay,10))));return this}};n.ns("cache.storage.adapter."+d,l)})(window,document,window.getNs());
(function(g,q,n,c){function h(b,a,c){c.timeoutXhr=g.setTimeout(function(){a(!1)},4E3);C(b,function(b){g.clearTimeout(c.timeoutXhr);delete c.timeoutXhr;b?a(b):a(!1)})}function l(b){var a=null;try{a=k.jsonToObject(b)}catch(c){}return a}function d(b,a,d){if(E){var f=q.createElement("canvas"),e,g=new Image,k=null,h=0,m=0;d||(d="jpeg");g.onerror=function(){g.onload=g.onerror=null;a()};g.onload=function(){g.onload=g.onerror=null;h=f.height=g.height;m=f.width=g.width;e=f.getContext("2d");e.fillStyle="rgba(50, 50, 50, 0)";
e.fillRect(0,0,m,h);e.drawImage(g,0,0);k=f.toDataURL("image/"+d);a(k)};x&&(g.src="");g.src=b;if(g.complete&&g.naturalWidth!==c)g.onload()}else a(!1)}function p(b){var a=b.data,c=b.url;"css"===b.type&&(c=s.url(c),c=c.folder,a=a.replace(/url\(\../g,"url("+c+".."),a=a.replace(/url\(\'../g,"url('"+c+".."),a=a.replace(/url\(\"../g,'url("'+c+".."),b.data=a);return b}function e(b,a){return{ajax:b.ajax,data:b.data,expires:(new Date).getTime()+(b.lifetime||a.lifetime),group:b.group!==c?b.group:a.group,lastmod:b.lastmod||
a.lastmod,lifetime:b.lifetime!==c?b.lifetime:a.lifetime,type:b.type||a.type,version:b.version||a.version}}function a(b,a,c){var f=b.type,e=b.url,g=b.data;b.ajax?"img"===f?d(e,a):h(e,a,b):g?a(g):c(!1)}function b(b){return B&&B[b]?!!B[b]:!1}function f(b,a){var c=null,d,e;b&&b.length?(d=b[0].type,e=b.slice(1),A[d]?c=new A[d](D):f(e,a),c&&c.isSupported()?c.open(function(d){d?(B=b[0],a(c)):f(e,a)}):f(e,a)):a(!1)}function m(b,a,c){var d=null,e=0,g;if(c)try{A[c]?(d=new A[c](D))&&d.isSupported()?d.open(function(f){if(f){g=
a.length;for(e=0;e<g;e+=1)a[e].type===c&&(B=a[e]);B?b(d):m(b,a)}else m(b,a)}):m(b,a):m(b,a)}catch(k){m(b,a)}else f(a,b)}function u(b,a){if(!(this instanceof u))return new u(b,a);this.isEnabled=!0;this.appCacheAdapter=this.adapter=null;this.adapters={types:F,defaults:D};this.resources={defaults:G};this.init(b,a)}var y=n.helpers,z=y.client,s=y.utils,k=y.json,y=y.ajax,r=s.isArray,t=s.callback,v=k.getJson(),C=y.xhr,w=s.trim,A=n.cache.storage.adapter,x=z.isWebkit(),E=z.hasCanvas(),F=[{type:"fileSystem",
css:!0,js:!0,html:!0,img:!0},{type:"indexedDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webSqlDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webStorage",css:!0,js:!0,html:!0,img:!0}],D={name:"localcache",table:"cache",description:"local resource cache",size:4194304,version:"1.0",key:"key",lifetime:"local",offline:!0},B=null,G={ajax:!0,lifetime:2E4,group:0,lastmod:(new Date).getTime(),type:"css",version:1};u.prototype=u.fn={create:function(c,d){d=t(d);if(c&&c.url){var f=this,g=c.url,h=c.type;a(c,function(a){if(a)if(c.data=
a,c=p(c),null!==f.adapter&&b(h)){a=k.jsonToString(g);var m=e(c,f.resources.defaults),l=k.jsonToString(m);c.expires=m.expires;c.version=m.version;try{f.adapter.create(a,l,function(b){b?d(c):d(!1)})}catch(t){d(c)}}else d(c);else d(c)},d)}else d(!1)},read:function(a,c){c=t(c);if(a&&a.url){var d=this,e=a.url,f=a.type;if(null!==this.adapter&&b(f))try{d.adapter.read(k.jsonToString(e),function(b){b?(a=l(b))?(a.url=e,c(a,!0)):d.remove({url:e,type:f},function(){c(!1)}):c(!1)})}catch(g){h(e,function(b){a.data=
b;c(a,!0)},a)}else c(a)}else c(!1)},update:function(c,d){d=t(d);if(c&&c.url){var f=this,g=c.url,h=c.type;a(c,function(a){if(a)if(c.data=a,c=p(c),null!==f.adapter&&b(h)){a=k.jsonToString(g);var m=e(c,f.resources.defaults),l=k.jsonToString(m);c.expires=m.expires;c.version=m.version;try{f.adapter.update(a,l,function(b){b?d(c):d(!1)})}catch(t){d(c)}}else d(c);else f.read(c,function(b){b&&b.data?(c.data=b.data,d(c)):d(!1)})},d)}else d(!1)},remove:function(a,c){c=t(c);if(a&&a.url){var d=a.url,e=a.type;
null!==this.adapter&&b(e)?this.adapter.remove(k.jsonToString(d),function(b){b?c(a):c(!1)}):c(a)}else c(!1)},init:function(b,a){var d=this,e=!1,f,g,h,k;b=t(b);a&&a.isEnabled!==c&&(d.isEnabled=!!a.isEnabled);if(d.isEnabled&&v){if(a){if(a.adapters){f=a.adapters;if(f.types&&r(f.types)){g=f.types;h=g.length;for(k=0;k<h;k+=1)g[k].css===c&&(g[k].css=!0),g[k].js===c&&(g[k].js=!0),g[k].img===c&&(g[k].img=!0),g[k].html===c&&(g[k].html=!0);d.adapters.types=g}f.defaults&&(g=f.defaults,h=d.adapters.defaults,g.name&&
(h.name=w(String(g.name))),g.table&&(h.table=w(String(g.table))),g.description&&(h.description=w(String(g.description))),g.size&&(h.size=parseInt(g.size,10)),g.version&&(h.version=w(String(g.version))),g.key&&(h.key=w(String(g.key))),g.lifetime&&(h.lifetime=w(String(g.lifetime))),g.offline!==c&&(h.offline=!!g.offline));f.preferredType&&(e=w(String(f.preferredType)))}a.resources&&(f=a.resources,f.defaults&&(f=f.defaults,g=d.resources.defaults,f.ajax!==c&&(g.ajax=!!f.ajax),f.lifetime!==c&&(g.lifetime=
parseInt(f.lifetime,10)),f.group!==c&&(g.group=parseInt(f.group,10)),f.lastmod!==c&&(g.lastmod=parseInt(f.lastmod,10)),f.type&&(g.type=w(String(f.type))),f.group!==c&&(g.version=parseFloat(f.version)),f.loaded&&(g.loaded=t(f.loaded))))}m(function(a){a||(d.isEnabled=!1);d.adapter=a;b(d)},d.adapters.types,e);d.adapters.defaults.offline&&(A.applicationCache&&!d.appCacheAdapter)&&(d.appCacheAdapter=new A.applicationCache(D))}else b(d)}};n.ns("cache.storage.controller",u)})(window,document,window.getNs());
(function(g,q){function n(b){var c=a(b.type);if("js"!==c||"css"!==c||"html"!==c||"img"!==c||"custom"!==c){switch(d.url(b.url).extension){case "js":b="js";break;case "css":b="css";break;case "html":b="html";break;case "jpg":case "jpeg":case "png":b="img";break;default:b="custom"}c=b}return c}function c(b,a){if(!(this instanceof c))return new c(b,a);this.storage=null;this.init(b,a)}var h=g.helpers,l=h.dom,d=h.utils,p=h.client,e=d.isArray,a=d.trim,b=d.callback;c.prototype=c.fn={load:function(c,d){var g=
this,h=(new Date).getTime(),z=function(){var b=0,a=0,c=null;return{init:function(d,f){c=f;b=d;a=0},loaded:function(){a+=1;a===b&&c()}}}(),s=function(b,a,c){var d=b.url,f=function(){b.loaded(b);z.loaded()},g=b.node||null;c=!!c;switch(b.type){case "js":l.appendJs(d,a,f,g,c);break;case "css":l.appendCss(d,a,f,g,c);break;case "img":l.appendImg(d,a,f,g,c);break;case "html":l.appendHtml(d,a,f,g,c);break;default:f()}},k=function(a){var c=a.data||null,d=function(a,b){a&&a.data?s(a,a.data,b):s(a,null,b)},
f=g.storage,e=f.resources.defaults;a.ajax=a.ajax!==q?!!a.ajax:e.ajax;a.loaded=a.loaded!==q?b(a.loaded):b(e.loaded);f.read(a,function(b){if(b&&b.data){var e=a,k=g.storage.resources.defaults,m=parseInt(b.lifetime,10),l=b.version,t=b.lastmod?b.lastmod:0,n=!1,r,x=e.lastmod?e.lastmod:0,n=!0;r=!1;e.version=r=e.version!==q?parseFloat(e.version):k.version;e.group=e.group!==q?parseFloat(e.group):k.group;x&&t?(e.lastmod=parseInt(x,10),n=t===e.lastmod):!x&&t?x=t:x||(x=k.lastmod);n=n&&r===l;r=0!==m&&(-1!==m&&
n&&b.expires>h||-1===m&&n);e.lastmod=x;e.isValid=r;a=e;a.isValid||!p.isOnline()?(c=b.data)&&s(a,c):f.update(a,d)}else f.create(a,d)})},r=function(b,c){var d=0,f=b.length,e=null;z.init(f,c);for(d=0;d<f;d+=1)(e=b[d])&&e.url&&(e.url=a(e.url),e.type=n(e),k(e))},t=function(b,a,c){var d=b.length;for(c||(c=0);!b[c]&&c<d;)c+=1;c>=d?a(g):(d=b[c],r(d,function(){t(b,a,c+1)}))};(function(a,c){a&&e(a)||(a=[]);for(var f=a,g=[],k,h=0,l,n=f.length,h=0;h<n;h+=1)l=f[h],(k=l.group)||(k=0),k=g[k]?g[k]:g[k]=[],k.push(l);
a=g;c=b(d);t(a,c)})(c,d)},remove:function(c,d){var g=this.storage,h=function(b,c){var d=b.length,e,f,h=function(b,a){b===d-1&&c()};if(d)for(e=0;e<d;e+=1)(f=b[e])&&f.url&&(f.url=a(f.url),f.type=n(f),g.remove(f,h(e,f.url)));else c()};(function(a,c){a&&e(a)||(a=[]);c=b(d);h(a,c)})(c,d)},init:function(a,c){var d=this;a=b(a);g.cache.storage.controller(function(b){d.storage=b;a(b)},c);return d}};g.ns("cache.controller",c)})(window.getNs());
(function(g,q,n){function c(a){this.storage=this.controller=null;this.params=a;this.queue=new e;this.timeout=this.interval=this.calls=0}function h(a){var e=null,g=d.length,h;a||(a=z);if(b)for(h=0;h<g;h+=1)f(d[h].params)===f(a)&&(e=d[h]);e||(e=new c(a),d.push(e));return e}function l(a,b,c){var d=h(a),e,f,l,m=function(){e=d.interval;g.clearInterval(e);e=g.setInterval(function(){d.timeout=f=d.timeout+u;l=d.storage;d.controller&&(l&&(l.adapter||!l.isEnabled))&&(g.clearInterval(e),d.queue.flush());f>y&&
(g.clearInterval(e),c())},u)};d?d.storage?b(d):(d.queue.add(function(){b(d)}),d.calls+=1,1===d.calls?d.controller=new q.cache.controller(function(a){d.storage=a;d.controller?d.queue.flush():m()},a):m()):c()}var d=[],p=q.helpers,e=p.queue;n=p.utils;var p=p.json,a=n.isArray,b=p.getJson(),f=p.jsonToString,m=n.callback,u=15,y=5E3,z={};n=function(){return{load:function(b,c,d){c=m(c);l(d,function(e){a(b)?e.controller.load(b,c):"applicationCache"===b?(e=e.storage)&&e.appCacheAdapter?e.appCacheAdapter.open(c,
d):c(!1):c(!1)},function(){c(!1)});return this},remove:function(b,c,d){c=m(c);l(d,function(d){a(b)?d.controller.remove(b,c):c(!1)},function(){c(!1)});return this},setup:function(a){a&&(z=a);return this}}}();q.ns("cache.load",n.load);q.ns("cache.remove",n.remove);q.ns("cache.setup",n.setup)})(window,window.getNs());
