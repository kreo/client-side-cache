(function(b,r){function f(){b[h]||(b[h]={});return b[h]}var h="app",k;k=f();k.namespace=k.ns=function(k,f){if(k){k=String(k);var l=k.split("."),d=l.length,e=b[h],a;e||(b[h]={});if(!l)return!1;for(a=0;a<d;a+=1)e[l[a]]||(e[l[a]]={}),a===d-1&&f!==r&&(e[l[a]]=f),e=e[l[a]];return e}return!1};b[h]=k;b.getNamespace=b.getNs=f})(window);
(function(b,r){function f(){if(!(this instanceof f))return new f;this.methods=[];this.response=null;this.flushed=!1}f.prototype=f.fn={add:function(b){this.flushed?b(this.response):this.methods.push(b)},flush:function(b){if(!this.flushed)for(this.response=b,this.flushed=!0;this.methods[0];)this.methods.shift()(b)}};b.ns("helpers.queue",f)})(window.getNs());
(function(b,r,f,h){var k=function(){var f=null,n=[];return{isString:function(b){return"string"===typeof b||b instanceof String},isFunction:function(b){return"function"===typeof b||b instanceof Function},isArray:function(b){var d=Array.isArray,e=Object.prototype.toString;k.isArray=d&&"function"===typeof d?function(a){return d(a)}:e&&"function"===e?function(a){return"[object Array]"===e.call(a)}:function(a){return!!a.sort&&"function"===typeof a.sort};return k.isArray(b)},inArray:function(b,d,e){k.inArray=
Array.prototype.indexOf?function(a,c,g){return n.indexOf.call(c,a,g)}:function(a,c,g){var e=c.length,d=0;if(g)return c[g]&&c[g]===a?g:-1;for(d=0;d<e;d+=1)if(c[d]===a)return d;return-1};return k.inArray(b,d,e)},callback:function(b){k.isFunction(b)||(b=function(){return h});return b},on:function(h,d,e){k.on="function"===typeof b.addEventListener?function(a,c,g){a.addEventListener(c,g,!1)}:"function"===typeof r.attachEvent?function(a,c,g){a.attachEvent("on"+c,g)}:function(a,c,g){a["on"+c]=g};k.on(h,
d,e)},off:function(h,d,e){k.off="function"===typeof b.removeEventListener?function(a,c,g){a.removeEventListener(c,g,!1)}:"function"===typeof r.detachEvent?function(a,c,g){a.detachEvent("on"+c,g)}:function(a,c){a["on"+c]=null};k.off(h,d,e)},getXhr:function(){for(var b=null,d=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],e=d.length,a=0,a=0;a<
e;a+=1){try{b=d[a]()}catch(c){continue}break}return b},xhr:function(b,d,e,a){var c=k.getXhr(),g,x="GET";d=k.callback(d);if(c)if(b){a!==h?x="POST":a=null;e===h&&(e=!0);g=function(){if(4===c.readyState&&(200<=c.status&&400>c.status||0===c.status))try{var a=c.responseText;a?d(a):d(!1)}catch(g){d(!1)}else 4===c.readyState&&d(!1)};c.open(x,b,e);try{c.onreadystatechange!==h?c.onreadystatechange=g:c.onload!==h&&(c.onload=g)}catch(z){}c.send(a)}else d(!1);else d(!1)},getJson:function(){null===f&&(b.JSON&&
b.JSON.stringify)&&(f=b.JSON);return f},jsonToString:function(b){var d=!1;null===f&&(f=k.getJson());f&&b!==h&&(d=f.stringify(b));return d},jsonToObject:function(b){var d=!1;null===f&&(f=k.getJson());f&&b!==h&&(d=f.parse(b));return d},url:function(b){if(k.isString(b)){var d=r.createElement("a"),e;d.href=b;e=d.pathname.match(/\/([^\/?#]+)$/i);return{source:b,protocol:d.protocol,host:d.hostname,port:d.port,query:d.search,file:e?e[1]:"/",hash:d.hash,path:d.pathname.replace(/^([^\/])/,"/$1"),extension:function(a){a=
a.split(".");return a.length?a[a.length-1]:!1}(b),folder:function(){var a=b.lastIndexOf("/");return b.substr(0,a+1)}()}}},trim:function(b){if(!k.isString(b))return b;k.isFunction(String.prototype.trim)||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});return b.trim()}}}();f.ns("helpers.utils",k)})(window,document,window.getNs());
(function(b,r,f,h){var k=function(){function k(){d===h&&(c(b,"online",k),c(b,"offline",k));d=r.onLine!==h?!!r.onLine:!0}var n,l,d,e,a=(r.userAgent||r.vendor||b.opera).toLowerCase(),c=f.helpers.utils.on;return{isMsie:function(){l===h&&(l=null!==a.match(/(msie)/));return l},isOpera:function(){n===h&&(n=null!==a.match(/(opera)/));return n},isOnline:function(){d===h&&k();return d},hasCanvas:function(){if(e===h){var a=document.createElement("canvas");e=!(!a.getContext||!a.getContext("2d"))}return e}}}();
f.ns("helpers.client",k)})(window,window.navigator,window.getNs());
(function(b,r,f){function h(h,k){k&&(k.dom?h=k.dom:k.id&&(h=b.getElementById(k.id)));return h}var k=function(){var p=r.helpers,n=p.utils,l=p.client,d=[],e=[],a=[],c=[],g=b.getElementsByTagName("head")[0];return{nuke:function(){d=[];e=[];a=[];c=[]},createDomNode:function(a,c){var g=b.createElement(a),e;if(c)for(e in c)c.hasOwnProperty(e)&&g.setAttribute(e,c[e]);return g},getAttribute:function(a,c){return a.getAttribute(c)},setAttribute:function(a,c,g){a.setAttribute(c,g)},appendCss:function(a,c,e,
u,q){if(-1===n.inArray(a,d)||q){var m=null,f=!1,s,v,m=h(m,u);if(null!==c){m||(m=k.createDomNode("style",{type:"text/css"}),m.className="lazyloaded");m.onerror=function(){e(!1)};u||g.appendChild(m);try{s=b.createTextNode(c),m.appendChild(s)}catch(A){m.styleSheet.cssText=c}finally{e(!0)}}else null!==a&&(m||(m=k.createDomNode("link",{rel:"stylesheet",type:"text/css"}),m.className="lazyloaded"),m.onerror=m.error=function(){m.onload=m.load=null;f=!0;window.clearTimeout(v);e(!1)},u||g.appendChild(m),l.isMsie()||
l.isOpera()?m.onload=m.load=function(){m.onerror=m.error=null;f=!0;window.clearTimeout(v);e(!0)}:e(!0),m.href=a,v=window.setTimeout(function(){f||e(!1)},4E3));d.push(a)}else e(!0)},appendJs:function(a,c,d,u,q){if(-1===n.inArray(a,e)||q){q=k.createDomNode("script");var m=b.getElementsByTagName("script")[0],f=!1,s=!1,v;(q=h(q,u))?(q.type="text/javascript",q.className="lazyloaded",q.async=!0,q.onreadystatechange=q.onload=function(){s||this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||
(this.onreadystatechange=this.onload=null,f=s=!0,window.clearTimeout(v),e.push(a),d(!0))},q.onerror=function(){this.onload=this.onreadystatechange=this.onerror=null;window.clearTimeout(v);f=!0;d(!1)},u||(m?m.parentNode.insertBefore(q,m):g.appendChild(q)),c&&!s?(q.textContent?q.textContent=c:q.nodeValue?q.nodeValue=c:q.text=c,f=s=!0):null!==a&&(q.src=a),s&&(e.push(a),f=!0,d(!0)),f||(v=window.setTimeout(function(){s||d(!1)},5E3))):d(!1)}else d(!0)},appendImg:function(c,g,b,e){var d=null;(d=h(d,e))||
(d=new Image);d.onerror=function(){d.onload=d.onerror=null;b(!1)};d.onload=function(){d.onload=d.onerror=null;b(!0)};g?d.src=g:c&&(d.src=c);if(d.complete&&d.naturalWidth!==f)d.onload();a.push(c)},appendHtml:function(a,g,d,e){var f=h(null,e);if(f){if(g)try{f.innerHTML=g,e.id&&l.isMsie()&&b.styleSheets[0].addRule("#"+e.id+":after",'content: " ";')}catch(m){f.innerText=g}d(!0);c.push(a)}else d(!1)}}}();r.ns("helpers.dom",k)})(document,window.getNs());
(function(b,r){function f(a,c,g){var d=function(a){g(!1)};if("."===c[0]||""===c[0])c=c.slice(1);c[0]?a.getDirectory(c[0],{create:!0},function(a){c.length?f(a,c.slice(1),g):g(!0)},d):g(!0)}function h(a,c,g){c=c.split("/");var e=c.length,b="",h=0;g=d(g);if(e){for(h=0;h<e-1;h+=1)b=b+c[h]+"/";f(a.root,b.split("/"),g)}else g(!0)}function k(a){if(!(this instanceof k))return new k(a);this.adapter=null;this.type=p;this.size=52428800;this.init(a)}var p="fileSystem",n=b.getNs&&b.getNs()||b,l=n.helpers.utils,
d=l.callback,e=null;k.prototype=k.fn={isSupported:function(){null===e&&(e=(!!b.requestFileSystem||!!b.webkitRequestFileSystem||!!b.moz_requestFileSystem)&&(!!b.Blob||!!b.BlobBuilder)&&b.FileReader);return e},open:function(a){var c=this,g=c.adapter,h=function(c){a(!1)};a=d(a);e?null===g?(b.requestFileSystem=b.requestFileSystem||b.webkitRequestFileSystem||b.moz_requestFileSystem,b.requestFileSystem(b.TEMPORARY,c.size,function(d){g=c.adapter=d;try{c.create("test-item",l.jsonToString({test:"test-content"}),
function(d){d?c.remove("test-item",function(){a(g)}):a(!1)})}catch(e){a(!1)}},h)):a(g):a(!1)},create:function(a,c,g){g=d(g);if(a&&e){var b=this.adapter,f=function(a){g(!1,a)};h(b,a,function(){b.root.getFile(a,{create:!0},function(a){a.createWriter(function(a){var d;a.onwriteend=function(){g(!0)};a.onerror=f;try{Blob?(d=new Blob([c],{type:"text/plain"}),a.write(d)):BlobBuilder&&(d=new BlobBuilder,d.append(c),a.write(d.getBlob("application/json")))}catch(b){f(b)}},f)},f)})}else g(!1)},read:function(a,
c){c=d(c);if(a&&e){var g=this.adapter,b=function(a){c(!1,a)};h(g,a,function(){g.root.getFile(a,{create:!1},function(a){a.file(function(a){var d=new FileReader;d.onloadend=function(){c(this.result)};d.onerror=b;d.onabort=b;d.readAsText(a)},b)},b)})}else c(!1)},update:function(a,c,d){this.create(a,c,d)},remove:function(a,c){c=d(c);if(a&&e){var g=this.adapter,b=function(a){c(!1,a)};h(g,a,function(){g.root.getFile(a,{create:!1},function(a){a.remove(function(){c(!0)},b)},b)})}else c(!1)},init:function(a){return this.isSupported()?
(a&&a.size&&(this.size=a.size),this):!1}};l.isFunction(n.ns)?n.ns("cache.storage.adapter."+p,k):n[p]=k})(window);
(function(b,r){function f(d){if(!(this instanceof f))return new f(d);this.adapter=null;this.type=h;this.dbName="cache";this.dbVersion="1.0";this.dbTable="offline";this.dbDescription="offline cache";this.dbKey="key";this.init(d)}var h="indexedDatabase",k=b.getNs&&b.getNs()||b,p=k.helpers.utils,n=p.callback,l=null;f.prototype=f.fn={isSupported:function(){null===l&&(l=!!b.indexedDB||!!b.webkitIndexedDB||!!b.mozIndexedDB||!!b.OIndexedDB||!!b.msIndexedDB);return l},create:function(d,b,a){a=n(a);if(d&&
l){var c=this.dbTable,g=this.adapter.transaction([c],"readwrite");d=g.objectStore(c).put({key:d,content:b});g.onerror=function(c){a(!1,c)};d.onerror=function(c){a(!1,c)};d.onsuccess=function(){a(!0)}}else a(!1)},read:function(d,b){b=n(b);if(d&&l){var a=this.dbTable,c=this.adapter.transaction([a],"readonly"),a=c.objectStore(a).get(d);c&&a?(c.onerror=function(a){b(!1,a)},a.onerror=function(a){b(!1,a)},a.onsuccess=function(a){a.target.result&&a.target.result.content?b(a.target.result.content):b(!1)}):
b(!1)}else b(!1)},update:function(b,e,a){this.create(b,e,a)},remove:function(b,e){e=n(e);if(b&&l){var a=this.dbTable,c=this.adapter.transaction([a],"readwrite"),a=c.objectStore(a).put({key:b,content:""});c.onerror=function(a){e(!1,a)};a.onerror=function(a){e(!1,a)};a.onsuccess=function(){e(!0)}}else e(!1)},open:function(d,e){e||(e=!1);d=n(d);var a=this,c=null,g=null,h=null,f=a.dbName,k=a.dbTable,u=function(c){c||d(!1);a.create("test-item",'{test: "test-content"}',function(b){b?a.remove("test-item",
function(){d(c)}):d(!1)})},q,m,l,s,v;if(null===a.adapter)if(c=b.indexedDB||b.webkitIndexedDB||b.mozIndexedDB||b.OIndexedDB||b.msIndexedDB){b.webkitIndexedDB!==r&&(b.IDBTransaction=b.webkitIDBTransaction,b.IDBKeyRange=b.webkitIDBKeyRange);q=function(c){c.createIndex(a.dbKey,a.dbKey,{unique:!0});c.createIndex("content","content",{unique:!1})};m=function(c){var b=g.result,e,f;a.adapter=b;a.dbVersion===b.version||!b.setVersion&&"function"!==typeof b.setVersion?(a.adapter=b,u(b)):(h=c.currentTarget.result.setVersion(a.dbVersion),
h.onfailure=function(a){d(!1)},h.onsuccess=function(c){e=g.result;try{f=e.createObjectStore(k,{keyPath:a.dbKey}),q(f)}catch(b){d(!1)}})};l=function(c){c=g.result.createObjectStore(k,{keyPath:a.dbKey});q(c)};s=function(c){e||a.open(d,!0);d(!1)};v=function(a){d(!1)};if(e)try{g=c.open(f,a.dbVersion)}catch(A){g=c.open(f)}else g=c.open(f);g.onsuccess=m;g.onupgradeneeded=l;g.onerror=s;g.onblocked=v}else d(!1);else u(a.adapter)},init:function(b){return this.isSupported()?(b&&(b.name&&(this.dbName=String(b.name)),
b.version&&(this.dbVersion=parseInt(b.version,10)),b.table&&(this.dbTable=b.table),b.description&&(this.dbDescription=String(b.description)),b.key&&(this.dbKey=b.key)),this):!1}};p.isFunction(k.ns)?k.ns("cache.storage.adapter."+h,f):k[h]=f})(window);
(function(b,r){function f(b,a,c,d,h,f){!f&&b?b.transaction(function(b){b.executeSql(a,c,d,h)}):f?f.executeSql(a,c,d,h):h(null,{code:0,message:k+" isn't available"})}function h(b){if(!(this instanceof h))return new h(b);this.adapter=null;this.type=k;this.dbName="cache";this.dbVersion="1.0";this.dbDescription="resource cache";this.dbTable="websql";this.dbSize=4194304;this.init(b)}var k="webSqlDatabase",p=b.getNs&&b.getNs()||b,n=p.helpers.utils,l=n.callback,d=null;h.prototype=h.fn={isSupported:function(){null===
d&&(d=!!b.openDatabase);return d},create:function(b,a,c){c=l(c);b&&d?f(this.adapter,"INSERT INTO "+this.dbTable+" (key, content) VALUES (?,?);",[b,a],function(){c(!0)},function(a,b){c(!1,b,{transaction:a})}):c(!1)},read:function(b,a){a=l(a);b&&d?f(this.adapter,"SELECT content FROM "+this.dbTable+" WHERE key=?;",[b],function(c,b){var d=!1;b&&(b.rows&&1===b.rows.length)&&(d=b.rows.item(0).content);a(d,null,{transaction:c})},function(b,d){a(!1,d,{transaction:b})}):a(!1)},update:function(b,a,c){c=l(c);
b&&d?f(this.adapter,"UPDATE "+this.dbTable+" SET content = ?  WHERE key=?;",[a,b],function(){c(!0)},function(a,b){c(!1,b,{transaction:a})}):c(!1)},remove:function(b,a){a=l(a);b&&d?f(this.adapter,"DELETE FROM "+this.dbTable+" WHERE key = ?;",[b],function(){a(!0)},function(b,d){a(!1,d,{transaction:b})}):a(!1)},open:function(e){e=l(e);if(d){var a=this,c=a.adapter,g,h=function(b){b||e(!1);g=function(c){c?a.remove("test-item",function(){e(b)}):e(!1)};a.read("test-item",function(b){b?a.update("test-item",
'{test: "test-content"}',g):a.create("test-item",'{test: "test-content"}',g)})},k=function(b,c){f(b,"CREATE TABLE IF NOT EXISTS "+a.dbTable+"(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, key TEXT NOT NULL UNIQUE, content TEXT NOT NULL);",[],function(){h(a.adapter)},function(a){h(!1)},c)},t=function(a){k(null,a)},u=function(a){e(!1)};try{if(null===c&&a.isSupported())if(a.adapter=c=b.openDatabase(a.dbName,"",a.dbDescription,a.dbSize),String(c.version)!==String(a.dbVersion)&&c.changeVersion&&"function"===
typeof c.changeVersion)try{c.changeVersion(c.version,a.dbVersion,t,u)}catch(q){e(!1)}else c=b.openDatabase(a.dbName,a.dbVersion,a.dbDescription,a.dbSize),k(c);else a.isSupported()&&h(c)}catch(m){e(!1)}}else e(!1)},init:function(b){return this.isSupported()?(b&&(b.description&&(this.dbDescription=b.description),b.name&&(this.dbName=b.name),b.size&&(this.dbSize=b.size),b.table&&(this.dbTable=b.table),b.version&&(this.dbVersion=String(b.version))),this):!1}};n.isFunction(p.ns)?p.ns("cache.storage.adapter."+
k,h):p[k]=h})(window);
(function(b,r){function f(a){a=l(a);switch(a){case "local":a="localStorage";break;case "session":a="sessionStorage";break;default:a="localStorage"}return a}function h(a){if(!(this instanceof h))return new h(a);this.adapter=null;this.type=k;this.lifetime="local";this.asynch=!0;this.init(a)}var k="webStorage",p=b.getNs&&b.getNs()||b,n=p.helpers.utils,l=n.trim,d=n.callback,e=null;h.prototype=h.fn={isSupported:function(){var a=f(this.lifetime);if(null===e)try{e=!!b[a]&&!!b[a].getItem}catch(c){e=!1}return e},
create:function(a,b,g){var e=this,h=!0,f=function(a){if(e.asynch)g(a);else return a};g=d(g);if(!a)return f(!1);try{e.adapter.setItem(a,b)}catch(k){h=!h}return f(h)},read:function(a,b){var g=this,e,h=!0,f=function(a){if(g.asynch)b(a);else return a};b=d(b);if(!a)return f(!1);try{h=(e=g.adapter.getItem(a))?e:!1}catch(k){h=!h}return f(h)},update:function(a,b,d){if(this.asynch)this.create(a,b,d);else return this.create(a,b,d)},remove:function(a,b){var g=this,e=!0,h=function(a){if(g.asynch)b(a);else return a};
b=d(b);if(!a)return h(!1);try{g.adapter.removeItem(a)}catch(f){e=!e}return h(e)},open:function(a){var c=this,g=c.adapter,e=f(c.lifetime),h,k,u=function(b){if(c.asynch)a(b);else return b};a=d(a);if(null===g)try{if(g=c.adapter=b[e],c.asynch)c.create("test-item",'{test: "test-content"}',function(b){b?c.remove("test-item",function(){a(g)}):a(!1)});else{if(h=c.create("test-item",'{test: "test-content"}'))if(k=c.remove("test-item"))return g;return!1}}catch(q){return u(!1)}else if(c.isSupported())return u(g)},
init:function(a){return this.isSupported()?(a&&(a.lifetime&&(this.lifetime=l(String(a.lifetime))),a.asynch!==r&&(this.asynch=!!a.asynch)),this):!1}};n.isFunction(p.ns)?p.ns("cache.storage.adapter."+k,h):p[k]=h})(window);
(function(b,r,f){function h(a,c){c.isLoaded||(c.isLoaded=!0,c.progressCallback(100),b.setTimeout(function(){a()},c.delay))}function k(a){if(!(this instanceof k))return new k(a);this.adapter=null;this.type=p;this.isLoaded=!1;this.delay=0;this.opened=!0;this.message="New version is available. Update page?";this.init(a)}var p="applicationCache",n=b.getNs&&b.getNs()||b,l=n.helpers,d=l.utils,e=l.dom,a=d.on,c=d.callback,g=null,x=r.getElementsByTagName("html")[0];k.prototype=k.fn={isSupported:function(){null===
g&&(g=!!b.applicationCache&&!!e.getAttribute(x,"manifest"));return g},open:function(d,g){var e=this,k=e.adapter,m=0,l,s;e.opened=!0;d=c(d);g&&g.progress&&(l=g.progress);l=e.progressCallback=c(l);if(e.isSupported()&&null!==k){s=function(){try{k.swapCache()}catch(a){}confirm(e.message)?b.location.reload(!0):h(d,e);return!1};a(k,"noupdate",function(){h(d,e);return!1});a(k,"downloading",function(){m=0;return!1});a(k,"progress",function(a){var b=0;e.delay=500;m+=1;b=a&&a.lengthComputable!==f?Math.round(100*
a.loaded/a.total):Math.round(100*m/20);l(b);return!1});a(k,"cached",function(){h(d,e);return!1});a(k,"updateready",function(){s()});a(k,"obsolete",function(){b.location.reload(!0);return!1});a(k,"error",function(){h(d,e);return!1});switch(k.status){case k.UNCACHED:h(d,e);break;case k.IDLE:h(d,e);break;case k.UPDATEREADY:s();break;case k.OBSOLETE:h(d,e)}a(b,"online",function(){try{k.update()}catch(a){}});b.setTimeout(function(){e.isLoaded||h(d,e)},12E3)}else h(d,e)},init:function(a){var c=this.adapter;
this.isSupported()&&(null===c&&(this.adapter=b.applicationCache),a&&a.message&&(this.message=String(a.message)));return this}};n.ns("cache.storage.adapter."+p,k)})(window,document);
(function(b,r,f,h){function k(a,c,d){d.timeout=b.setTimeout(function(){c(!1)},4E3);B(a,function(a){b.clearTimeout(d.timeout);delete d.timeout;a?c(a):c(!1)})}function p(a){var b=null;try{b=t.jsonToObject(a)}catch(c){}return b}function n(a,b,c){if(A){var d=r.createElement("canvas"),e,g=new Image,f=null,k=0,m=0;c||(c="jpeg");g.onerror=function(){g.onload=g.onerror=null;b()};g.onload=function(){g.onload=g.onerror=null;k=d.height=g.height;m=d.width=g.width;e=d.getContext("2d");e.fillStyle="rgba(50, 50, 50, 0)";
e.fillRect(0,0,m,k);e.drawImage(g,0,0);f=d.toDataURL("image/"+c);b(f)};g.src=a;if(g.complete&&g.naturalWidth!==h)g.onload()}else b(!1)}function l(a){var b=a.data,c=a.url;"css"===a.type&&(c=t.url(c),c=c.folder,b=b.replace(/url\(\../g,"url("+c+".."),b=b.replace(/url\(\'../g,"url('"+c+".."),b=b.replace(/url\(\"../g,'url("'+c+".."),a.data=b);return a}function d(a,b){return{ajax:a.ajax,data:a.data,expires:(new Date).getTime()+(a.lifetime||b.lifetime),group:a.group!==h?a.group:b.group,lastmod:a.lastmod||
b.lastmod,lifetime:a.lifetime!==h?a.lifetime:b.lifetime,type:a.type||b.type,version:a.version||b.version}}function e(a){return y&&y[a]?!!y[a]:!1}function a(b,c){var d=null,e,g;b&&b.length?(e=b[0].type,g=b.slice(1),v[e]?d=new v[e](w):a(g,c),d&&d.isSupported()?d.open(function(e){e?(y=b[0],c(d)):a(g,c)}):a(g,c)):c(!1)}function c(b,d,e){var g=null,h=0,f;if(e)try{v[e]?(g=new v[e](w))&&g.isSupported()?g.open(function(a){if(a){f=d.length;for(h=0;h<f;h+=1)d[h].type===e&&(y=d[h]);y?b(g):c(b,d)}else c(b,d)}):
c(b,d):c(b,d)}catch(k){c(b,d)}else a(d,b)}function g(a,b){if(!(this instanceof g))return new g(a,b);this.isEnabled=!0;this.appCacheAdapter=this.adapter=null;this.adapters={types:C,defaults:w};this.resources={defaults:D};this.init(a,b)}var x=f.helpers,z=x.client,t=x.utils,u=t.isArray,q=t.callback,m=t.getJson(),B=t.xhr,s=t.trim,v=f.cache.storage.adapter,A=z.hasCanvas(),C=[{type:"fileSystem",css:!0,js:!0,html:!0,img:!0},{type:"indexedDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webSqlDatabase",css:!0,
js:!0,html:!0,img:!0},{type:"webStorage",css:!0,js:!0,html:!0,img:!0}],w={name:"localcache",table:"cache",description:"local resource cache",size:4194304,version:"1.0",key:"key",lifetime:"local",offline:!0},y=null,D={ajax:!0,lifetime:2E4,group:0,lastmod:(new Date).getTime(),type:"css",version:1};g.prototype=g.fn={create:function(a,b){b=q(b);if(a&&a.url){var c=this,g=a.url,h=a.type,f=function(f){if(f)if(a.data=f,a=l(a),null!==c.adapter&&e(h)){f=t.jsonToString(g);var k=d(a,c.resources.defaults),m=t.jsonToString(k);
a.expires=k.expires;a.version=k.version;try{c.adapter.create(f,m,function(c){c?b(a):b(!1)})}catch(s){b(a)}}else b(a);else b(a)};a.ajax?"img"===h?n(g,f):k(g,f,a):a.data?f(a.data):b(!1)}else b(!1)},read:function(a,b){b=q(b);if(a&&a.url){var c=this,d=a.url,g=a.type;if(null!==this.adapter&&e(g))try{c.adapter.read(t.jsonToString(d),function(e){e?(a=p(e))?(a.url=d,b(a,!0)):c.remove({url:d,type:g},function(){b(!1)}):b(!1)})}catch(h){k(d,function(c){a.data=c;b(a,!0)},a)}else b(a)}else b(!1)},update:function(a,
b){b=q(b);if(a&&a.url){var c=this,g=a.url,h=a.type,f=function(f){if(f)if(a.data=f,a=l(a),null!==c.adapter&&e(h)){f=t.jsonToString(g);var k=d(a,c.resources.defaults),m=t.jsonToString(k);a.expires=k.expires;a.version=k.version;try{c.adapter.update(f,m,function(c){c?b(a):b(!1)})}catch(s){b(a)}}else b(a);else c.read(a,function(c){c&&c.data?(a.data=c.data,b(a)):b(!1)})};a.ajax?"img"===h?n(g,f):k(g,f,a):a.data?f(a.data):b(!1)}else b(!1)},remove:function(a,b){b=q(b);if(a&&a.url){var c=a.url,d=a.type;null!==
this.adapter&&e(d)?this.adapter.remove(t.jsonToString(c),function(c){c?b(a):b(!1)}):b(a)}else b(!1)},init:function(a,b){var d=this,g=!1,e,f,k,l;a=q(a);b&&b.isEnabled!==h&&(d.isEnabled=!!b.isEnabled);if(d.isEnabled&&m){if(b){if(b.adapters){e=b.adapters;if(e.types&&u(e.types)){f=e.types;k=f.length;for(l=0;l<k;l+=1)f[l].css===h&&(f[l].css=!0),f[l].js===h&&(f[l].js=!0),f[l].img===h&&(f[l].img=!0),f[l].html===h&&(f[l].html=!0);d.adapters.types=f}e.defaults&&(f=e.defaults,k=d.adapters.defaults,f.name&&
(k.name=s(String(f.name))),f.table&&(k.table=s(String(f.table))),f.description&&(k.description=s(String(f.description))),f.size&&(k.size=parseInt(f.size,10)),f.version&&(k.version=s(String(f.version))),f.key&&(k.key=s(String(f.key))),f.lifetime&&(k.lifetime=s(String(f.lifetime))),f.offline!==h&&(k.offline=!!f.offline));e.preferredType&&(g=s(String(e.preferredType)))}b.resources&&(e=b.resources,e.defaults&&(e=e.defaults,f=d.resources.defaults,e.ajax!==h&&(f.ajax=!!e.ajax),e.lifetime!==h&&(f.lifetime=
parseInt(e.lifetime,10)),e.group!==h&&(f.group=parseInt(e.group,10)),e.lastmod!==h&&(f.lastmod=parseInt(e.lastmod,10)),e.type&&(f.type=s(String(e.type))),e.group!==h&&(f.version=parseFloat(e.version)),e.loaded&&(f.loaded=q(e.loaded))))}c(function(b){d.adapter=b;a(d)},d.adapters.types,g);d.adapters.defaults.offline&&(v.applicationCache&&!d.appCacheAdapter)&&(d.appCacheAdapter=new v.applicationCache(w))}else a(d)}};f.ns("cache.storage.controller",g)})(window,document,window.getNs());
(function(b,r){function f(a){var b=e(a.type);if("js"!==b||"css"!==b||"html"!==b||"img"!==b||"custom"!==b){switch(n.url(a.url).extension){case "js":a="js";break;case "css":a="css";break;case "html":a="html";break;case "jpg":case "jpeg":case "png":a="img";break;default:a="custom"}b=a}return b}function h(a,b){if(!(this instanceof h))return new h(a,b);this.storage=null;this.init(a,b)}var k=b.helpers,p=k.dom,n=k.utils,l=k.client,d=n.isArray,e=n.trim,a=n.callback;h.prototype=h.fn={load:function(b,g){var h=
this,k=(new Date).getTime(),t=function(){var a=0,b=0,c=null;return{init:function(d,e){c=e;a=d;b=0},loaded:function(){b+=1;b===a&&c()}}}(),u=function(a,b,c){var d=a.url,e=function(){a.loaded(a);t.loaded()},f=a.node||null;c=!!c;switch(a.type){case "js":p.appendJs(d,b,e,f,c);break;case "css":p.appendCss(d,b,e,f,c);break;case "img":p.appendImg(d,b,e,f,c);break;case "html":p.appendHtml(d,b,e,f,c);break;default:e()}},q=function(b){var c=b.data||null,d=function(a,b){a&&a.data?u(a,a.data,b):u(a,null,b)},
e=h.storage,f=e.resources.defaults;b.ajax=b.ajax!==r?!!b.ajax:f.ajax;b.loaded=b.loaded!==r?a(b.loaded):a(f.loaded);e.read(b,function(a){if(a&&a.data){var f=b,g=h.storage.resources.defaults,m=parseInt(a.lifetime,10),q=a.version,t=a.lastmod?a.lastmod:0,n=!1,p,w=f.lastmod?f.lastmod:0,n=!0;p=!1;f.version=p=f.version!==r?parseFloat(f.version):g.version;f.group=f.group!==r?parseFloat(f.group):g.group;w&&t?(f.lastmod=parseInt(w,10),n=t===f.lastmod):!w&&t?w=t:w||(w=g.lastmod);n=n&&p===q;p=0!==m&&(-1!==m&&
n&&a.expires>k||-1===m&&n);f.lastmod=w;f.isValid=p;b=f;b.isValid||!l.isOnline()?(c=a.data)&&u(b,c):e.update(b,d)}else e.create(b,d)})},m=function(a,b){var c=0,d=a.length,g=null;t.init(d,b);for(c=0;c<d;c+=1)(g=a[c])&&g.url&&(g.url=e(g.url),g.type=f(g),q(g))},n=function(a,b,c){var d=a.length;for(c||(c=0);!a[c]&&c<d;)c+=1;c>=d?b(h):(d=a[c],m(d,function(){n(a,b,c+1)}))};(function(b,c){b&&d(b)||(b=[]);for(var e=b,f=[],h,k=0,m,l=e.length,k=0;k<l;k+=1)m=e[k],(h=m.group)||(h=0),h=f[h]?f[h]:f[h]=[],h.push(m);
b=f;c=a(g);n(b,c)})(b,g)},remove:function(b,g){var h=this.storage,k=function(a,b){var c=a.length,d,g,k=function(a,d){a===c-1&&b()};if(c)for(d=0;d<c;d+=1)(g=a[d])&&g.url&&(g.url=e(g.url),g.type=f(g),h.remove(g,k(d,g.url)));else b()};(function(b,c){b&&d(b)||(b=[]);c=a(g);k(b,c)})(b,g)},init:function(c,d){var e=this;c=a(c);b.cache.storage.controller(function(a){e.storage=a;c(a)},d);return e}};b.ns("cache.controller",h)})(window.getNs());
(function(b,r,f){function h(a){this.storage=this.controller=null;this.params=a;this.queue=new l;this.timeout=this.interval=this.calls=0}function k(b){var c=null,d=n.length,f;b||(b=z);if(e)for(f=0;f<d;f+=1)a(n[f].params)===a(b)&&(c=n[f]);c||(c=new h(b),n.push(c));return c}function p(a,c,d){var e=k(a),f,h,l=function(){f=e.interval;b.clearInterval(f);f=b.setInterval(function(){e.timeout=h=e.timeout+g;e.controller&&e.storage&&(b.clearInterval(f),e.queue.flush());h>x&&(b.clearInterval(f),d())},g)};e?e.storage?
c(e):(e.queue.add(function(){c(e)}),e.calls+=1,1===e.calls?e.controller=new r.cache.controller(function(a){e.storage=a;e.controller?e.queue.flush():l()},a):l()):d()}var n=[];f=r.helpers;var l=f.queue;f=f.utils;var d=f.isArray,e=f.getJson(),a=f.jsonToString,c=f.callback,g=25,x=5E3,z={};f=function(){return{load:function(a,b,e){b=c(b);p(e,function(c){d(a)?c.controller.load(a,b):"applicationCache"===a?(c=c.storage)&&c.appCacheAdapter?c.appCacheAdapter.open(b,e):b(!1):b(!1)},function(){b(!1)});return this},
remove:function(a,b,e){b=c(b);p(e,function(c){d(a)?c.controller.remove(a,b):b(!1)},function(){b(!1)});return this},setup:function(a){a&&(z=a);return this}}}();r.ns("cache.load",f.load);r.ns("cache.remove",f.remove);r.ns("cache.setup",f.setup)})(window,window.getNs());
