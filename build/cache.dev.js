(function(f,s){function k(){f[e]||(f[e]={});return f[e]}var e="app",h;h=k();h.namespace=function(h,k){if(h){h=String(h);var l=h.split("."),s=l.length,v=f[e],p;v||(f[e]={});if(!l)return!1;for(p=0;p<s;p+=1)v[l[p]]||(v[l[p]]={},p===s-1&&k&&(v[l[p]]=k)),v=v[l[p]];return v}return!1};f[e]=h;f.getNamespace=f.getNs=k})(window);
(function(f,s){function k(){if(!(this instanceof k))return new k;this.methods=[];this.response=null;this.flushed=!1}k.prototype=k.fn={add:function(e){this.flushed?e(this.response):this.methods.push(e)},flush:function(e){if(!this.flushed)for(this.response=e,this.flushed=!0;this.methods[0];)this.methods.shift()(e)}};f.namespace("helpers.queue",k)})(window.getNs());
(function(f,s,k,e){var h=function(){var k=null,n=f.console!==e,l=n?f.console:null,r=n&&l.log!==e,v=n&&l.warn!==e,p=n&&l.time!==e&&l.timeEnd!==e,t=[];return{isString:function(c){return"string"===typeof c||c instanceof String},isFunction:function(c){return"function"===typeof c||c instanceof Function},isArray:function(c){var b=Array.isArray,a=Object.prototype.toString;h.isArray=b&&"function"===typeof b?function(d){return b(d)}:a&&"function"===a?function(d){return"[object Array]"===a.call(d)}:function(d){return!!d.sort&&
"function"===typeof d.sort};return h.isArray(c)},inArray:function(c,b,a){h.inArray=Array.prototype.indexOf?function(d,b,a){return t.indexOf.call(b,d,a)}:function(d,b,a){var c=b.length,e=0;if(a)return b[a]&&b[a]===d?a:-1;for(e=0;e<c;e+=1)if(b[e]===d)return e;return-1};return h.inArray(c,b,a)},callback:function(c){h.isFunction(c)||(c=function(){return e});return c},on:function(c,b,a){h.on="function"===typeof f.addEventListener?function(b,a,c){b.addEventListener(a,c,!1)}:"function"===typeof s.attachEvent?
function(b,a,c){b.attachEvent("on"+a,c)}:function(b,a,c){b["on"+a]=c};h.on(c,b,a)},off:function(c,b,a){h.off="function"===typeof f.removeEventListener?function(b,a,c){b.removeEventListener(a,c,!1)}:"function"===typeof s.detachEvent?function(b,a,c){b.detachEvent("on"+a,c)}:function(b,a){b["on"+a]=null};h.off(c,b,a)},getXhr:function(){for(var c=null,b=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},
function(){return new ActiveXObject("Microsoft.XMLHTTP")}],a=b.length,d=0,d=0;d<a;d+=1){try{c=b[d]()}catch(g){continue}break}return c},xhr:function(c,b,a,d){var g=h.getXhr(),m,u="GET";b=h.callback(b);if(g)if(c){d!==e?u="POST":d=null;a===e&&(a=!0);m=function(){if(4===g.readyState&&(200<=g.status&&400>g.status||0===g.status))try{var a=g.responseText;a?b(a):b(!1)}catch(d){b(!1)}else 4===g.readyState&&b(!1)};g.open(u,c,a);try{g.onreadystatechange!==e?g.onreadystatechange=m:g.onload!==e&&(g.onload=m)}catch(f){g.onload=
null,g.onload=m}g.send(d)}else b(!1);else b(!1)},getJson:function(){null===k&&(f.JSON&&f.JSON.stringify)&&(k=f.JSON);return k},jsonToString:function(c){var b=!1;null===k&&(k=h.getJson());k&&c!==e&&(b=k.stringify(c));return b},jsonToObject:function(c){var b=!1;null===k&&(k=h.getJson());k&&c!==e&&(b=k.parse(c));return b},logToScreen:function(c){var b=s.getElementById("log"),a=s.createElement("p");c=s.createTextNode(c);b&&(a.appendChild(c),b.appendChild(a))},log:function(){var c=arguments;c.length&&
(r&&l.log.apply(l,c),c=c[0],h.logToScreen(c))},warn:function(){var c=arguments,b;c.length&&(b=c[0],v?l.warn.apply(l,c):h.log(b),h.logToScreen(b))},logTimerStart:function(c){p&&f.console.time(c)},logTimerEnd:function(c){p&&f.console.timeEnd(c)},url:function(c){if(h.isString(c)){var b=s.createElement("a"),a;b.href=c;a=b.pathname.match(/\/([^\/?#]+)$/i);return{source:c,protocol:b.protocol,host:b.hostname,port:b.port,query:b.search,file:a?a[1]:"/",hash:b.hash,path:b.pathname.replace(/^([^\/])/,"/$1"),
extension:function(a){a=a.split(".");return a.length?a[a.length-1]:!1}(c),folder:function(){var a=c.lastIndexOf("/");return c.substr(0,a+1)}()}}},queryString:function(c){c={};for(var b=f.location.search.substring(1).split("&"),a=b.length,d=0,g,m,d=0;d<a;d+=1)g=b[d].split("="),c[g[0]]===e?c[g[0]]=g[1]:"string"===typeof c[g[0]]?(m=[c[g[0]],g[1]],c[g[0]]=m):c[g[0]].push(g[1]);return c}(),sprintf:function(c){var b=1,a=arguments;return c.replace(/%s/g,function(){return b<a.length?a[b++]:""})},trim:function(c){if(!h.isString(c))return c;
h.isFunction(String.prototype.trim)||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});return c.trim()}}}();k.namespace("helpers.utils",h)})(window,document,window.getNs());
(function(f,s,k,e){var h=function(){function h(){switch(parseInt(f.orientation,10)){case 0:D=B;break;case 180:D=B;break;case 90:D=C;break;case -90:D=C}}function n(){L||(J(f,"orientationchange",h),L=!0)}function l(){(p=null!==x.match(/(iphone|ipod|ipad)/))&&n()}function r(){G===e&&(J(f,"online",r),J(f,"offline",r));G=s.onLine!==e?!!s.onLine:!0}function v(){var a=s.connection||s.mozConnection||s.webkitConnection||{type:0,UNKNOWN:0,ETHERNET:1,WIFI:2,CELL_2G:3,CELL_3G:4},b=function(){y=a};a.onchange=
b;b()}var p,t,c,b,a,d,g,m,u,H,z,F,I,w,A,E,G,y,C="landscapeMode",B="portraitMode",D,K,M,L,N=s.userAgent||s.vendor||f.opera,x=N.toLowerCase(),J=k.helpers.utils.on;return{isiOS:function(){p===e&&l();return p},isWebkit:function(){t===e&&(t=null!==x.match(/(webkit)/));return t},isAndroid:function(){c===e&&(c=null!==x.match(/(android)/))&&n();return c},isBlackberry:function(){b===e&&(b=null!==x.match(/(blackberry)/))&&n();return b},isChrome:function(){d===e&&(d=null!==x.match(/(chrome)/));return d},isSafari:function(){g===
e&&(g=null!==x.match(/(safari)/));return g},isFirefox:function(){m===e&&(m=null!==x.match(/(firefox)/));return m},isSeamonkey:function(){u===e&&(u=null!==x.match(/(seamonkey)/));return u},isCamino:function(){H===e&&(H=null!==x.match(/(camino)/));return H},isMsie:function(){z===e&&(z=null!==x.match(/(msie)/));return z},isOpera:function(){a===e&&(a=null!==x.match(/(opera)/));return a},isiPad:function(){F===e&&(F=null!==x.match(/(ipad)/))&&n();return F},isiPhone:function(){I===e&&(I=null!==x.match(/(iphone)/))&&
n();return I},isMobile:function(){w===e&&(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(x)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(x.substr(0,
4))?(w=!0,n()):w=!1);return w},getBrowserVersion:function(){if(A===e){var a,b;(b=x.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i))&&null!==(a=N.match(/version\/([\.\d]+)/i))&&(b[2]=a[1]);A=b?b[2]:s.appVersion}return A},getiOSVersion:function(){if(E===e&&(p===e&&l(),p)){var a=s.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);E=[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]}return E},isOnline:function(){G===e&&r();return G},getNetworkConnection:function(){y===e&&v();return y},
isStandalone:function(){return s.standalone!==e&&s.standalone},isTouchDevice:function(){return!!f.ontouchstart||f.navigator.msMaxTouchPoints},orientation:function(){return f.orientation?f.orientation:0},orientationMode:function(){D===e&&h();return D},hasRetinaDisplay:function(){return 2<=f.devicePixelRatio},hideStatusbar:function(a){a||(a=0);f.clearTimeout(M);M=f.setTimeout(function(){0===parseInt(f.pageYOffset,10)&&f.scrollTo(0,1)},a)},hasCanvas:function(){if(K===e){var a=document.createElement("canvas");
K=!(!a.getContext||!a.getContext("2d"))}return K}}}();k.namespace("helpers.client",h)})(window,window.navigator,window.getNs());
(function(f,s,k){function e(e,h){h&&(h.dom?e=h.dom:h.id&&(e=f.getElementById(h.id)));return e}var h=function(){var q=s.helpers,n=q.utils,l=q.client,r=[],v=[],p=[],t=[],c=f.getElementsByTagName("head")[0];return{nuke:function(){r=[];v=[];p=[];t=[]},createDomNode:function(b,a){var d=f.createElement(b),g;if(a)for(g in a)a.hasOwnProperty(g)&&d.setAttribute(g,a[g]);return d},hasClass:function(b,a){return RegExp(" "+a+" ").test(" "+b.className+" ")},getAttribute:function(b,a){return b.getAttribute(a)},
setAttribute:function(b,a,d){b.setAttribute(a,d)},appendCss:function(b,a,d,g,m){if(-1===n.inArray(b,r)||m){var u;m=e(null,g);if(null!==a){m||(m=h.createDomNode("style",{type:"text/css"}),m.className="lazyloaded");m.onerror=function(){d(!1)};g||c.appendChild(m);try{u=f.createTextNode(a),m.appendChild(u)}catch(k){m.styleSheet.cssText=a}finally{d()}}else null!==b&&(m||(m=h.createDomNode("link",{rel:"stylesheet",type:"text/css"}),m.className="lazyloaded"),m.onerror=function(){d(!1)},g||c.appendChild(m),
l.isMsie()||l.isOpera()?m.onload=d:d(),m.href=b);r.push(b)}else d()},appendJs:function(b,a,d,g,m){if(-1===n.inArray(b,v)||m){m=h.createDomNode("script");var u=f.getElementsByTagName("script")[0],k=!1;(m=e(m,g))?(m.type="text/javascript",m.className="lazyloaded",m.async=!0,m.onreadystatechange=m.onload=function(){k||this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||(this.onreadystatechange=this.onload=null,k=!0,v.push(b),d())},m.onerror=function(){this.onload=this.onreadystatechange=
this.onerror=null;d()},g||(u?u.parentNode.insertBefore(m,u):c.appendChild(m)),a&&!k?(m.textContent?m.textContent=a:m.nodeValue?m.nodeValue=a:m.text=a,k=!0):null!==b&&(m.src=b),k&&(v.push(b),d())):d()}else d()},appendImg:function(b,a,d,g){var c=null;(c=e(c,g))||(c=new Image);c.onerror=function(){c.onload=c.onerror=null;d()};c.onload=function(){c.onload=c.onerror=null;d()};a?c.src=a:b&&(c.src=b);if(c.complete&&c.naturalWidth!==k)c.onload();p.push(b)},appendHtml:function(b,a,d,g){var c=e(null,g);if(c){if(a)try{c.innerHTML=
a,g.id&&l.isMsie()&&f.styleSheets[0].addRule("#"+g.id+":after",'content: " ";')}catch(u){c.innerText=a}d();t.push(b)}else d()}}}();s.namespace("helpers.dom",h)})(document,window.getNs());
(function(f,s){function k(b){p("["+l+" Adapter] "+b)}function e(b){if(b){var a=b.name||b.code,d=b.message||b.description||"",g=d;if(FileError)switch(a){case FileError.ENCODING_ERR:case "EncodingError":g="Error Event: ENCODING_ERR "+d;break;case FileError.INVALID_MODIFICATION_ERR:case "InvalidModificationError":g="Error Event: INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:case "InvalidStateError":g="Error Event: INVALID_STATE_ERR "+d;break;case FileError.NO_MODIFICATION_ALLOWED_ERR:case "NoModificationAllowedError":g=
"Error Event: NO_MODIFICATION_ALLOWED_ERR "+d;break;case FileError.NOT_FOUND_ERR:case "NotFoundError":g="Error Event: NOT_FOUND_ERR "+d;break;case FileError.NOT_READABLE_ERR:case "NotReadableError":g="Error Event: NOT_READABLE_ERR "+d;break;case FileError.PATH_EXISTS_ERR:case "PathExistsError":g="Error Event: PATH_EXISTS_ERR "+d;break;case FileError.QUOTA_EXCEEDED_ERR:case "QuotaExceededError":g="Error Event: QUOTA_EXCEEDED_ERR "+d;break;case FileError.SECURITY_ERR:case "SecurityError":g="Error Event: SECURITY_ERR "+
d;break;case FileError.TYPE_MISMATCH_ERR:case "TypeMismatchError":g="Error Event: TYPE_MISMATCH_ERR "+d;break;default:g="Error Event: Unknown Error "+d}else g="Error Event: Unknown Error, no FileError available";k(g,b)}}function h(b,a,d){var g=function(a){e(a);d(!1)};if("."===a[0]||""===a[0])a=a.slice(1);a[0]?b.getDirectory(a[0],{create:!0},function(b){a.length?h(b,a.slice(1),d):d(!0)},g):d(!0)}function q(b,a,d){a=a.split("/");var g=a.length,c="",e=0;d=t(d);if(g){for(e=0;e<g-1;e+=1)c=c+a[e]+"/";h(b.root,
c.split("/"),d)}else d(!0)}function n(b){if(!(this instanceof n))return new n(b);this.adapter=null;this.type=l;this.size=52428800;this.init(b)}var l="fileSystem",r=f.getNs&&f.getNs()||f,v=r.helpers.utils,p=v.log,t=v.callback,c=null;n.prototype=n.fn={isSupported:function(){null===c&&((c=(!!f.requestFileSystem||!!f.webkitRequestFileSystem||!!f.moz_requestFileSystem)&&(!!f.Blob||!!f.BlobBuilder)&&f.FileReader)||k(l+" is not supported"));return c},open:function(b){var a=this,d=a.adapter,c=function(a){e(a);
b(!1)};b=t(b);null===d?(f.requestFileSystem=f.requestFileSystem||f.webkitRequestFileSystem||f.moz_requestFileSystem,f.requestFileSystem(f.TEMPORARY,a.size,function(e){d=a.adapter=e;k("Try to create test resource");try{a.create("test-item",v.jsonToString({test:"test-content"}),function(e){e?a.remove("test-item",function(){k("Test resource created and successfully deleted");b(d)}):c()})}catch(u){c(u)}},c)):(k("Adapter already opened"),b(d))},create:function(b,a,d){d=t(d);b||d(!1);var c=this.adapter,
m=function(a){e(a);d(!1,a)};q(c,b,function(){c.root.getFile(b,{create:!0},function(c){c.createWriter(function(c){var g;c.onwriteend=function(){k("File successfully written: url "+b);d(!0)};c.onerror=m;try{Blob?(g=new Blob([a],{type:"text/plain"}),c.write(g)):BlobBuilder&&(g=new BlobBuilder,g.append(a),c.write(g.getBlob("application/json")))}catch(e){m(e)}},m)},m)})},read:function(b,a){a=t(a);b||a(!1);var c=this.adapter,g=function(b){e(b);a(!1,b)};q(c,b,function(){c.root.getFile(b,{create:!1},function(b){b.file(function(b){var c=
new FileReader;c.onloadend=function(){a(this.result)};c.onerror=g;c.onabort=g;c.readAsText(b)},g)},g)})},update:function(b,a,c){this.create(b,a,c)},remove:function(b,a){a=t(a);b||a(!1);var c=this.adapter,g=function(b){e(b);a(!1,b)};q(c,b,function(){c.root.getFile(b,{create:!1},function(b){b.remove(function(){a(!0)},g)},g)})},init:function(b){return this.isSupported()?(b&&b.size&&(this.size=b.size),this):!1}};v.isFunction(r.namespace)?r.namespace("cache.storage.adapter."+l,n):r[l]=n})(window);
(function(f,s){function k(e){r("["+q+" Adapter] "+e)}function e(e){e&&k("Database error: "+(e.message||" No message avaible"))}function h(e){if(!(this instanceof h))return new h(e);this.adapter=null;this.type=q;this.dbName="cache";this.dbVersion="1.0";this.dbTable="offline";this.dbDescription="Local offline cache";this.dbKey="key";this.init(e)}var q="indexedDatabase",n=f.getNs&&f.getNs()||f,l=n.helpers.utils,r=l.log,v=l.callback,p=null;h.prototype=h.fn={isSupported:function(){null===p&&((p=!!f.indexedDB||
!!f.webkitIndexedDB||!!f.mozIndexedDB||!!f.OIndexedDB||!!f.msIndexedDB)||k(q+" is not supported"));return p},create:function(f,c,b){b=v(b);f||b(!1);var a=this.dbTable,d=this.dbName,g=this.adapter.transaction([a],"readwrite");f=g.objectStore(a).put({key:f,content:c});g.onerror=function(a){k("Failed to init transaction while creating/updating database entry "+d+" "+a);e(a);b(!1,a)};f.onerror=function(a){k("Failed to create/update database entry "+d+" "+a);e(a);b(!1,a)};f.onsuccess=function(){b(!0)}},
read:function(f,c){c=v(c);f||c(!1);var b=this.dbTable,a=this.dbName,d=this.adapter.transaction([b],"readonly"),b=d.objectStore(b).get(f);d&&b?(d.onerror=function(b){k("Failed to init transaction while reading database "+a+" "+b);e(b);c(!1,b)},b.onerror=function(b){k("Failed to read database entry "+a+" "+b);e(b);c(!1,b)},b.onsuccess=function(a){a.target.result&&a.target.result.content?c(a.target.result.content):c(!1)}):c(!1)},update:function(e,c,b){this.create(e,c,b)},remove:function(f,c){c=v(c);
f||c(!1);var b=this.dbTable,a=this.dbName,d=this.adapter.transaction([b],"readwrite"),b=d.objectStore(b).put({key:f,content:""});d.onerror=function(b){k("Failed to init transaction while deleting database entry "+a+" "+b);e(b);c(!1,b)};b.onerror=function(b){k("Failed to delete database entry "+a+" "+b);e(b);c(!1,b)};b.onsuccess=function(){c(!0)}},open:function(h,c){c||(c=!1);h=v(h);var b=this,a=null,d=null,g=null,m=b.dbName,u=b.dbTable,l=function(a){a||h(!1);k("Try to create test resource");b.create("test-item",
'{test: "test-content"}',function(c){c?b.remove("test-item",function(){k("Test resource created and successfully deleted");h(a)}):h(!1)})},n,p,q,w,r;if(null===b.adapter)if(a=f.indexedDB||f.webkitIndexedDB||f.mozIndexedDB||f.OIndexedDB||f.msIndexedDB){f.webkitIndexedDB!==s&&(f.IDBTransaction=f.webkitIDBTransaction,f.IDBKeyRange=f.webkitIDBKeyRange);n=function(a){a.createIndex(b.dbKey,b.dbKey,{unique:!0});a.createIndex("content","content",{unique:!1})};p=function(a){var c=d.result,f,w;b.adapter=c;k("Database successfully opened");
b.dbVersion===c.version||!c.setVersion&&"function"!==typeof c.setVersion?(b.adapter=c,l(c)):(g=a.currentTarget.result.setVersion(b.dbVersion),g.onfailure=function(a){k("Failed to open database: "+m+" "+a);e(a);h(!1)},g.onsuccess=function(a){f=d.result;w=f.createObjectStore(u,{keyPath:b.dbKey});k("Database needs upgrade: "+m+" "+a.oldVersion+" "+a.newVersion);n(w)})};q=function(a){var c=d.result.createObjectStore(u,{keyPath:b.dbKey});k("Database needs upgrade: "+m+" "+a.oldVersion+" "+a.newVersion);
n(c)};w=function(a){k("Failed to open database: "+m+" "+a);e(a);c||b.open(h,!0);h(!1)};r=function(a){k("Opening database request is blocked! "+m+" "+a);e(a);h(!1)};if(c)try{d=a.open(m,b.dbVersion)}catch(E){k("Could not set version"),e(E),d=a.open(m)}else d=a.open(m);d.onsuccess=p;d.onupgradeneeded=q;d.onerror=w;d.onblocked=r}else h(!1);else l(b.adapter)},init:function(e){return this.isSupported()?(e&&(e.name&&(this.dbName=String(e.name)),e.version&&(this.dbVersion=parseInt(e.version,10)),e.table&&
(this.dbTable=e.table),e.description&&(this.dbDescription=String(e.description)),e.key&&(this.dbKey=e.key)),this):!1}};l.isFunction(n.namespace)?n.namespace("cache.storage.adapter."+q,h):n[q]=h})(window);
(function(f,s){function k(c){v("["+n+" Adapter] "+c)}function e(c,b,a,d,g,e){!e&&c?c.transaction(function(c){c.executeSql(b,a,d,g)}):e?e.executeSql(b,a,d,g):g(null,{code:0,message:"The storage adapter isn't available"})}function h(c){var b="Errorcode: "+(c.code||"Code not present")+", Message: "+(c.message||"Message not present");c.info&&(b=b+" - "+c.info);k(b)}function q(c){if(!(this instanceof q))return new q(c);this.adapter=null;this.type=n;this.dbName="cache";this.dbVersion="1.0";this.dbDescription=
"resource cache";this.dbTable="websql";this.dbSize=4194304;this.init(c)}var n="webSqlDatabase",l=f.getNs&&f.getNs()||f,r=l.helpers.utils,v=r.log,p=r.callback,t=null;q.prototype=q.fn={isSupported:function(){null===t&&((t=!!f.openDatabase)||k(n+" is not supported"));return t},create:function(c,b,a){a=p(a);c||a(!1);e(this.adapter,"INSERT INTO "+this.dbTable+" (key, content) VALUES (?,?);",[c,b],function(){a(!0)},function(b,c){h(c);a(!1,c,{transaction:b})})},read:function(c,b){b=p(b);c||b(!1);e(this.adapter,
"SELECT content FROM "+this.dbTable+" WHERE key=?;",[c],function(a,c){var g=!1;c&&(c.rows&&1===c.rows.length)&&(g=c.rows.item(0).content);b(g,null,{transaction:a})},function(a,c){h(c);b(!1,c,{transaction:a})})},update:function(c,b,a){a=p(a);c||a(!1);e(this.adapter,"UPDATE "+this.dbTable+" SET content = ?  WHERE key=?;",[b,c],function(){a(!0)},function(b,c){h(c);a(!1,c,{transaction:b})})},remove:function(c,b){b=p(b);c||b(!1);e(this.adapter,"DELETE FROM "+this.dbTable+" WHERE key = ?;",[c],function(){b(!0)},
function(a,c){h(c);b(!1,c,{transaction:a})})},open:function(c){c=p(c);var b=this,a=b.adapter,d=function(a){a||c(!1);k("Try to create test resource");b.create("test-item",'{test: "test-content"}',function(d){d?b.remove("test-item",function(){k("Test resource created and successfully deleted");c(a)}):c(!1)})},g=function(a,c){k("Checking database table: name "+b.dbTable);e(a,"CREATE TABLE IF NOT EXISTS "+b.dbTable+"(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, key TEXT NOT NULL UNIQUE, content TEXT NOT NULL);",
[],function(){d(b.adapter)},function(a){h(a);d(!1)},c)},m=function(a){g(null,a)},u=function(a){a.info="Can't migrate to new database version. This may be caused by non-standard implementation of the changeVersion method. Please switch back your database version to use webSql on this device.";h(a);c(!1)};try{if(null===a&&b.isSupported())if(k("Initializing database"),b.adapter=a=f.openDatabase(b.dbName,"",b.dbDescription,b.dbSize),String(a.version)!==String(b.dbVersion)&&a.changeVersion&&"function"===
typeof a.changeVersion){k("Try to update version: new version "+a.version+", old version "+b.dbVersion);try{a.changeVersion(a.version,b.dbVersion,m,u)}catch(l){h(l),c(!1)}}else k("Open database with version number: "+b.dbVersion),a=f.openDatabase(b.dbName,b.dbVersion,b.dbDescription,b.dbSize),g(a);else b.isSupported()&&(k("database already initialized"),d(a))}catch(n){h(n),c(!1)}},init:function(c){return this.isSupported()?(c&&(c.description&&(this.dbDescription=c.description),c.name&&(this.dbName=
c.name),c.size&&(this.dbSize=c.size),c.table&&(this.dbTable=c.table),c.version&&(this.dbVersion=String(c.version))),this):!1}};r.isFunction(l.namespace)?l.namespace("cache.storage.adapter."+n,q):l[n]=q})(window);
(function(f,s){function k(a){p("["+n+" Adapter] "+a)}function e(a){!a&&f.event&&(a=f.event);k("Event - key: "+(a.key||"no e.key event")+", url: "+(a.url||"no e.url event"))}function h(a){a=t(a);switch(a){case "local":a="localStorage";break;case "session":a="sessionStorage";break;default:a="localStorage"}return a}function q(a){if(!(this instanceof q))return new q(a);this.adapter=null;this.type=n;this.lifetime="local";this.asynch=!0;this.init(a)}var n="webStorage",l=f.getNs&&f.getNs()||f,r=l.helpers.utils,
v=r.on,p=r.log,t=r.trim,c=r.callback,b=null;q.prototype=q.fn={isSupported:function(){var a=h(this.lifetime);if(null===b)try{b=!!f[a]&&!!f[a].getItem}catch(c){k(n+" is not supported",c),b=!1}return b},create:function(a,b,g){g=c(g);if(!a)if(f.asynch)g(!1);else return!1;var f=this,h=!0;try{f.adapter.setItem(a,b)}catch(k){h=!h,e(k)}if(f.asynch)g(h);else return h},read:function(a,b){b=c(b);if(!a)if(g.asynch)b(!1);else return!1;var g=this,f,h=!0;try{h=(f=g.adapter.getItem(a))?f:!1}catch(k){h=!h,e(k)}if(g.asynch)b(h);
else return h},update:function(a,b,c){if(this.asynch)this.create(a,b,c);else return this.create(a,b,c)},remove:function(a,b){b=c(b);if(!a)if(g.asynch)b(!1);else return!1;var g=this,f=!0;try{g.adapter.removeItem(a)}catch(h){f=!f,e(h)}if(g.asynch)b(f);else return f},open:function(a){var b=this,g=b.adapter,m=h(b.lifetime),u,l;a=c(a);if(null===g)try{if(g=b.adapter=f[m],v(f,"storage",e),k("Lifetime used: "+m),k("Try to create test resource"),b.asynch)b.create("test-item",'{test: "test-content"}',function(c){c?
b.remove("test-item",function(){k("Test resource created and successfully deleted");a(g)}):a(!1)});else{if(u=b.create("test-item",'{test: "test-content"}'))if(l=b.remove("test-item"))return k("Test resource created and successfully deleted"),g;return!1}}catch(n){if(e(n),b.asynch)a(!1);else return!1}else if(b.isSupported())if(b.asynch)a(g);else return g},init:function(a){return this.isSupported()?(a&&(a.lifetime&&(this.lifetime=t(String(a.lifetime))),a.asynch!==s&&(this.asynch=!!a.asynch)),this):!1}};
r.isFunction(l.namespace)?l.namespace("cache.storage.adapter."+n,q):l[n]=q})(window);
(function(f,s,k){function e(a){c("["+n+" Adapter] "+a)}function h(a,b){b.isLoaded||(b.isLoaded=!0,b.progressCallback(100),f.setTimeout(function(){a();e("Event loaded")},b.delay))}function q(a){if(!(this instanceof q))return new q(a);this.adapter=null;this.type=n;this.isLoaded=!1;this.delay=0;this.opened=!0;this.init(a)}var n="applicationCache",l=f.getNs&&f.getNs()||f,r=l.helpers,v=r.utils,p=r.dom,t=v.on,c=v.log,b=v.callback,a=null,d=s.getElementsByTagName("html")[0];q.prototype=q.fn={isSupported:function(){null===
a&&((a=!!f.applicationCache&&!!p.getAttribute(d,"manifest"))||e(n+" is not supported or there is no manifest html attribute"));return a},open:function(a,c){var d=this,l=d.adapter,n=0,p,s;d.opened=!0;a=b(a);c&&c.progress&&(p=c.progress);p=d.progressCallback=b(p);if(d.isSupported()&&null!==l){s=function(){e("Event updateready");try{l.swapCache()}catch(b){e("Event updateready: swapcache is not available",b)}confirm("A new version of this website is available. Do you want to an update?")?f.location.reload(!0):
h(a,d);return!1};t(l,"checking",function(){e("Event checking");return!1});t(l,"noupdate",function(){e("Event noupdate");h(a,d);return!1});t(l,"downloading",function(){e("Event downloading");n=0;return!1});t(l,"progress",function(a){e("Event progress");var b=0;d.delay=500;n+=1;b=a&&a.lengthComputable!==k?Math.round(100*a.loaded/a.total):Math.round(100*n/20);p(b);return!1});t(l,"cached",function(){e("Event cached");h(a,d);return!1});t(l,"updateready",function(){s()});t(l,"obsolete",function(){e("Event obsolete");
f.location.reload(!0);return!1});t(l,"error",function(){e("Event error");h(a,d);return!1});switch(l.status){case l.UNCACHED:h(a,d);break;case l.IDLE:h(a,d);break;case l.UPDATEREADY:s();break;case l.OBSOLETE:h(a,d)}t(f,"online",function(){try{l.update()}catch(a){e("Window event online: update cache is not available",a)}});f.setTimeout(function(){d.isLoaded||h(a,d)},12E3)}else h(a,d)},init:function(a){a=this.adapter;this.isSupported()&&null===a&&(this.adapter=f.applicationCache);return this}};l.namespace("cache.storage.adapter."+
n,q)})(window,document);
(function(f,s,k,e){function h(a){H("["+d+" controller] "+a)}function q(a){var b="";a&&(b="Error Event: Description "+(a.description||"no description available"));h(b)}function n(a,b,c){c.timeout=f.setTimeout(function(){b(!1)},4E3);I(a,function(a){f.clearTimeout(c.timeout);delete c.timeout;a?b(a):b(!1)})}function l(a){var b=null;try{b=u.jsonToObject(a)}catch(c){q(c),h("Couldn't convert json string to object.")}return b}function r(a,b,c){if(E){var d=s.createElement("canvas"),g,f=new Image,h=null,k=
0,m=0;c||(c="jpeg");f.onerror=function(){f.onload=f.onerror=null;b()};f.onload=function(){f.onload=f.onerror=null;k=d.height=f.height;m=d.width=f.width;g=d.getContext("2d");g.fillStyle="rgba(50, 50, 50, 0)";g.fillRect(0,0,m,k);g.drawImage(f,0,0);h=d.toDataURL("image/"+c);b(h)};f.src=a;if(f.complete&&f.naturalWidth!==e)f.onload()}else b(!1)}function v(a){var b=a.data,c=a.url;"css"===a.type&&(c=u.url(c),c=c.folder,b=b.replace(/url\(\../g,"url("+c+".."),b=b.replace(/url\(\'../g,"url('"+c+".."),b=b.replace(/url\(\"../g,
'url("'+c+".."),a.data=b);return a}function p(a,b){return{ajax:a.ajax,data:a.data,expires:(new Date).getTime()+(a.lifetime||b.lifetime),group:a.group!==e?a.group:b.group,lastmod:a.lastmod||b.lastmod,lifetime:a.lifetime!==e?a.lifetime:b.lifetime,type:a.type||b.type,version:a.version||b.version}}function t(a){return B&&B[a]?!!B[a]:!1}function c(a,b){var d=null,e,f;a&&a.length?(e=a[0].type,f=a.slice(1),h("Testing for storage adapter type: "+e),A[e]?d=new A[e](y):c(f,b),d&&d.isSupported()?d.open(function(g){g?
(C=e,B=a[0],h("Used storage adapter type: "+C),b(d)):c(f,b)}):c(f,b)):C||b(!1)}function b(a,d,e){var f=null,g=0,k;if(e)try{h("Testing for preferred storage adapter type: "+e),A[e]?(f=new A[e](y))&&f.isSupported()?f.open(function(c){if(c){C=e;k=d.length;for(g=0;g<k;g+=1)d[g].type===e&&(B=d[g]);B?(h("Used storage type: "+C),a(f)):(h("Storage config not found: "+C),b(a,d))}else b(a,d)}):b(a,d):b(a,d)}catch(m){q(m),h("Storage adapter could not be initialized: type "+e),b(a,d)}else c(d,a)}function a(b,
c){if(!(this instanceof a))return new a(b,c);this.isEnabled=!0;this.appCacheAdapter=this.adapter=null;this.adapters={types:G,defaults:y};this.resources={defaults:D};this.init(b,c)}var d="storage",g=k.helpers,m=g.client,u=g.utils,H=u.log,z=u.callback,F=u.getJson(),I=u.xhr,w=u.trim,A=k.cache.storage.adapter,E=m.hasCanvas(),G=[{type:"fileSystem",css:!0,js:!0,html:!0,img:!0},{type:"indexedDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webSqlDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webStorage",css:!0,
js:!0,html:!0,img:!0}],y={name:"localcache",table:"cache",description:"local resource cache",size:4194304,version:"1.0",key:"key",lifetime:"local",offline:!0},C=null,B=null,D={ajax:!0,lifetime:2E4,group:0,lastmod:(new Date).getTime(),type:"css",version:1};a.prototype=a.fn={create:function(a,b){b=z(b);if(a&&a.url){var c=this,d=a.url,e=a.type,f=function(f){if(f)if(a.data=f,a=v(a),null!==c.adapter&&t(e)){f=u.jsonToString(d);var g=p(a,c.resources.defaults),k=u.jsonToString(g);a.expires=g.expires;a.version=
g.version;try{c.adapter.create(f,k,function(c){c?(h("Create new resource in storage adapter: type "+e+", url "+d),b(a)):(h("Create new resource in storage adapter failed"),b(!1))})}catch(m){q(m),h("Create new resource in storage adapter failed"),b(a)}}else h("Trying to create new resource, but resource type is not cachable or storage adapter is not available: type "+e+", url "+d),b(a);else h("Couldn't get data via network"),b(a)};a.ajax?"img"===e?r(d,f):n(d,f,a):a.data?f(a.data):b(!1)}else b(!1)},
read:function(a,b){b=z(b);if(a&&a.url){var c=this,d=a.url,e=a.type;if(null!==this.adapter&&t(e)){h("Trying to read resource from storage: type "+e+", url "+d);try{c.adapter.read(u.jsonToString(d),function(f){f?(a=l(f))?(a.url=d,h("Successfully read resource from storage: type "+e+", url "+d),b(a,!0)):c.remove({url:d,type:e},function(){b(!1)}):(h("There is no data coming back from storage while reading: type "+e+", url "+d),b(!1))})}catch(f){q(f),h("Try to read resource from storage, but storage adapter is not available: type "+
e+", url "+d),n(d,function(c){h("Data loaded via ajax: type "+e+", url "+d+", data status "+!!c);a.data=c;b(a,!0)},a)}}else b(a)}else b(!1)},update:function(a,b){b=z(b);if(a&&a.url){var c=this,d=a.url,e=a.type,f=function(f){if(f)if(a.data=f,a=v(a),null!==c.adapter&&t(e)){f=u.jsonToString(d);var g=p(a,c.resources.defaults),k=u.jsonToString(g);a.expires=g.expires;a.version=g.version;try{c.adapter.update(f,k,function(c){c?(h("Updated existing resource in storage adapter: type "+e+", url "+d),b(a)):(h("Updating resource in storage failed."),
b(!1))})}catch(m){q(m),h("Updating resource in storage failed."),b(a)}}else h("Resource type is not cachable or storage adapter is not available: type "+e+", url "+d),b(a);else h("Couldn't get data via network, trying to used stored version"),c.read(a,function(c){c&&c.data?(a.data=c.data,b(a)):b(!1)})};a.ajax?"img"===e?r(d,f):n(d,f,a):a.data?f(a.data):b(!1)}else b(!1)},remove:function(a,b){b=z(b);if(a&&a.url){var c=a.url,d=a.type;null!==this.adapter&&t(d)?this.adapter.remove(u.jsonToString(c),function(e){e?
(h("Delete resource form storage: type "+d+", url "+c),b(a)):(h("Deleting resource form storage failed: type "+d+", url "+c),b(!1))}):(h("Delete resource from storage failed, resource type is not cachable or there is no storage adapter: type "+d+", url "+c),b(a))}else b(!1)},init:function(a,c){var d=this,f=!1,g,k,m,l;a=z(a);c&&c.isEnabled!==e&&(d.isEnabled=!!c.isEnabled);if(d.isEnabled&&F){if(c){if(c.adapters){g=c.adapters;if(g.types&&u.isArray(g.types)){k=g.types;m=k.length;for(l=0;l<m;l+=1)k[l].css===
e&&(k[l].css=!0),k[l].js===e&&(k[l].js=!0),k[l].img===e&&(k[l].img=!0),k[l].html===e&&(k[l].html=!0);d.adapters.types=k}g.defaults&&(k=g.defaults,m=d.adapters.defaults,k.name&&(m.name=w(String(k.name))),k.table&&(m.table=w(String(k.table))),k.description&&(m.description=w(String(k.description))),k.size&&(m.size=parseInt(k.size,10)),k.version&&(m.version=w(String(k.version))),k.key&&(m.key=w(String(k.key))),k.lifetime&&(m.lifetime=w(String(k.lifetime))),k.offline!==e&&(m.offline=!!k.offline));g.preferredType&&
(f=w(String(g.preferredType)))}c.resources&&(g=c.resources,g.defaults&&(g=g.defaults,k=d.resources.defaults,g.ajax!==e&&(k.ajax=!!g.ajax),g.lifetime!==e&&(k.lifetime=parseInt(g.lifetime,10)),g.group!==e&&(k.group=parseInt(g.group,10)),g.lastmod!==e&&(k.lastmod=parseInt(g.lastmod,10)),g.type&&(k.type=w(String(g.type))),g.group!==e&&(k.version=parseFloat(g.version)),g.loaded&&(k.loaded=z(g.loaded))))}b(function(b){d.adapter=b;a(d)},d.adapters.types,f);d.adapters.defaults.offline&&(A.applicationCache&&
!d.appCacheAdapter)&&(d.appCacheAdapter=new A.applicationCache(y))}else F||h("There is no json support"),d.isEnabled||h("Caching data is disabled"),a(d)}};k.namespace("cache."+d+".controller",a)})(window,document,window.getNs());
(function(f,s){function k(a){p("["+q+" controller] "+a)}function e(a){var b=c(a.type);if("js"!==b||"css"!==b||"html"!==b||"img"!==b||"custom"!==b){switch(r.url(a.url).extension){case "js":a="js";break;case "css":a="css";break;case "html":a="html";break;case "jpg":case "jpeg":case "png":a="img";break;default:a="custom"}b=a}return b}function h(a,b){if(!(this instanceof h))return new h(a,b);this.storage=null;this.init(a,b)}var q="cache",n=f.helpers,l=n.dom,r=n.utils,v=n.client,p=r.log,t=r.isArray,c=
r.trim,b=r.callback;h.prototype=h.fn={load:function(a,d){var g=this,f=(new Date).getTime(),h=function(){var a=0,b=0,c=null;return{init:function(d,e){c=e;a=d;b=0},loaded:function(){b+=1;b===a&&c()}}}(),n=function(a,b,c){var d=a.url,e=function(){a.loaded(a);h.loaded()},g=a.node||null;c=!!c;switch(a.type){case "js":l.appendJs(d,b,e,g,c);break;case "css":l.appendCss(d,b,e,g,c);break;case "img":l.appendImg(d,b,e,g,c);break;case "html":l.appendHtml(d,b,e,g,c);break;default:e()}},p=function(a){var c=a.data||
null,d=function(a,b){a&&a.data?n(a,a.data,b):n(a,null,b)},e=g.storage,h=e.resources.defaults;a.ajax=a.ajax!==s?!!a.ajax:h.ajax;a.loaded=a.loaded!==s?b(a.loaded):b(h.loaded);e.read(a,function(b){if(b&&b.data){var h=a,l=g.storage.resources.defaults,u=parseInt(b.lifetime,10),p=b.version,q=b.lastmod?b.lastmod:0,r=!1,t,y=h.lastmod?h.lastmod:0,r=!0;t=!1;h.version=t=h.version!==s?parseFloat(h.version):l.version;h.group=h.group!==s?parseFloat(h.group):l.group;y&&q?(h.lastmod=parseInt(y,10),r=q===h.lastmod):
!y&&q?y=q:y||(y=l.lastmod);r=r&&t===p;t=0!==u&&(-1!==u&&r&&b.expires>f||-1===u&&r);h.lastmod=y;h.isValid=t;a=h;a.isValid||!v.isOnline()?(k("Resource is up to date: type "+a.type+", url "+a.url),(c=b.data)&&n(a,c)):(k("Resource is outdated and needs update: type "+a.type+", url "+a.url),e.update(a,d))}else k("Resource or resource data is not available in storage adapter, try to create it: type "+a.type+", url "+a.url),e.create(a,d)})},q=function(a,b){var d=0,g=a.length,f=null;h.init(g,b);for(d=0;d<
g;d+=1)(f=a[d])&&f.url&&(f.url=c(f.url),f.type=e(f),p(f))},r=function(a,b,c){var d=a.length;for(c||(c=0);!a[c]&&c<d;)c+=1;c>=d?b(g):(d=a[c],q(d,function(){r(a,b,c+1)}))};(function(a,c){var e;a&&t(a)||(a=[]);e=a.length;for(var g=a,f=[],h,m=0,l,u=g.length,m=0;m<u;m+=1)l=g[m],(h=l.group)||(h=0),h=f[h]?f[h]:f[h]=[],h.push(l);a=f;c=b(d);k("Load resource function called: "+e+" resources, "+a.length+" groups");r(a,c)})(a,d)},remove:function(a,d){var g=this.storage,f=function(a,b){var d=a.length,f,h,m=function(a,
c){k("Successfully removed resource: url "+c);a===d-1&&b()};if(d)for(f=0;f<d;f+=1)(h=a[f])&&h.url&&(h.url=c(h.url),h.type=e(h),g.remove(h,m(f,h.url)));else b()};(function(a,c){a&&t(a)||(a=[]);c=b(d);k("Remove resource function called: resources count "+a.length);f(a,c)})(a,d)},init:function(a,c){var e=this;a=b(a);k("Cache initializing and checking for storage adapters");f.cache.storage.controller(function(b){e.storage=b;a(b)},c);return e}};f.namespace(q+".controller",h)})(window.getNs());
(function(f,s,k){function e(a){v("[cache interface] "+a)}function h(a){this.storage=this.controller=null;this.params=a;this.queue=new r;this.timeout=this.interval=this.calls=0}function q(a){var b=null,c=l.length,e;a||(a={});for(e=0;e<c;e+=1)t(l[e].params)===t(a)&&(b=l[e]);b||(b=new h(a),l.push(b));return b}function n(c,g,h){var k=q(c),l,n,p=function(){l=k.interval;f.clearInterval(l);l=f.setInterval(function(){k.timeout=n=k.timeout+b;k.controller&&k.storage&&(f.clearInterval(l),k.queue.flush());n>
a&&(f.clearInterval(l),e("Timeout reached while waiting for cache controller!!!"),h())},b)};k||(e("Whether finding nor initializing a cache interface is possible!!!"),h());k.storage?g(k):(k.queue.add(function(){g(k)}),k.calls+=1,1===k.calls?k.controller=new s.cache.controller(function(a){k.storage=a;k.controller?k.queue.flush():p()},c):p())}var l=[];k=s.helpers;var r=k.queue;k=k.utils;var v=k.log,p=k.isArray,t=k.jsonToString,c=k.callback,b=25,a=5E3;k=function(){return{load:function(a,b,f){b=c(b);
n(f,function(c){p(a)?c.controller.load(a,b):"applicationCache"===a?(c=c.storage)&&c.appCacheAdapter&&!c.appCacheAdapter.opened?c.appCacheAdapter.open(b,f):b():b()},function(){e("Get interface failed!");b()})},remove:function(a,b,f){b=c(b);n(f,function(c){p(a)?c.controller.remove(a,b):b()},function(){e("Get interface failed!");b()})}}}();s.namespace("cache.load",k.load);s.namespace("cache.remove",k.remove)})(window,window.getNs());
