!function(a){"use strict";function b(){a[f]={}}function c(){return a[f]||b(),a[f]}function d(c,d){if(c){c=String(c);var e,g=c.split("."),h=g.length,i=a[f];if(i||b(),!g)return!1;for(e=0;h>e;e+=1)i[g[e]]||(i[g[e]]={},e===h-1&&d&&(i[g[e]]=d)),i=i[g[e]];return i}return!1}var e,f="app";e=c(),e.namespace=d,a[f]=e,a.getNamespace=c}(window),function(a){"use strict";function b(){this.methods=[],this.response=null,this.flushed=!1}b.prototype=b.fn={add:function(a){this.flushed?a(this.response):this.methods.push(a)},flush:function(a){if(!this.flushed)for(this.response=a,this.flushed=!0;this.methods[0];)this.methods.shift()(a)}},a.namespace("helpers.queue",b)}(window.getNamespace()),function(a,b,c,d){"use strict";var e=function(){var c=null,f=(a.console!==d&&a.console.log,a.console!==d&&console.time!==d&&console.timeEnd!==d),g=[];return{logToScreen:function(a){var c=b.getElementById("log"),d=b.createElement("p"),e=b.createTextNode(a);c&&(d.appendChild(e),c.appendChild(d))},log:function(a){e.logToScreen(a)},logTimerStart:function(b){f&&a.console.time(b)},logTimerEnd:function(b){f&&a.console.timeEnd(b)},callback:function(a){return a&&"function"==typeof a||(a=function(){}),a},on:function(c,d,f){e.on="function"==typeof a.addEventListener?function(a,b,c){a.addEventListener(b,c,!1)}:"function"==typeof b.attachEvent?function(a,b,c){a.attachEvent("on"+b,c)}:function(a,b,c){a["on"+b]=c},e.on(c,d,f)},off:function(c,d,f){e.off="function"==typeof a.removeEventListener?function(a,b,c){a.removeEventListener(b,c,!1)}:"function"==typeof b.detachEvent?function(a,b,c){a.detachEvent("on"+b,c)}:function(a,b){a["on"+b]=null},e.off(c,d,f)},getXhr:function(){var a=null,b=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=b.length,d=0;for(d=0;c>d;d+=1){try{a=b[d]()}catch(e){continue}break}return a},xhr:function(a,b,c,f){var g,h=e.getXhr(),i="GET";if(b=e.callback(b),h){if(!a)return b(!1),void 0;f!==d?i="POST":f=null,c===d&&(c=!0),g=function(){if(4===h.readyState&&(h.status>=200&&h.status<400||0===h.status))try{var a=h.responseText;a?b(a):b(!1)}catch(c){b(!1)}},h.open(i,a,c);try{h.onreadystatechange!==d?h.onreadystatechange=g:h.onload!==d&&(h.onload=g)}catch(j){h.onload=null,h.onload=g}h.send(f)}else b(!1)},getJson:function(){return null===c&&a.JSON&&a.JSON.stringify&&(c=a.JSON),c},jsonToString:function(a){var b=!1;return null===c&&(c=e.getJson()),c&&a&&(b=c.stringify(a)),b},jsonToObject:function(a){var b=!1;return null===c&&(c=e.getJson()),c&&a&&(b=c.parse(a)),b},url:function(a){if(a){var c,d=b.createElement("a"),e=function(){var b=a.lastIndexOf("/"),c=a.substr(0,b+1);return c};return d.href=a,c=d.pathname.match(/\/([^\/?#]+)$/i),{source:a,protocol:d.protocol,host:d.hostname,port:d.port,query:d.search,file:c?c[1]:"/",hash:d.hash,path:d.pathname.replace(/^([^\/])/,"/$1"),folder:e()}}},queryString:function(){var b,c,e={},f=a.location.search.substring(1),g=f.split("&"),h=g.length,i=0;for(i=0;h>i;i+=1)b=g[i].split("="),e[b[0]]===d?e[b[0]]=b[1]:"string"==typeof e[b[0]]?(c=[e[b[0]],b[1]],e[b[0]]=c):e[b[0]].push(b[1]);return e}(),sprintf:function(a){var b=1,c=arguments;return a.replace(/%s/g,function(){return b<c.length?c[b++]:""})},trim:function(a){return"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),a.trim()},isArray:function(a){return e.isArray=Array.isArray&&"function"==typeof Array.isArray?function(a){return Array.isArray(a)}:Object.prototype.toString&&"function"===Object.prototype.toString?function(a){return"[object Array]"===Object.prototype.toString.call(a)}:function(a){return!!a.sort&&"function"==typeof a.sort},e.isArray(a)},inArray:function(a,b,c){return e.inArray=Array.prototype.indexOf?function(a,b,c){return g.indexOf.call(b,a,c)}:function(a,b,c){var d=b.length,e=0;if(c)return b[c]&&b[c]===a?c:-1;for(e=0;d>e;e+=1)if(b[e]===a)return e;return-1},e.inArray(a,b,c)}}}();c.namespace("helpers.utils",e)}(window,document,window.getNamespace()),function(a,b,c,d){"use strict";var e=function(){function e(){var b=parseInt(a.orientation,10);switch(b){case 0:P=U;break;case 180:P=U;break;case 90:P=T;break;case-90:P=T}}function f(){x=null!==W.match(/(iphone|ipod|ipad)/),x&&!S&&(X(a,"orientationchange",e),S=!0)}function g(){y=null!==W.match(/(webkit)/)}function h(){z=null!==W.match(/(android)/),z&&!S&&(X(a,"orientationchange",e),S=!0)}function i(){A=null!==W.match(/(blackberry)/),A&&!S&&(X(a,"orientationchange",e),S=!0)}function j(){B=null!==W.match(/(opera)/)}function k(){C=null!==W.match(/(chrome)/)}function l(){D=null!==W.match(/(safari)/)}function m(){E=null!==W.match(/(firefox)/)}function n(){F=null!==W.match(/(seamonkey)/)}function o(){G=null!==W.match(/(camino)/)}function p(){H=null!==W.match(/(msie)/)}function q(){I=null!==W.match(/(ipad)/),I&&!S&&(X(a,"orientationchange",e),S=!0)}function r(){J=null!==W.match(/(iphone)/),J&&!S&&(X(a,"orientationchange",e),S=!0)}function s(){K=!1,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(W)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(W.substr(0,4)))&&(K=!0,S||(X(a,"orientationchange",e),S=!0))}function t(){var a,c;c=W.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i),c&&null!==(a=V.match(/version\/([\.\d]+)/i))&&(c[2]=a[1]),L=c?c[2]:b.appVersion}function u(){if(f(),x){var a=b.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);M=[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3]||0,10)]}}function v(){N===d&&(X(a,"online",v),X(a,"offline",v)),N=b.onLine!==d?!!b.onLine:!0}function w(){var a=b.connection||b.mozConnection||b.webkitConnection||{type:0,UNKNOWN:0,ETHERNET:1,WIFI:2,CELL_2G:3,CELL_3G:4},c=function(){O=a};a.onchange=c,c()}var x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T="landscapeMode",U="portraitMode",V=b.userAgent||b.vendor||a.opera,W=V.toLowerCase(),X=c.helpers.utils.on;return{isiOS:function(){return x===d&&f(),x},isWebkit:function(){return y===d&&g(),y},isAndroid:function(){return z===d&&h(),z},isBlackberry:function(){return A===d&&i(),A},isChrome:function(){return C===d&&k(),C},isOpera:function(){return B===d&&j(),B},isSafari:function(){return D===d&&l(),D},isFirefox:function(){return E===d&&m(),E},isSeamonkey:function(){return F===d&&n(),F},isCamino:function(){return G===d&&o(),G},isMsie:function(){return H===d&&p(),H},isiPad:function(){return I===d&&q(),I},isiPhone:function(){return J===d&&r(),J},isMobile:function(){return K===d&&s(),K},getBrowserVersion:function(){return L===d&&t(),L},getiOSVersion:function(){return M===d&&u(),M},isOnline:function(){return N===d&&v(),N},getNetworkConnection:function(){return O===d&&w(),O},isStandalone:function(){return b.standalone!==d&&b.standalone},isTouchDevice:function(){return!!("ontouchstart"in a)||a.navigator.msMaxTouchPoints},orientation:function(){return a.orientation?a.orientation:0},orientationMode:function(){return P===d&&e(),P},hasRetinaDisplay:function(){return a.devicePixelRatio>=2},hasCanvas:function(){if(Q===d){var a=document.createElement("canvas");Q=!(!a.getContext||!a.getContext("2d"))}return Q},hideStatusbar:function(b){b||(b=0),a.clearTimeout(R),R=a.setTimeout(function(){0===parseInt(a.pageYOffset,10)&&a.scrollTo(0,1)},b)}}}();c.namespace("helpers.client",e)}(window,window.navigator,window.getNamespace()),function(a,b){"use strict";function c(b,c){return c&&(c.dom?b=c.dom:c.id&&(b=a.getElementById(c.id))),b}var d=function(){var e=b.helpers,f=e.utils,g=e.client,h=[],i=[],j=[],k=[],l=a.getElementsByTagName("head")[0];return{createDomNode:function(b,c){var d,e=a.createElement(b);if(c)for(d in c)c.hasOwnProperty(d)&&e.setAttribute(d,c[d]);return e},hasClass:function(a,b){return new RegExp(" "+b+" ").test(" "+a.className+" ")},getAttribute:function(a,b){return a.getAttribute(b)},setAttribute:function(a,b,c){a.setAttribute(b,c)},appendCss:function(b,e,i,j){if(-1===f.inArray(b,h)){var k,m=null;if(m=c(m,j),null!==e){m||(m=d.createDomNode("style",{type:"text/css"})),j||l.appendChild(m);try{k=a.createTextNode(e),m.appendChild(k)}catch(n){m.styleSheet.cssText=e}finally{i()}}else null!==b&&(m||(m=d.createDomNode("link",{rel:"stylesheet",type:"text/css"})),j||l.appendChild(m),g.isMsie||g.isOpera?m.onload=i:i(),m.href=b);h.push(b)}else i()},appendJs:function(b,e,g,h){if(-1===f.inArray(b,i)){var j=d.createDomNode("script"),k=a.getElementsByTagName("script")[0],m=!1;j=c(j,h),j.type="text/javascript",j.className="lazyloaded",j.async=!0,j.onreadystatechange=j.onload=function(){m||this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||(this.onreadystatechange=this.onload=null,m=!0,i.push(b),g())},j.onerror&&(j.onerror=function(){this.onload=this.onreadystatechange=this.onerror=null,g()}),h||(k?k.parentNode.insertBefore(j,k):l.appendChild(j)),e&&!m?(j.textContent?j.textContent=e:j.nodeValue?j.nodeValue=e:j.text=e,m=!0):null!==b&&(j.src=b),m&&(i.push(b),g())}else g()},appendImg:function(a,b,d,e){var f=null;f=c(f,e),f||(f=new Image),f.onload=d,b?f.src=b:a&&(f.src=a),j.push(a)},appendHtml:function(b,d,e,f){var g=null;if(g=c(g,f),!g)return e(),void 0;if(d)try{g.innerHTML=d,f.id&&a.styleSheets[0].addRule("#"+f.id+":after","content: ' ';")}catch(h){g.innerText=d}e(),k.push(b)}}}();b.namespace("helpers.dom",d)}(document,window.getNamespace()),function(a,b){"use strict";function c(a){if(a){var b="",c=a.name||a.message||a.code;switch(c){case FileError.QUOTA_EXCEEDED_ERR:b="["+g+" Adapter] File System Event: QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:b="["+g+" Adapter] File System Event: NOT_FOUND_ERR, file does not exist";break;case FileError.SECURITY_ERR:b="["+g+" Adapter] File System Event: SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:b="["+g+" Adapter] File System Event: INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:b="["+g+" Adapter] File System Event: INVALID_STATE_ERR";break;default:b="["+g+" Adapter] File System Event: Unknown Error"}i(b)}}function d(a,b,e){("."===b[0]||""===b[0])&&(b=b.slice(1)),b[0]?a.getDirectory(b[0],{create:!0},function(a){b.length?d(a,b.slice(1),e):e()},c):e()}function e(a,b,c){var e=b.split("/"),f=e.length,g="",h=0;if(c=j(c),f){for(h=0;f-1>h;h+=1)g=g+e[h]+"/";d(a.root,g.split("/"),c)}else c()}function f(a){var b=this;b.adapter=null,b.type=g,b.size=52428800,b.init(a)}var g="fileSystem",h=b.helpers.utils,i=h.log,j=h.callback,k=null;f.prototype=f.fn={isSupported:function(){return null===k&&(k=!(!a.requestFileSystem&&!a.webkitRequestFileSystem||!a.Blob),k||i("["+g+" Adapter] "+g+" is not supported")),k},open:function(b){var d=this,e=d.adapter;null===e?(a.requestFileSystem=a.requestFileSystem||a.webkitRequestFileSystem,a.requestFileSystem(a.TEMPORARY,d.size,function(a){e=d.adapter=a,i("["+g+" Adapter] Try to create test resource");try{d.create("test-item",h.jsonToString({test:"test-content"}),function(a){a?d.remove("test-item",function(){i("["+g+" Adapter] Test resource created and successfully deleted"),b(e)}):b(!1)})}catch(f){c(f),b(!1)}},c)):b(e)},create:function(a,b,d){var f=this.adapter,g=function(a){c(a),d(!1,a)};e(f,a,function(){f.root.getFile(a,{create:!0},function(a){a.createWriter(function(a){a.onwriteend=function(){d(!0)},a.onerror=g;try{var c=new Blob([b],{type:"text/plain"});a.write(c)}catch(e){g(e)}},g)},g)})},read:function(a,b){var d=this.adapter,f=function(a){c(a),b(!1,a)};e(d,a,function(){d.root.getFile(a,{create:!1},function(a){a.file(function(a){var c=new FileReader;c.onloadend=function(){b(this.result)},c.readAsText(a)},f)},f)})},update:function(a,b,c){this.create(a,b,c)},remove:function(a,b){var d=this.adapter,f=function(d){c(d),b(a,d)};e(d,a,function(){d.root.getFile(a,{create:!1},function(a){a.remove(function(){b()},f)},f)})},init:function(a){var b=this;return b.isSupported()?(a&&a.size&&(b.size=a.size),b):!1}},b.namespace("cache.storage.adapter."+g,f)}(window,window.getNamespace()),function(a,b,c){"use strict";function d(a){var b=this;b.adapter=null,b.type=e,b.dbName="merkel",b.dbVersion="1.0",b.dbTable="offline",b.dbDescription="Local cache",b.dbKey="key",b.init(a)}var e="indexedDatabase",f=b.helpers.utils,g=f.log,h=null;d.prototype=d.fn={isSupported:function(){return null===h&&(h=!!(a.indexedDB||a.webkitIndexedDB||a.mozIndexedDB||a.OIndexedDB||a.msIndexedDB),h||g("["+e+" Adapter] "+e+" is not supported")),h},create:function(a,b,c){var d=this,f=d.dbTable,h=d.dbName,i=d.adapter.transaction([f],"readwrite"),j=i.objectStore(f).put({key:a,content:b});i.onerror=function(a){g("["+e+" Adapter] Failed to init transaction while creating/updating database entry "+h+" "+a),c(!1,a)},j.onerror=function(a){g("["+e+" Adapter] Failed to create/update database entry "+h+" "+a),c(!1,a)},j.onsuccess=function(){c(!0)}},read:function(a,b){var c=this,d=c.dbTable,f=c.dbName,h=c.adapter.transaction([d],"readonly"),i=h.objectStore(d).get(a);return h&&i?(h.onerror=function(a){g("["+e+" Adapter] Failed to init transaction while reading database "+f+" "+a)},i.onerror=function(a){g("["+e+" Adapter] Failed to read database entry "+f+" "+a),b(!1,a)},i.onsuccess=function(a){a.target.result&&a.target.result.content?b(a.target.result.content):b(!1)},void 0):(b(!1),void 0)},update:function(a,b,c){this.create(a,b,c)},remove:function(a,b){var c=this,d=c.dbTable,f=c.dbName,h=c.adapter.transaction([d],"readwrite"),i=h.objectStore(d),j=i(d).put({key:a,content:""});h.onerror=function(a){g("["+e+" Adapter] Failed to init transaction while deleting database entry "+f+" "+a),b(!1,a)},j.onerror=function(a){g("["+e+" Adapter] Failed to delete database entry "+f+" "+a),b(!1,a)},j.onsuccess=function(){b(!0)}},open:function(b,d){var f,h,i,j,k=this,l=null,m=null,n=null,o=k.dbName,p=k.dbTable;if(d||(d=!1),null===k.adapter){if(l=a.indexedDB||a.webkitIndexedDB||a.mozIndexedDB||a.OIndexedDB||a.msIndexedDB,!l)return b(!1),void 0;if(a.webkitIndexedDB!==c&&(a.IDBTransaction=a.webkitIDBTransaction,a.IDBKeyRange=a.webkitIDBKeyRange),f=function(a){var c=m.result;k.adapter=c,k.dbVersion===c.version||!c.setVersion&&"function"!=typeof c.setVersion?b(c):(n=a.currentTarget.result.setVersion(k.dbVersion),n.onfailure=function(a){g("["+e+" Adapter] Failed to open database: "+o+" "+a),b(!1)},n.onsuccess=function(a){var b=m.result,c=b.createObjectStore(p,{keyPath:k.dbKey});g("["+e+" Adapter] Database needs upgrade: "+o+" "+a.oldVersion+" "+a.newVersion),c.createIndex("key","key",{unique:!0}),c.createIndex("content","content",{unique:!1})})},h=function(a){var b=m.result,c=b.createObjectStore(p,{keyPath:k.dbKey});g("["+e+" Adapter] Database needs upgrade: "+o+" "+a.oldVersion+" "+a.newVersion),c.createIndex("key","key",{unique:!0}),c.createIndex("content","content",{unique:!1})},i=function(a){g("["+e+" Adapter] Failed to open database: "+o+" "+a),d||k.open(b,!0),b(!1)},j=function(a){g("["+e+" Adapter] Opening database request is blocked! "+o+" "+a),b(!1)},d)try{m=l.open(o,k.dbVersion)}catch(q){g(q),m=l.open(o)}else m=l.open(o);m.onsuccess=f,m.onupgradeneeded=h,m.onerror=i,m.onblocked=j}else b(k.adapter)},init:function(a){var b=this;return b.isSupported()?(a&&(a.name&&(b.dbName=a.name),a.version&&(b.dbVersion=a.version),a.table&&(b.dbTable=a.table),a.description&&(b.dbDescription=a.description),a.key&&(b.dbKey=a.key)),b):!1}},b.namespace("cache.storage.adapter."+e,d)}(window,window.getNamespace()),function(a,b){"use strict";function c(a,b,c,d,e,f){!f&&a?a.transaction(function(a){a.executeSql(b,c,d,e)}):f?f.executeSql(b,c,d,e):e(null,{code:0,message:"The storage adapter isn't available"})}function d(a){var b="["+f+" Adapter] Errorcode: "+a.code+", Message: "+a.message;a.info&&(b=b+" - "+a.info),h(b)}function e(a){var b=this;b.adapter=null,b.type=f,b.dbName="merkel",b.dbVersion="1.0",b.dbDescription="resource cache",b.dbTable="cache",b.dbSize=4194304,b.init(a)}var f="webSqlDatabase",g=b.helpers.utils,h=g.log,i=null;e.prototype=e.fn={isSupported:function(){return null===i&&(i=!!a.openDatabase,i||h("["+f+" Adapter] "+f+" is not supported")),i},create:function(a,b,e){var f=this,g=function(){e(!0)},h=function(a,b){d(b),e(!1,b,{transaction:a})};c(f.adapter,"INSERT INTO "+f.dbTable+" (key, content) VALUES (?,?);",[a,b],g,h)},read:function(a,b){var e=this,f=function(a,c){var d=null;c&&c.rows&&1===c.rows.length&&(d=c.rows.item(0).content),b(d,null,{transaction:a})},g=function(a,c){d(c),b(!1,c,{transaction:a})};c(e.adapter,"SELECT content FROM "+e.dbTable+" WHERE key=?;",[a],f,g)},update:function(a,b,e){var f=this,g=function(){e(!0)},h=function(a,b){d(b),e(!1,b,{transaction:a})};c(f.adapter,"UPDATE "+f.dbTable+" SET content = ?  WHERE key=?;",[b,a],g,h)},remove:function(a,b){var e=this,f=function(){b(!0)},g=function(a,c){d(c),b(!1,c,{transaction:a})};c(e.adapter,"DELETE FROM "+e.dbTable+" WHERE key = ?;",[a],f,g)},open:function(b){var e=this,f=e.adapter,g=function(a,f){c(a,"CREATE TABLE IF NOT EXISTS "+e.dbTable+"(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, key TEXT NOT NULL UNIQUE, content TEXT NOT NULL);",[],function(){b(a)},function(a){d(a),b(!1)},f)},h=function(a){g(null,a)},i=function(a){a.info="Can't migrate to new database version and using localStorage instead. This may be caused by non-standard implementation of the changeVersion method. Please switch back your database version to use webSql on this device.",d(a),b(!1)};try{if(null===f&&e.isSupported())if(e.adapter=f=a.openDatabase(e.dbName,"",e.dbDescription,e.dbSize),String(f.version)!==String(e.dbVersion)&&f.changeVersion&&"function"==typeof f.changeVersion)try{f.changeVersion(f.version,e.dbVersion,h,i)}catch(j){d(j),b(!1)}else f=a.openDatabase(e.dbName,e.dbVersion,e.dbDescription,e.dbSize),g(f);else e.isSupported()&&b(f)}catch(j){d(j),b(!1)}},init:function(a){var b=this;return b.isSupported()?(a&&(a.description&&(b.dbDescription=a.description),a.name&&(b.dbName=a.name),a.size&&(b.dbSize=a.size),a.table&&(b.dbTable=a.table),a.version&&(b.dbVersion=String(a.version))),b):!1}},b.namespace("cache.storage.adapter."+f,e)}(window,window.getNamespace()),function(a,b){"use strict";function c(b){!b&&a.event&&(b=a.event);var c="["+f+" Adapter] Event - key: "+(b.key||"no e.key event")+", url: "+(b.url||"no e.url event");i(c)}function d(a){var b="localStorage";switch(a){case"local":b="localStorage";break;case"session":b="sessionStorage"}return b}function e(a){var b=this;b.adapter=null,b.type=f,b.lifetime="local",b.init(a)}var f="webStorage",g=b.helpers.utils,h=g.on,i=g.log,j=null;e.prototype=e.fn={isSupported:function(){var b=this,c=d(b.lifetime);if(null===j)try{j=!!a[c]&&!!a[c].getItem}catch(e){i("["+f+" Adapter] "+f+" is not supported"),j=!1}return j},create:function(a,b,d){try{this.adapter.setItem(a,b),d(!0)}catch(e){c(e),d(!1,e)}},read:function(a,b){var d,e=this;try{d=e.adapter.getItem(a),d?b(d):b(!1)}catch(f){c(f),b(!1,f)}},update:function(a,b,c){this.create(a,b,c)},remove:function(a,b){try{this.adapter.removeItem(a),b(a)}catch(d){c(d),b(!1,d)}},open:function(b){var e=this,g=e.adapter,j=d(e.lifetime);if(null===g)try{g=e.adapter=a[j],h(a,"storage",c),i("["+f+" Adapter] Try to create test resource"),e.create("test-item",'{test: "test-content"}',function(a){a?e.remove("test-item",function(){i("["+f+" Adapter] Test resource created and successfully deleted"),b(g)}):b(!1)})}catch(k){return b(!1),void 0}else e.isSupported()&&b(g)},init:function(a){var b=this;return b.isSupported()?(a&&a.lifetime&&(b.lifetime=a.lifetime),b):!1}},b.namespace("cache.storage.adapter."+f,e)}(window,window.getNamespace()),function(a,b,c,d){"use strict";function e(a){var b=this;b.adapter=null,b.type=f,b.isLoaded=!1,b.delay=25,b.init(a)}var f="applicationCache",g=c.helpers,h=g.utils,i=g.dom,j=h.on,k=h.log,l=h.callback,m=null,n=b.getElementsByTagName("html")[0];e.prototype=e.fn={isSupported:function(){return null===m&&(m=!!a.applicationCache&&!!i.getAttribute(n,"manifest"),m||k("["+f+" Adapter] "+f+" is not supported or there is no manifest html attribute")),m},loaded:function(b){var c=this;c.isLoaded||(c.isLoaded=!0,a.setTimeout(function(){b(),k("["+f+" Adapter] Event loaded")},c.delay))},open:function(b,c){var e,g,h=this,i=h.adapter,m=0;if(b=l(b),c&&c.progress&&(e=c.progress),e=l(e),h.isSupported()&&null!==i){switch(g=function(){k("["+f+" Adapter] Event updateready");try{i.swapCache()}catch(c){k("["+f+" Adapter] Event updateready: swapcache is not available")}return confirm("A new version of this website is available. Do you want to an update?")?a.location.reload(!0):h.loaded(b),!1},j(i,"checking",function(){return k("["+f+" Adapter] Event checking"),!1}),j(i,"noupdate",function(){return k("["+f+" Adapter] Event noupdate"),h.loaded(b),!1}),j(i,"downloading",function(){return k("["+f+" Adapter] Event downloading"),m=0,!1}),j(i,"progress",function(a){k("["+f+" Adapter] Event progress");var b="";return h.delay=500,m+=1,b=a&&a.lengthComputable!==d?Math.round(100*a.loaded/a.total):Math.round(100*m/20),e(b),!1}),j(i,"cached",function(){return k("["+f+" Adapter] Event cached"),h.loaded(b),!1}),j(i,"updateready",function(){g()}),j(i,"obsolete",function(){return k("["+f+" Adapter] Event obsolete"),a.location.reload(!0),!1}),j(i,"error",function(){return k("["+f+" Adapter] Event error"),h.loaded(b),!1}),i.status){case i.UNCACHED:h.loaded(b);break;case i.IDLE:e(100),h.loaded(b);break;case i.UPDATEREADY:g();break;case i.OBSOLETE:h.loaded(b)}j(a,"online",function(){try{i.update()}catch(a){k("["+f+" Adapter] Window event online: update cache is not available")}}),a.setTimeout(function(){h.isLoaded||h.loaded(b)},12e3)}else h.loaded(b)},init:function(){var b=this,c=b.adapter;return b.isSupported()&&null===c&&(c=b.adapter=a.applicationCache),b}},c.namespace("cache.storage.adapter."+f,e)}(window,document,window.getNamespace()),function(a,b,c){"use strict";function d(a,b,c){c.timeout=window.setTimeout(function(){b(!1)},5e3),u(a,function(a){window.clearTimeout(c.timeout),delete c.timeout,a?b(a):b(!1)})}function e(a){return q.jsonToString(a)}function f(a){var b=null;try{b=q.jsonToObject(a)}catch(c){r("["+n+" controller] Couldn't convert json string to object."+c)}return b}function g(b,c,d){if(w){var e,f=a.createElement("canvas"),g=new Image,h=null,i=0,j=0;d||(d="jpeg"),g.onload=function(){i=f.height=g.height,j=f.width=g.width,e=f.getContext("2d"),e.fillStyle="rgba(50, 50, 50, 0)",e.fillRect(0,0,j,i),e.drawImage(g,0,0),h=f.toDataURL("image/"+d),c(h)},g.src=b}else c(!1)}function h(a,b,c){if("css"===a){var d,e=q.url(b);return d=c.replace(/url\(\"../g,'url("'+e.folder+".."),d=c.replace(/url\(\../g,"url("+e.folder+"..")}return c}function i(a){return{ajax:a.ajax,data:a.data,expires:(new Date).getTime()+(a.lifetime||B.lifetime),group:a.group!==c?a.group:B.group,lastmod:a.lastmod||B.lastmod,lifetime:a.lifetime!==c?a.lifetime:B.lifetime,type:a.type||B.type,version:a.version||B.version}}function j(a){return A&&A[a]?!!A[a]:!1}function k(a,b){var c,d=null;return a&&a.length?(c=a[0].type,r("["+n+" controller] Testing for storage adapter type: "+c),v[c]?d=new v[c](y):k(a.slice(1),b),d&&d.isSupported()?d.open(function(e){e?(z=c,A=a[0],r("["+n+" controller] Used storage adapter type: "+z),b(d)):k(a.slice(1),b)}):k(a.slice(1),b),void 0):(z||b(!1),void 0)}function l(a,b){var c,d=null,e=0;if(b)try{r("["+n+" controller] Testing for storage adapter type: "+b),v[b]?d=new v[b](y):l(a),d&&d.isSupported()?d.open(function(f){if(f){for(z=b,c=x.length,e=0;c>e;e+=1)x[e].type===b&&(A=x[e]);if(A)return r("["+n+" controller] Used storage type: "+z),a(d),void 0;r("["+n+" controller] Storage config not found: "+z),l(a)}else l(a)}):l(a)}catch(f){r("["+n+" controller] Storage adapter could not be initialized: type "+b),l(a)}else k(x,a)}function m(a,b){var c=this;c.isEnabled=!0,c.adapter=null,c.adapters={types:x,defaults:y},c.appCacheAdapter=null,c.resourceDefaults=B,c.init(a,b)}var n="storage",o=b.helpers,p=o.client,q=o.utils,r=q.log,s=q.callback,t=q.getJson(),u=q.xhr,v=b.cache.storage.adapter,w=p.hasCanvas(),x=[{type:"fileSystem",css:!0,js:!0,html:!0,img:!0},{type:"indexedDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webSqlDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webStorage",css:!0,js:!0,html:!0,img:!0}],y={name:"localcache",table:"cache",description:"local resource cache",size:4194304,version:"1.0",key:"key",lifetime:"local",offline:!0},z=null,A=null,B={ajax:!0,lifetime:2e4,group:0,lastmod:(new Date).getTime(),type:"css",version:1};m.prototype=m.fn={create:function(a,b){var c=this,f=a.url,k=a.type,l=function(d){if(!d)return r("["+n+" controller] Couldn't get data via network"),b(a),void 0;if(a.data=h(k,f,d),null!==c.adapter&&j(k)){var g=e(f),l=e(i(a));try{c.adapter.create(g,l,function(c){c?(r("["+n+" controller] Create new resource in storage adapter: type "+k+", url "+f),b(a)):(r("["+n+" controller] Create new resource in storage adapter failed"),b(!1))})}catch(m){b(a)}}else r("["+n+" controller] Trying to create new resource, but resource type is not cachable or storage adapter is not available: type "+k+", url "+f),b(a)};b=s(b),a.ajax?"img"===k?g(f,l):d(f,l,a):a.data?l(a.data):b(!1)},read:function(a,b){var c=this,g=a.url,h=a.type;if(b=s(b),null!==this.adapter&&j(h)){r("["+n+" controller] Trying to read resource from storage: type "+h+", url "+g);try{c.adapter.read(e(g),function(d){if(d){if(a=f(d),!a)return c.adapter.remove(e(g),function(){r("["+n+" controller] Resource deleted from storage adapter to create a new one: type "+h+", url "+g),b(!1)}),void 0;a.url=g,r("["+n+" controller] Successfully read resource from storage: type "+h+", url "+g),b(a,!0)}else r("["+n+" controller] There is no data coming back from storage while reading: type "+h+", url "+g),b(!1)})}catch(i){d(g,function(c){a.data=c,r("["+n+" controller] Try to read resource from storage, but storage adapter is not available: type "+h+", url "+g),b(a,!0)},a)}}else b(a)},update:function(a,b){var c=this,f=a.url,k=a.type,l=function(d){if(!d)return r("["+n+" controller] Couldn't get data via network, trying to used stored version"),c.read(a,function(c){c&&c.data?(a.data=c.data,b(a)):b(!1)}),void 0;if(a.data=h(k,f,d),null!==c.adapter&&j(k)){var g=e(f),l=e(i(a));try{c.adapter.update(g,l,function(c){c?(r("["+n+" controller] Update existing resource in storage adapter: type "+k+", url "+f),b(a)):(r("["+n+" controller] Updating resource in storage failed."),b(!1))})}catch(m){b(a)}}else r("["+n+" controller] Resource type is not cachable or storage adapter is not available: type "+k+", url "+f),b(a)};b=s(b),a.ajax?"img"===k?g(f,l):d(f,l,a):a.data?l(a.data):b(!1)},remove:function(a,b){var c=this,d=a.url,g=a.type;b=s(b),null!==c.adapter&&j(g)?c.adapter.remove(e(d),function(c){return(a=f(c))?(a.url=d,r("["+n+" controller] Delete resource form storage: type "+g+", url "+d),b(a),void 0):(b(!1),void 0)}):(r("["+n+" controller] Delete resource from storage failed, resource type is not cachable or there is no storage adapter: type "+g+", url "+d),b(a))},init:function(a,b){var d=this,e=!1;b&&b.isEnabled!==c&&(d.isEnabled=!!b.isEnabled),d.isEnabled&&t?(b&&(b.description&&(y.description=String(b.description)),b.key&&(y.key=String(b.key)),b.lifetime&&(y.lifetime=String(b.lifetime)),b.name&&(y.name=String(b.name)),b.size&&(y.size=parseInt(b.size,10)),b.table&&(y.table=String(b.table)),b.type&&(y.type=e=String(b.type)),b.offline&&(y.offline=Boolean(b.offline)),b.version&&(y.version=String(b.version))),y.offline&&v.applicationCache&&(d.appCacheAdapter=new v.applicationCache(y)),l(function(b){d.adapter=b,a(d)},e)):(t||r("["+n+" controller] There is no json support"),d.isEnabled||r("["+n+" controller] Caching data is disabled"),a(d))}},b.namespace("cache.storage.controller",m)}(document,window.getNamespace()),function(a,b,c,d){"use strict";function e(a,b){var c=this;c.storage=null,c.init(a,b)}var f="cache",g=c.helpers,h=g.dom,i=g.utils,j=g.client,k=i.log,l=i.callback;e.prototype=e.fn={load:function(a,b){var c=this,e=(new Date).getTime(),g=function(){var a=0,b=0,c=null;return{init:function(d,e){c=e,a=d,b=0},loaded:function(){b+=1,b===a&&c()}}}(),i=function(a,b,c){var d=a.url,e=l(a.loaded),f=function(){g.loaded(),e(b)},i=a.node||null;switch(c=!!c,a.type){case"js":h.appendJs(d,b,f,i,c);break;case"css":h.appendCss(d,b,f,i,c);break;case"img":h.appendImg(d,b,f,i,c);break;case"html":h.appendHtml(d,b,f,i,c)}},m=function(a,b){var f,g=c.storage.resourceDefaults,h=parseInt(b.lifetime,10),i=b.version,j=!0,k=!1;return a.version=f=a.version!==d?parseFloat(a.version):g.version,a.group=a.group!==d?parseFloat(a.group):g.group,a.lastmod&&b&&b.lastmod?(a.lastmod=parseInt(a.lastmod,10),j=b.lastmod===a.lastmod):a.lastmod=!a.lastmod&&b&&b.lastmod?b.lastmod:g.lastmod,k=j&&f===i,0!==h&&(-1!==h&&k&&b.expires>e||-1===h&&k)},n=function(a){var b=a.data||null,e=function(a,b){a&&a.data?i(a,a.data,b):i(a,null,b)},g=c.storage,h=g.resourceDefaults;a.ajax=a.ajax!==d?!!a.ajax:h.ajax,g.read(a,function(c){return c&&c.data?!m(a,c)&&j.isOnline()?(k("["+f+" controller] Resource is outdated and needs update: type "+a.type+", url "+a.url),g.update(a,e),void 0):(k("["+f+" controller] Resource is up to date: type "+a.type+", url "+a.url),b=c.data,b&&i(a,b),void 0):(k("["+f+" controller] Resource or resource data is not available in storage adapter: type "+a.type+", url "+a.url),g.create(a,e),void 0)})},o=function(a,b){var c=0,d=a.length,e=null;for(g.init(d,b),c=0;d>c;c+=1)e=a[c],e&&e.url&&n(e)},p=function(a){var b,c,d,e=[],f=0,g=a.length;for(f=0;g>f;f+=1)c=a[f],d=c.group,d||(d=0),b=e[d]?e[d]:e[d]=[],b.push(c);return e},q=function(a,b,c){var d,e=a.length;for(c||(c=0);!a[c]&&e>c;)c+=1;return c>=e?(b(),void 0):(d=a[c],o(d,function(){q(a,b,c+1)}),void 0)};k("["+f+" controller] Load resource function called: resources count "+a.length),q(p(a),l(b))},init:function(a,b){var d,e=this;a=l(a),k("["+f+" controller] Cache initializing and checking for storage adapters"),d=new c.cache.storage.controller(function(b){e.storage=b,a(b)},b)}},c.namespace("cache.controller",e)}(window,document,window.getNamespace()),function(a,b){"use strict";function c(a){this.controller=null,this.storage=null,this.params=a,this.queue=new k,this.calls=0}function d(a){var b,d=null,e=l.length;for(a||(a={}),b=0;e>b;b+=1)j(l[b].params)===j(a)&&(d=l[b]);return d||(d=new c(a),l.push(d)),d}var e,f=b.cache.controller,g=b.helpers,h=g.utils,i=h.isArray,j=h.jsonToString,k=g.queue,l=[];
e=function(b,c,e){var g=d(e),h=function(a,b){var c;i(a)?g.controller.load(a,b):"applicationCache"===a&&(c=g.storage,c&&c.appCacheAdapter?c.appCacheAdapter.open(b,e):b())};return g.storage?h(b,c,e):(g.queue.add(function(){h(b,c,e)}),g.calls=g.calls+1,1===g.calls&&(g.controller=new f(function(b){g.storage=b,g.controller?g.queue.flush(this):g.interval=a.setInterval(function(){g.controller&&(a.clearInterval(g.interval),g.queue.flush(this))},25)},e))),this},b.namespace("cache.load",e)}(window,window.getNamespace()),function(a,b,c){"use strict";var d=c.helpers,e=c.helpers.utils,f=e.logTimerStart,g=e.logTimerEnd,h=e.on;h(a,"load",function(){f("Page css and js files loaded"),f("Page images loaded"),f("Html loaded"),f("Application Cache loaded");var h=a.baseurl||e.url(a.location.pathname).folder,i=0,j=b.getElementById("layer-loading"),k=function(){i+=1,2===i&&j&&(j.style.display="none")};c.cache.load("applicationCache",function(){g("Application Cache loaded"),k()},{progress:function(a){var c=b.getElementById("layer-progress-value");c&&d.dom.setAttribute(c,"value",a)}}),c.cache.load([{url:h+"css/app.css",type:"css"},{url:h+"js/lib.js",type:"js"},{url:h+"js/app.js",type:"js",group:1}],function(){g("Page css and js files loaded"),k()}),c.cache.load([{url:h+"assets/img/content/410x144/test-1.jpg",type:"img",node:{id:"image-1"}},{url:h+"assets/img/content/410x144/test-2.jpg",type:"img",node:{id:"image-2"}},{url:h+"assets/img/content/410x144/test-3.jpg",type:"img",node:{id:"image-3"}}],function(){g("Page images loaded")}),c.cache.load([{url:h+"ajax.html",type:"html",node:{id:"ajax"}}],function(){g("Html loaded")})})}(window,document,window.getNamespace());