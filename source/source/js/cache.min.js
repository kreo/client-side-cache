(function(c,h,r){h.namespace=function(c,f){if(c){c=String(c);var e=c.split("."),q=e.length,n=h,l;if(!e)return!1;for(l=0;l<q;l+=1)n[e[l]]||(n[e[l]]={},l===q-1&&f&&(n[e[l]]=f)),n=n[e[l]];return n}return!1};c.app=h})(window,window.app||{});(function(c,h,r,p){var f=function(){var e=null,q=c.console!==p&&c.console.log,n=c.console!==p&&console.time!==p&&console.timeEnd!==p,l=[];return{logToScreen:function(b){var a=h.getElementById("log"),d=h.createElement("p");b=h.createTextNode(b);a&&(d.appendChild(b),a.appendChild(d))},log:function(b){q&&c.console.log(b);f.logToScreen(b)},logTimerStart:function(b){n&&c.console.time(b)},logTimerEnd:function(b){n&&c.console.timeEnd(b)},callback:function(b){b&&"function"===typeof b||(b=function(){});return b},
on:function(b,a,d){f.on="function"===typeof c.addEventListener?function(g,s,b){g.addEventListener(s,b,!1)}:"function"===typeof h.attachEvent?function(g,b,a){g.attachEvent("on"+b,a)}:function(g,b,a){g["on"+b]=a};f.on(b,a,d)},off:function(b,a,d){f.off="function"===typeof c.removeEventListener?function(g,b,a){g.removeEventListener(b,a,!1)}:"function"===typeof h.detachEvent?function(b,a,d){b.detachEvent("on"+a,d)}:function(b,a){b["on"+a]=null};f.off(b,a,d)},getXhr:function(){for(var b=null,a=[function(){return new XMLHttpRequest},
function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],d=a.length,g=0,g=0;g<d;g+=1){try{b=a[g]()}catch(s){continue}break}return b},xhr:function(b,a,d,g){c.setTimeout(function(){var s=f.getXhr(),u,c="GET";a=f.callback(a);s?b?(g!==p?c="POST":g=null,d===p&&(d=!0),u=function(){if(4===s.readyState&&(200<=s.status&&400>s.status||0===s.status))try{var b=s.responseText;b?a(b):a(!1)}catch(g){a(!1)}},
s.open(c,b,d),s.onreadystatechange!==p?s.onreadystatechange=u:s.onload!==p&&(s.onload=u),s.send(g)):a(!1):a(!1)},0)},getJson:function(){null===e&&(c.JSON&&c.JSON.stringify)&&(e=c.JSON);return e},jsonToString:function(b){var a=!1;null===e&&(e=f.getJson());e&&b&&(a=e.stringify(b));return a},jsonToObject:function(b){var a=!1;null===e&&(e=f.getJson());e&&b&&(a=e.parse(b));return a},url:function(b){if(b){var a=h.createElement("a"),d;a.href=b;d=a.pathname.match(/\/([^\/?#]+)$/i);var g=a.protocol,s=a.hostname,
u=a.port,c=a.search;d=d?d[1]:"/";var m=a.hash,a=a.pathname.replace(/^([^\/])/,"/$1"),k=b.lastIndexOf("/"),k=b.substr(0,k+1);return{source:b,protocol:g,host:s,port:u,query:c,file:d,hash:m,path:a,folder:k}}},isArray:function(b){return b instanceof Array},inArray:function(b,a,d){return Array.prototype.indexOf?l.indexOf.call(a,b,d):-1}}}();r.namespace("helpers.utils",f)})(window,document,window.app||{});(function(c,h){function r(){this.methods=[];this.response=null;this.flushed=!1}r.prototype=r.fn={add:function(c){this.flushed?c(this.response):this.methods.push(c)},flush:function(c){if(!this.flushed)for(this.response=c,this.flushed=!0;this.methods[0];)this.methods.shift()(c)}};c.namespace("helpers.queue",r)})(window.app||{});(function(c,h,r,p){var f=function(){function e(){l===p&&(g(c,"online",e),g(c,"offline",e));l=h.onLine!==p?!!h.onLine:!0}function f(){var a=h.connection||h.mozConnection||h.webkitConnection||{type:0,UNKNOWN:0,ETHERNET:1,WIFI:2,CELL_2G:3,CELL_3G:4},g=function(){b=a};a.onchange=g;g()}var n,l,b,a,d=h.userAgent||h.vendor||c.opera,g=r.helpers.utils.on;return{isMobile:function(){n===p&&(n=!1,/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(d)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(d.substr(0,
4)))&&(n=!0);return n},isOnline:function(){l===p&&e();return l},getNetworkConnection:function(){b===p&&f();return b},isStandalone:function(){return h.standalone!==p&&h.standalone},hasCanvas:function(){if(a===p){var b=document.createElement("canvas");a=!(!b.getContext||!b.getContext("2d"))}return a}}}();r.namespace("helpers.client",f)})(window,window.navigator,window.app||{});(function(c,h,r){function p(e,f){f&&(f.dom?e=f.dom:f.id&&(e=c.getElementById(f.id)));return e}var f=function(){var e=h.helpers,q=e.utils,n=e.client,l=[],b=[],a=[],d=[],g=c.getElementsByTagName("head")[0];return{createDomNode:function(b,a){var g=c.createElement(b),d;if(a)for(d in a)a.hasOwnProperty(d)&&g.setAttribute(d,a[d]);return g},hasClass:function(b,a){return RegExp(" "+a+" ").test(" "+b.className+" ")},getAttribute:function(b,a){return b.getAttribute(a)},appendCss:function(b,a,d,m){if(-1===q.inArray(b,
l)){var k,e;k=p(null,m);if(null!==a){k||(k=f.createDomNode("style",{type:"text/css"}));m||g.appendChild(k);try{e=c.createTextNode(a),k.appendChild(e)}catch(A){k.styleSheet.cssText=a}finally{d()}}else null!==b&&(k||(k=f.createDomNode("link",{rel:"stylesheet",type:"text/css"})),m||g.appendChild(k),n.isMsie||n.isOpera?k.onload=d:d(),k.href=b);l.push(b)}else d()},appendJs:function(a,d,e,m){if(-1===q.inArray(a,b)){var k=f.createDomNode("script"),n=c.getElementsByTagName("script")[0],l=!1,k=p(k,m);k.type=
"text/javascript";k.async=!0;k.onreadystatechange=k.onload=function(){l||this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||(this.onreadystatechange=this.onload=null,l=!0,b.push(a),e())};k.onerror&&(k.onerror=function(){this.onload=this.onreadystatechange=this.onerror=null;e()});m||(n?n.parentNode.insertBefore(k,n):g.appendChild(k));d&&!l?(k.textContent?k.textContent=d:k.nodeValue?k.nodeValue=d:k.text=d,l=!0):null!==a&&(k.src=a);l&&(b.push(a),e())}else e()},appendImg:function(b,
g,d,c){(c=p(null,c))||(c=new Image);c.onload=d;g?c.src=g:b&&(c.src=b);a.push(b)},appendHtml:function(b,a,g,m){var k;if(k=p(null,m)){if(a)try{k.innerHTML=a,m.id&&c.styleSheets[0].addRule("#"+m.id+":after","content: ' ';")}catch(e){k.innerText=a}g();d.push(b)}else g()}}}();h.namespace("helpers.dom",f)})(document,window.app||{});(function(c,h,r){function p(a){var d="";switch(a.code){case FileError.QUOTA_EXCEEDED_ERR:d="["+n+" Adapter] File System Event: QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:d="["+n+" Adapter] File System Event: NOT_FOUND_ERR, file does not exist";break;case FileError.SECURITY_ERR:d="["+n+" Adapter] File System Event: SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:d="["+n+" Adapter] File System Event: INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:d="["+n+" Adapter] File System Event: INVALID_STATE_ERR";
break;default:d="["+n+" Adapter] File System Event: Unknown Error"}b(d)}function f(b,a,d){if("."===a[0]||""===a[0])a=a.slice(1);a[0]?b.getDirectory(a[0],{create:!0},function(b){a.length?f(b,a.slice(1),d):d()},p):d()}function e(b,d,c){d=d.split("/");var e=d.length,m="",k=0;c=a(c);if(e){for(k=0;k<e-1;k+=1)m=m+d[k]+"/";f(b.root,m.split("/"),c)}else c()}function q(a){this.adapter=null;this.type=n;this.size=52428800;this.init(a)}var n="fileSystem",l=h.helpers.utils,b=l.log,a=l.callback,d=null;q.prototype=
q.fn={isSupported:function(){null===d&&((d=(!!c.requestFileSystem||!!c.webkitRequestFileSystem)&&!!c.Blob)||b("["+n+" Adapter] "+n+" is not supported"));return d},open:function(a){var d=this,e=d.adapter;null===e?(c.requestFileSystem=c.requestFileSystem||c.webkitRequestFileSystem,c.requestFileSystem(c.TEMPORARY,d.size,function(c){e=d.adapter=c;b("["+n+" Adapter] Try to create test resource");try{d.create("test-item",l.jsonToString({test:"test-content"}),function(k){k?d.remove("test-item",function(){b("["+
n+" Adapter] Test resource created and successfully deleted");a(e)}):a(!1)})}catch(m){p(m),a(!1)}},p)):a(e)},create:function(a,b,d){var c=this.adapter,m=function(a){p(a);d(!1,a)};e(c,a,function(){c.root.getFile(a,{create:!0},function(a){a.createWriter(function(a){a.onwriteend=function(){d(!0)};a.onerror=m;try{var g=new Blob([b],{type:"text/plain"});a.write(g)}catch(c){m(c)}},m)},m)})},read:function(a,b){var d=this.adapter,c=function(a){p(a);b(!1,a)};e(d,a,function(){d.root.getFile(a,{create:!1},function(a){a.file(function(a){var d=
new FileReader;d.onloadend=function(){b(this.result)};d.readAsText(a)},c)},c)})},update:function(a,b,d){this.create(a,b,d)},remove:function(a,b){var d=this.adapter,c=function(d){p(d);b(a,d)};e(d,a,function(){d.root.getFile(a,{create:!1},function(a){a.remove(function(){b()},c)},c)})},init:function(a){return this.isSupported()?(a&&a.size&&(this.size=a.size),this):!1}};h.namespace("cache.storage.adapter."+n,q)})(window,window.app||{});(function(c,h,r){function p(c){this.adapter=null;this.type=f;this.dbName="merkel";this.dbVersion="1.0";this.dbTable="offline";this.dbDescription="Local cache";this.dbKey="key";this.init(c)}var f="indexedDatabase",e=h.helpers.utils.log,q=null;p.prototype=p.fn={isSupported:function(){null===q&&((q=!!c.indexedDB||!!c.webkitIndexedDB||!!c.mozIndexedDB||!!c.OIndexedDB||!!c.msIndexedDB)||e("["+f+" Adapter] "+f+" is not supported"));return q},create:function(c,l,b){var a=this.dbTable,d=this.dbName,g=this.adapter.transaction([a],
"readwrite");c=g.objectStore(a).put({key:c,content:l});g.onerror=function(a){e("["+f+" Adapter] Failed to init transaction while creating/updating database entry "+d+" "+a);b(!1,a)};c.onerror=function(a){e("["+f+" Adapter] Failed to create/update database entry "+d+" "+a);b(!1,a)};c.onsuccess=function(){b(!0)}},read:function(c,l){var b=this.dbTable,a=this.dbName,d=this.adapter.transaction([b],"readonly"),b=d.objectStore(b).get(c);d&&b?(d.onerror=function(b){e("["+f+" Adapter] Failed to init transaction while reading database "+
a+" "+b)},b.onerror=function(b){e("["+f+" Adapter] Failed to read database entry "+a+" "+b);l(!1,b)},b.onsuccess=function(a){a.target.result&&a.target.result.content?l(a.target.result.content):l(!1)}):l(!1)},update:function(c,e,b){this.create(c,e,b)},remove:function(c,l){var b=this.dbTable,a=this.dbName,d=this.adapter.transaction([b],"readwrite"),b=d.objectStore(b)(b).put({key:c,content:""});d.onerror=function(b){e("["+f+" Adapter] Failed to init transaction while deleting database entry "+a+" "+
b);l(!1,b)};b.onerror=function(b){e("["+f+" Adapter] Failed to delete database entry "+a+" "+b);l(!1,b)};b.onsuccess=function(){l(!0)}},open:function(n,l){var b=this,a=null,d=null,g=null,s=b.dbName,p=b.dbTable,h,m,k,q;l||(l=!1);if(null===b.adapter)if(a=c.indexedDB||c.webkitIndexedDB||c.mozIndexedDB||c.OIndexedDB||c.msIndexedDB){c.webkitIndexedDB!==r&&(c.IDBTransaction=c.webkitIDBTransaction,c.IDBKeyRange=c.webkitIDBKeyRange);h=function(a){var c=d.result;b.adapter=c;b.dbVersion===c.version||!c.setVersion&&
"function"!==typeof c.setVersion?n(c):(g=a.currentTarget.result.setVersion(b.dbVersion),g.onfailure=function(a){e("["+f+" Adapter] Failed to open database: "+s+" "+a);n(!1)},g.onsuccess=function(a){var c=d.result.createObjectStore(p,{keyPath:b.dbKey});e("["+f+" Adapter] Database needs upgrade: "+s+" "+a.oldVersion+" "+a.newVersion);c.createIndex("key","key",{unique:!0});c.createIndex("content","content",{unique:!1})})};m=function(a){var c=d.result.createObjectStore(p,{keyPath:b.dbKey});e("["+f+" Adapter] Database needs upgrade: "+
s+" "+a.oldVersion+" "+a.newVersion);c.createIndex("key","key",{unique:!0});c.createIndex("content","content",{unique:!1})};k=function(a){e("["+f+" Adapter] Failed to open database: "+s+" "+a);l||b.open(n,!0);n(!1)};q=function(a){e("["+f+" Adapter] Opening database request is blocked! "+s+" "+a);n(!1)};if(l)try{d=a.open(s,b.dbVersion)}catch(A){e(A),d=a.open(s)}else d=a.open(s);d.onsuccess=h;d.onupgradeneeded=m;d.onerror=k;d.onblocked=q}else n(!1);else n(b.adapter)},init:function(c){return this.isSupported()?
(c&&(c.name&&(this.dbName=c.name),c.version&&(this.dbVersion=c.version),c.table&&(this.dbTable=c.table),c.description&&(this.dbDescription=c.description),c.key&&(this.dbKey=c.key)),this):!1}};h.namespace("cache.storage.adapter."+f,p)})(window,window.app||{});(function(c,h,r){function p(b,a,d,c,e,f){!f&&b?b.transaction(function(b){b.executeSql(a,d,c,e)}):f?f.executeSql(a,d,c,e):e(null,{code:0,message:"The storage adapter isn't available"})}function f(b){var a="["+q+" Adapter] Errorcode: "+b.code+", Message: "+b.message;b.info&&(a=a+" - "+b.info);n(a)}function e(b){this.adapter=null;this.type=q;this.dbName="merkel";this.dbVersion="1.0";this.dbDescription="resource cache";this.dbTable="cache";this.dbSize=4194304;this.init(b)}var q="webSqlDatabase",n=h.helpers.utils.log,
l=null;e.prototype=e.fn={isSupported:function(){null===l&&((l=!!c.openDatabase)||n("["+q+" Adapter] "+q+" is not supported"));return l},create:function(b,a,d){p(this.adapter,"INSERT INTO "+this.dbTable+" (key, content) VALUES (?,?);",[b,a],function(){d(!0)},function(a,b){f(b);d(!1,b,{transaction:a})})},read:function(b,a){p(this.adapter,"SELECT content FROM "+this.dbTable+" WHERE key=?;",[b],function(b,c){var e=null;c&&(c.rows&&1===c.rows.length)&&(e=c.rows.item(0).content);a(e,null,{transaction:b})},
function(b,c){f(c);a(!1,c,{transaction:b})})},update:function(b,a,d){p(this.adapter,"UPDATE "+this.dbTable+" SET content = ?  WHERE key=?;",[a,b],function(){d(!0)},function(a,b){f(b);d(!1,b,{transaction:a})})},remove:function(b,a){p(this.adapter,"DELETE FROM "+this.dbTable+" WHERE key = ?;",[b],function(){a(!0)},function(b,c){f(c);a(!1,c,{transaction:b})})},open:function(b){var a=this,d=a.adapter,g=function(c,d){p(c,"CREATE TABLE IF NOT EXISTS "+a.dbTable+"(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, key TEXT NOT NULL UNIQUE, content TEXT NOT NULL);",
[],function(){b(c)},function(a){f(a);b(!1)},d)},e=function(a){g(null,a)},l=function(a){a.info="Can't migrate to new database version and using localStorage instead. This may be caused by non-standard implementation of the changeVersion method. Please switch back your database version to use webSql on this device.";f(a);b(!1)};try{if(null===d&&a.isSupported())if(a.adapter=d=c.openDatabase(a.dbName,"",a.dbDescription,a.dbSize),String(d.version)!==String(a.dbVersion)&&d.changeVersion&&"function"===typeof d.changeVersion)try{d.changeVersion(d.version,
a.dbVersion,e,l)}catch(n){f(n),b(!1)}else d=c.openDatabase(a.dbName,a.dbVersion,a.dbDescription,a.dbSize),g(d);else a.isSupported()&&b(d)}catch(m){f(m),b(!1)}},init:function(b){return this.isSupported()?(b&&(b.description&&(this.dbDescription=b.description),b.name&&(this.dbName=b.name),b.size&&(this.dbSize=b.size),b.table&&(this.dbTable=b.table),b.version&&(this.dbVersion=String(b.version))),this):!1}};h.namespace("cache.storage.adapter."+q,e)})(window,window.app||{});(function(c,h,r){function p(a){!a&&c.event&&(a=c.event);l("["+q+" Adapter] Event - key: "+(a.key||"no e.key event")+", url: "+(a.url||"no e.url event"))}function f(a){var b="localStorage";switch(a){case "local":b="localStorage";break;case "session":b="sessionStorage"}return b}function e(a){this.adapter=null;this.type=q;this.lifetime="local";this.init(a)}var q="webStorage";r=h.helpers.utils;var n=r.on,l=r.log,b=null;e.prototype=e.fn={isSupported:function(){var a=f(this.lifetime);if(null===b)try{b=
!!c[a]&&!!c[a].getItem}catch(d){l("["+q+" Adapter] "+q+" is not supported"),b=!1}return b},create:function(a,b,c){try{this.adapter.setItem(a,b),c(!0)}catch(e){p(e),c(!1,e)}},read:function(a,b){var c;try{(c=this.adapter.getItem(a))?b(c):b(!1)}catch(e){p(e),b(!1,e)}},update:function(a,b,c){this.create(a,b,c)},remove:function(a,b){try{this.adapter.removeItem(a),b(a)}catch(c){p(c),b(!1,c)}},open:function(a){var b=this,e=b.adapter,h=f(b.lifetime);if(null===e)try{e=b.adapter=c[h],n(c,"storage",p),l("["+
q+" Adapter] Try to create test resource"),b.create("test-item",'{test: "test-content"}',function(c){c?b.remove("test-item",function(){l("["+q+" Adapter] Test resource created and successfully deleted");a(e)}):a(!1)})}catch(u){a(!1)}else b.isSupported()&&a(e)},init:function(a){return this.isSupported()?(a&&a.lifetime&&(this.lifetime=a.lifetime),this):!1}};h.namespace("cache.storage.adapter."+q,e)})(window,window.app||{});(function(c,h,r,p){function f(){this.adapter=null;this.type=e;this.isLoaded=!1;this.delay=25;this.init()}var e="applicationCache",q=r.helpers,n=q.utils,l=q.dom,b=n.on,a=n.log,d=n.callback,g=null,s=h.getElementsByTagName("html")[0];f.prototype=f.fn={isSupported:function(){null===g&&((g=!!c.applicationCache&&!!l.getAttribute(s,"manifest"))||a("["+e+" Adapter] "+e+" is not supported or there is no manifest html attribute"));return g},loaded:function(a){this.isLoaded||(this.isLoaded=!0,c.setTimeout(function(){a()},
this.delay))},open:function(g){var f=this,m=f.adapter,k=0,l;g=d(g);if(f.isSupported()&&null!==m){l=function(){a("["+e+" Adapter] Event updateready");try{m.swapCache()}catch(b){a("["+e+" Adapter] Event updateready: swapcache is not available")}confirm("A new version of this website is available. Do you want to an update?")?c.location.reload(!0):f.loaded(g);return!1};b(m,"checking",function(){a("["+e+" Adapter] Event checking");return!1});b(m,"noupdate",function(){a("["+e+" Adapter] Event noupdate");
f.loaded(g);return!1});b(m,"downloading",function(){a("["+e+" Adapter] Event downloading");k=0;return!1});b(m,"progress",function(b){a("["+e+" Adapter] Event progress");var c="",d=h.getElementById("layer-loading-bar");f.delay=500;k+=1;c=b&&b.lengthComputable!==p?" "+Math.round(100*b.loaded/b.total)+"%":" "+Math.round(100*k/20)+"%";d&&(d.style.width=c);return!1});b(m,"cached",function(){a("["+e+" Adapter] Event cached");f.loaded(g);return!1});b(m,"updateready",function(){l()});b(m,"obsolete",function(){a("["+
e+" Adapter] Event obsolete");c.location.reload(!0);return!1});b(m,"error",function(){a("["+e+" Adapter] Event error");f.loaded(g);return!1});switch(m.status){case m.UNCACHED:f.loaded(g);break;case m.IDLE:f.loaded(g);break;case m.UPDATEREADY:l();break;case m.OBSOLETE:f.loaded(g)}b(c,"online",function(){try{m.update()}catch(b){a("["+e+" Adapter] Window event online: update cache is not available")}});c.setTimeout(function(){f.isLoaded||f.loaded(g)},12E3)}else f.loaded(g)},init:function(){var a=this.adapter;
this.isSupported()&&null===a&&(this.adapter=c.applicationCache);return this}};r.namespace("cache.storage.adapter."+e,f)})(window,document,window.app||{});(function(c,h,r){function p(a,b,c){c.timeout=window.setTimeout(function(){b(!1)},3E4);A(a,function(a){window.clearTimeout(c.timeout);delete c.timeout;a?b(a):b(!1)})}function f(a){return w.jsonToString(a)}function e(a){var b=null;try{b=w.jsonToObject(a)}catch(c){m("["+g+" controller] Couldn't convert json string to object."+c)}return b}function q(a,b,d){if(u.hasCanvas()){var e=c.createElement("canvas"),k,g=new Image,f=null,m=0,l=0;d||(d="jpeg");g.onload=function(){m=e.height=g.height;l=e.width=g.width;
(k=e.getContext("2d"))||b(!1);k.fillStyle="rgba(50, 50, 50, 0)";k.fillRect(0,0,l,m);k.drawImage(g,0,0);f=e.toDataURL("image/"+d);b(f)};g.src=a}else b(!1)}function n(a){return{ajax:a.ajax,data:a.data,expires:(new Date).getTime()+(a.lifetime||v.lifetime),group:a.group||v.group,lastmod:a.lastmod||v.lastmod,lifetime:a.lifetime||v.lifetime,type:a.type||v.type,version:a.version||v.version}}function l(a){return z&&z[a]?!!z[a]:!1}function b(a,c){var d=null,e;a&&a.length?(e=a[0].type,m("["+g+" controller] Testing for storage adapter type: "+
e),x[e]?d=new x[e](t):b(a.slice(1),c),d&&d.isSupported()?d.open(function(k){k?(y=e,z=a[0],m("["+g+" controller] Used storage adapter type: "+y),c(d)):b(a.slice(1),c)}):b(a.slice(1),c)):y||c(!1)}function a(c,d){var e=null,k=0,f;if(d)try{m("["+g+" controller] Testing for storage adapter type: "+d),x[d]?e=new x[d](t):a(c),e&&e.isSupported()?e.open(function(b){if(b){y=d;f=B.length;for(k=0;k<f;k+=1)B[k].type===d&&(z=B[k]);z?(m("["+g+" controller] Used storage type: "+y),c(e)):(m("["+g+" controller] Storage config not found: "+
y),a(c))}else a(c)}):a(c)}catch(l){m("["+g+" controller] Storage adapter could not be initialized: type "+d),a(c)}else b(B,c)}function d(a,b){this.isEnabled=!0;this.adapter=null;this.adapters={types:B,defaults:t};this.appCacheAdapter=null;this.resourceDefaults=v;this.init(a,b)}var g="storage",s=h.helpers,u=s.client,w=s.utils,m=w.log,k=w.callback,C=w.getJson(),A=w.xhr,x=h.cache.storage.adapter,B=[{type:"fileSystem",css:!0,js:!0,html:!0,img:!0},{type:"indexedDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webSqlDatabase",
css:!0,js:!0,html:!0,img:!1},{type:"webStorage",css:!0,js:!0,html:!1,img:!1}],t={name:"localcache",table:"cache",description:"local resource cache",size:4194304,version:"1.0",key:"key",lifetime:"local",offline:!0},y=null,z=null,v={ajax:!0,lifetime:2E4,group:0,lastmod:(new Date).getTime(),type:"css",version:1};d.prototype=d.fn={create:function(a,b){var c=this,d=a.url,e=a.type,h=function(k){if(k)if(a.data=k,null!==c.adapter&&l(e)){k=f(d);var h=f(n(a));try{c.adapter.create(k,h,function(c){c?(m("["+g+
" controller] Create new resource in storage adapter: type "+e+", url "+d),b(a)):(m("["+g+" controller] Create new resource in storage adapter failed"),b(!1))})}catch(p){b(a)}}else m("["+g+" controller] Trying to create new resource, but resource type is not cachable or storage adapter is not available: type "+e+", url "+d),b(a);else m("["+g+" controller] Couldn't get data via network"),b(!1)};b=k(b);a.ajax?"img"===e?q(d,h):p(d,h,a):a.data?h(a.data):b(!1)},read:function(a,b){var c=this,d=a.url,n=
a.type;b=k(b);if(null!==this.adapter&&l(n)){m("["+g+" controller] Trying to read resource from storage: type "+n+", url "+d);try{c.adapter.read(f(d),function(k){k?(a=e(k))?(a.url=d,m("["+g+" controller] Successfully read resource from storage: type "+n+", url "+d),b(a)):c.adapter.remove(f(d),function(){m("["+g+" controller] Resource deleted from storage adapter to create a new one: type "+n+", url "+d);b(!1)}):(m("["+g+" controller] There is no data coming back from storage while reading: type "+
n+", url "+d),b(!1))})}catch(h){p(d,function(c){a.data=c;m("["+g+" controller] Try to read resource from storage, but storage adapter is not available: type "+n+", url "+d);b(a)},a)}}else b(a)},update:function(a,b){var c=this,d=a.url,e=a.type,h=function(k){if(k)if(a.data=k,null!==c.adapter&&l(e)){k=f(d);var h=f(n(a));try{c.adapter.update(k,h,function(c){c?(m("["+g+" controller] Update existing resource in storage adapter: type "+e+", url "+d),b(a)):(m("["+g+" controller] Updating resource in storage failed."),
b(!1))})}catch(p){b(a)}}else m("["+g+" controller] Resource type is not cachable or storage adapter is not available: type "+e+", url "+d),b(a);else m("["+g+" controller] Couldn't get data via network, trying to used stored version"),c.read(a,function(c){c&&!c.data?(a.data=c.data,b(a)):b(!1)})};b=k(b);a.ajax?"img"===a.type?q(d,h):A(d,h):a.data?h(a.data):b(!1)},remove:function(a,b){var c=a.url,d=a.type;b=k(b);null!==this.adapter&&l(d)?this.adapter.remove(f(c),function(k){(a=e(k))?(a.url=c,m("["+g+
" controller] Delete resource form storage: type "+d+", url "+c),b(a)):b(!1)}):(m("["+g+" controller] Delete resource from storage failed, resource type is not cachable or there is no storage adapter: type "+d+", url "+c),b(a))},init:function(b,c){var d=this,e=!1;c&&c.isEnabled!==r&&(d.isEnabled=!!c.isEnabled);d.isEnabled&&C?(c&&(c.description&&(t.description=String(c.description)),c.key&&(t.key=String(c.key)),c.lifetime&&(t.lifetime=String(c.lifetime)),c.name&&(t.name=String(c.name)),c.size&&(t.size=
parseInt(c.size,10)),c.table&&(t.table=String(c.table)),c.type&&(t.type=e=String(c.type)),c.offline&&(t.offline=Boolean(c.offline)),c.version&&(t.version=String(c.version))),t.offline&&x.applicationCache&&(d.appCacheAdapter=new x.applicationCache(t)),a(function(a){d.adapter=a;b(d)},e)):(C||m("["+g+" controller] There is no json support"),d.isEnabled||m("["+g+" controller] Caching data is disabled"),b(d))}};h.namespace("cache.storage.controller",d)})(document,window.app||{});(function(c,h,r,p){function f(c,b){this.storage=null;this.init(c,b)}c=r.helpers;var e=c.dom;c=c.utils;var q=c.log,n=c.callback;f.prototype=f.fn={load:function(c,b){var a=this,d=(new Date).getTime(),g=function(){var a=0,b=0,c=null;return{init:function(d,e){c=e;a=d;b=0},loaded:function(){b+=1;b===a&&c()}}}(),f=function(a,b){var c=a.url,d=function(){g.loaded()},f=a.node||null;switch(a.type){case "js":e.appendJs(c,b,d,f);break;case "css":e.appendCss(c,b,d,f);break;case "img":e.appendImg(c,b,d,f);break;
case "html":e.appendHtml(c,b,d,f)}},h=function(b){var c=b.data||null,e=function(a){a&&a.data?f(a,a.data):f(a)},g=a.storage,m=g.resourceDefaults,l=!0,h,n,r;b.version=r=b.version!==p?parseFloat(b.version):m.version;b.group=b.group!==p?parseFloat(b.group):m.group;b.ajax=b.ajax!==p?!!b.ajax:m.ajax;g.read(b,function(a){b.lastmod&&a&&a.lastmod?(b.lastmod=parseInt(b.lastmod,10),l=a.lastmod===b.lastmod):b.lastmod=!b.lastmod&&a&&a.lastmod?a.lastmod:m.lastmod;a&&a.data?(h=parseInt(a.lifetime,10),n=a.version,
-1!==h&&l&&r===n&&a.expires>d||-1===h&&l&&r===n?(q("[cache controller] Resource is up to date: type "+b.type+", url "+b.url),(c=a.data)&&f(b,c)):(q("[cache controller] Resource is outdated and needs update: type "+b.type+", url "+b.url),g.update(b,e))):(q("[cache controller] Resource or resource data is not available in storage adapter: type "+b.type+", url "+b.url),g.create(b,e))})},r=function(a,b){var c=0,d=a.length,e=null;g.init(d,b);for(c=0;c<d;c+=1)(e=a[c])&&e.url&&h(e)},m=function(a,b,c){var d=
a.length;for(c||(c=0);!a[c]&&c<d;)c+=1;c>=d?b():(d=a[c],r(d,function(){m(a,b,c+1)}))};q("[cache controller] Load resource function called: resources count "+c.length);m(function(a){for(var b=[],c,d=0,e,g=a.length,d=0;d<g;d+=1)e=a[d],(c=e.group)||(c=0),c=b[c]?b[c]:b[c]=[],c.push(e);return b}(c),n(b))},init:function(c,b){var a=this;c=n(c);q("[cache controller] Cache initializing and checking for storage adapters");new r.cache.storage.controller(function(b){a.storage=b;c(b)},b)}};r.namespace("cache.controller",
f)})(window,document,window.app||{});(function(c,h,r){function p(a){this.storage=this.controller=null;this.params=a;this.queue=new b;this.calls=0}function f(b){var c=null,e,f=a.length;b||(b={});for(e=0;e<f;e+=1)l(a[e].params)===l(b)&&(c=a[e]);c||(c=new p(b),a.push(c));return c}var e=h.cache.controller;r=h.helpers;var q=r.utils,n=q.isArray,l=q.jsonToString,b=r.queue,a=[];h.namespace("cache.load",function(a,b,l){var h=f(l),p=function(a,b,c){n(a)?h.controller.load(a,b):"applicationCache"===a&&((a=h.storage)&&a.appCacheAdapter?a.appCacheAdapter.open(b):
b())};h.storage?p(a,b,l):(h.queue.add(function(){p(a,b,l)}),h.calls+=1,1===h.calls&&(h.controller=new e(function(a){h.storage=a;h.controller?h.queue.flush(this):h.interval=c.setInterval(function(){h.controller&&(c.clearInterval(h.interval),h.queue.flush(this))},25)},l)));return this})})(window,window.app||{});
