(function(b,m,s){function f(b,e){if(b){var f=(b+"").split("."),k=f.length,h=m,a;for(a=0;a<k;a+=1)h[f[a]]||(h[f[a]]={},a===k-1&&e&&(h[f[a]]=e)),h=h[f[a]];return h}return!1}f("namespace",f);b.app=m})(window,window.app||{});(function(b,m,s,f){var g=function(){var e=null,q=b.console!==f&&b.console.log,k=b.console!==f&&console.time!==f&&console.timeEnd!==f,h=[];return{logToScreen:function(a){var c=m.getElementById("log"),d=m.createElement("p");a=m.createTextNode(a);c&&(d.appendChild(a),c.appendChild(d))},log:function(a){q&&b.console.log(a);g.logToScreen(a)},logTimerStart:function(a){k&&b.console.time(a)},logTimerEnd:function(a){k&&b.console.timeEnd(a)},on:function(a,c,d){g.on="function"===typeof b.addEventListener?function(n,
a,c){n.addEventListener(a,c,!1)}:"function"===typeof m.attachEvent?function(a,c,d){a.attachEvent("on"+c,d)}:function(a,c,d){a["on"+c]=d};g.on(a,c,d)},off:function(a,c,d){g.off="function"===typeof b.removeEventListener?function(a,c,d){a.removeEventListener(c,d,!1)}:"function"===typeof m.detachEvent?function(a,c,d){a.detachEvent("on"+c,d)}:function(a,c){a["on"+c]=null};g.off(a,c,d)},createDomNode:function(a,c){var d=m.createElement(a),n;if(c)for(n in c)c.hasOwnProperty(n)&&d.setAttribute(n,c[n]);return d},
getXhr:function(){for(var a=null,c=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],d=c.length,n=0,n=0;n<d;n+=1){try{a=c[n]()}catch(t){continue}break}return a},xhr:function(a,c,d){var n=g.getXhr(),t,b="GET";n?(d!==f?b="POST":d=null,t=function(){if(4===n.readyState&&(200<=n.status&&400>n.status||0===n.status))try{var a=n.responseText;a?c(a):
c(!1)}catch(d){c(!1)}},n.open(b,a,!0),n.onreadystatechange!==f?n.onreadystatechange=t:n.onload!==f&&(n.onload=t),n.send(d)):c(!1)},getJson:function(){null===e&&(b.JSON&&b.JSON.stringify)&&(e=b.JSON);return e},jsonToString:function(a){var c=!1;null===e&&(e=g.getJson());e&&a&&(c=e.stringify(a));return c},jsonToObject:function(a){var c=!1;null===e&&(e=g.getJson());e&&a&&(c=e.parse(a));return c},url:function(a){if(a){var c=m.createElement("a"),d;c.href=a;d=c.pathname.match(/\/([^\/?#]+)$/i);var n=c.protocol,
t=c.hostname,b=c.port,e=c.search;d=d?d[1]:"/";var p=c.hash,c=c.pathname.replace(/^([^\/])/,"/$1"),l=a.lastIndexOf("/"),l=a.substr(0,l+1);return{source:a,protocol:n,host:t,port:b,query:e,file:d,hash:p,path:c,folder:l}}},callback:function(a){a&&"function"===typeof a||(a=function(){});return a},isArray:function(a){return a instanceof Array},inArray:function(a,c,d){return Array.prototype.indexOf?h.indexOf.call(c,a,d):-1},hasClass:function(a,c){return RegExp(" "+c+" ").test(" "+a.className+" ")}}}();s.namespace("helpers.utils",
g)})(window,document,window.app||{});(function(b,m,s,f){function g(){this._methods=[];this.response=null;this._flushed=!1}g.prototype={add:function(b){this._flushed?b(this.response):this._methods.push(b)},flush:function(b){if(!this._flushed)for(this.response=b,this._flushed=!0;this._methods[0];)this._methods.shift()(b)}};s.namespace("helpers.queue",g)})(window,navigator,window.app||{});(function(b,m,s,f){var g=function(){function e(){switch(parseInt(b.orientation,10)){case 0:w=A;break;case 180:w=A;break;case 90:w=B;break;case -90:w=B}}function g(){var a=m.connection||m.mozConnection||m.webkitConnection||{type:0,UNKNOWN:0,ETHERNET:1,WIFI:2,CELL_2G:3,CELL_3G:4},c=function(){u=a};a.onchange=c;c()}var k,h,a,c,d,n,t,z,r,p,l,y,x,C,u,B="landscapeMode",A="portraitMode",w,E,F,v=m.userAgent||m.vendor||b.opera,D=s.helpers.utils.on;return{isiOS:function(){k===f&&(k=null!==v.toLowerCase().match(/(iphone|ipod|ipad)/))&&
D(b,"orientationchange",e);return k},isWebkit:function(){h===f&&(h=null!==v.toLowerCase().match(/(webkit)/));return h},isAndroid:function(){a===f&&(a=null!==v.toLowerCase().match(/(android)/))&&D(b,"orientationchange",e);return a},isBlackberry:function(){c===f&&(c=null!==v.toLowerCase().match(/(blackberry)/))&&D(b,"orientationchange",e);return c},isChrome:function(){n===f&&(n=null!==v.toLowerCase().match(/(chrome)/));return n},isOpera:function(){d===f&&(d=null!==v.toLowerCase().match(/(opera)/));
return d},isSafari:function(){t===f&&(t=null!==v.toLowerCase().match(/(safari)/));return t},isFirefox:function(){z===f&&(z=null!==v.toLowerCase().match(/(firefox)/));return z},isSeamonkey:function(){r===f&&(r=null!==v.toLowerCase().match(/(seamonkey)/));return r},isCamino:function(){p===f&&(p=null!==v.toLowerCase().match(/(camino)/));return p},isMsie:function(){l===f&&(l=null!==v.toLowerCase().match(/(msie)/));return l},isiPad:function(){y===f&&(y=null!==v.toLowerCase().match(/(ipad)/))&&D(b,"orientationchange",
e);return y},isMobile:function(){if(x===f){x=!1;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(v)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(v.substr(0,
4)))x=!0;x&&D(b,"orientationchange",e)}return x},getBrowserVersion:function(){if(C===f){var a,c;(c=v.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i))&&null!==(a=v.match(/version\/([\.\d]+)/i))&&(c[2]=a[1]);C=c?c[2]:m.appVersion}return C},getNetworkConnection:function(){u===f&&g();return u},isStandalone:function(){return m.standalone!==f&&m.standalone},isOnline:function(){return m.onLine},orientation:function(){return b.orientation?b.orientation:0},orientationMode:function(){w===
f&&e();return w},hasRetinaDisplay:function(){return 2<=b.devicePixelRatio},hasCanvas:function(){if(E===f){var a=document.createElement("canvas");E=!(!a.getContext||!a.getContext("2d"))}return E},hideStatusbar:function(a){a||(a=0);b.clearTimeout(F);F=b.setTimeout(function(){0===parseInt(b.pageYOffset,10)&&b.scrollTo(0,1)},a)}}}();s.namespace("helpers.client",g)})(window,navigator,window.app||{});(function(b,m,s){function f(f,e){e&&(e.dom?f=e.dom:e.id&&(f=b.getElementById(e.id)));return f}s=function(){var g=m.helpers,e=g.utils,q=e.createDomNode,k=g.client,h=[],a=[],c=[],d=[],n=b.getElementsByTagName("head")[0];return{appendCss:function(a,c,d,p){if(-1===e.inArray(a,h)){var l,y;l=f(null,p);if(null!==c){l||(l=q("style",{type:"text/css"}));p||n.appendChild(l);try{y=b.createTextNode(c),l.appendChild(y)}catch(g){l.styleSheet.cssText=c}finally{d()}}else null!==a&&(l||(l=q("link",{rel:"stylesheet",
type:"text/css"})),p||n.appendChild(l),k.isMsie||k.isOpera?l.onload=d:d(),l.href=a);h.push(a)}else d()},appendJs:function(c,d,k,p){if(-1===e.inArray(c,a)){var l=q("script"),h=b.getElementsByTagName("script")[0],g=!1,l=f(l,p);l.type="text/javascript";l.async=!0;l.onreadystatechange=l.onload=function(){g||this.readyState&&"complete"!==this.readyState&&"loaded"!==this.readyState||(this.onreadystatechange=this.onload=null,g=!0,a.push(c),k())};l.onerror&&(l.onerror=function(){this.onload=this.onreadystatechange=
this.onerror=null;k()});p||(h?h.parentNode.insertBefore(l,h):n.appendChild(l));d&&!g?(l.textContent?l.textContent=d:l.nodeValue?l.nodeValue=d:l.text=d,g=!0):null!==c&&(l.src=c);g&&(a.push(c),k())}else k()},appendImg:function(a,n,d,b){(b=f(null,b))||(b=new Image);b.onload=d;n?b.src=n:a&&(b.src=a);c.push(a)},appendHtml:function(a,c,n,p){var l;if(l=f(null,p)){if(c)try{l.innerHTML=c,p.id&&b.styleSheets[0].addRule("#"+p.id+":after","content: ' ';")}catch(k){l.innerText=c}n();d.push(a)}else n()}}}();m.namespace("helpers.append",
s)})(document,window.app||{});(function(b,m,s){function f(c){var d="";switch(c.code){case FileError.QUOTA_EXCEEDED_ERR:d="["+k+" Adapter] File System Event: QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:d="["+k+" Adapter] File System Event: NOT_FOUND_ERR, file does not exist";break;case FileError.SECURITY_ERR:d="["+k+" Adapter] File System Event: SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:d="["+k+" Adapter] File System Event: INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:d="["+k+" Adapter] File System Event: INVALID_STATE_ERR";
break;default:d="["+k+" Adapter] File System Event: Unknown Error"}a(d)}function g(a,c,d){if("."===c[0]||""===c[0])c=c.slice(1);c[0]?a.getDirectory(c[0],{create:!0},function(a){c.length?g(a,c.slice(1),d):d()},f):d()}function e(a,d,b){d=d.split("/");var k=d.length,p="",l=0;b=c(b);if(k){for(l=0;l<k-1;l+=1)p=p+d[l]+"/";g(a.root,p.split("/"),b)}else b()}function q(a){this.adapter=null;this.type=k;this.size=52428800;this.init(a)}var k="fileSystem",h=m.helpers.utils,a=h.log,c=h.callback,d=null;q.prototype=
q.fn={isSupported:function(){null===d&&((d=(!!b.requestFileSystem||!!b.webkitRequestFileSystem)&&!!b.Blob)||a("["+k+" Adapter] "+k+" is not supported"));return d},open:function(c){var d=this,e=d.adapter;null===e?(b.requestFileSystem=b.requestFileSystem||b.webkitRequestFileSystem,b.requestFileSystem(b.TEMPORARY,d.size,function(b){e=d.adapter=b;a("["+k+" Adapter] Try to create test resource");try{d.create("test-item",h.jsonToString({test:"test-content"}),function(b){b?d.remove("test-item",function(){a("["+
k+" Adapter] Test resource created and successfully deleted");c(e)}):c(!1)})}catch(p){f(p),c(!1)}},f)):c(e)},create:function(a,c,d){var b=this.adapter,k=function(a){f(a);d(!1,a)};e(b,a,function(){b.root.getFile(a,{create:!0},function(a){a.createWriter(function(a){a.onwriteend=function(){d(!0)};a.onerror=k;try{var n=new Blob([c],{type:"text/plain"});a.write(n)}catch(b){k(b)}},k)},k)})},read:function(a,c){var d=this.adapter,b=function(a){f(a);c(!1,a)};e(d,a,function(){d.root.getFile(a,{create:!1},function(a){a.file(function(a){var d=
new FileReader;d.onloadend=function(){c(this.result)};d.readAsText(a)},b)},b)})},update:function(a,c,d){this.create(a,c,d)},remove:function(a,c){var d=this.adapter,b=function(d){f(d);c(a,d)};e(d,a,function(){d.root.getFile(a,{create:!1},function(a){a.remove(function(){c()},b)},b)})},init:function(a){return this.isSupported()?(a&&a.size&&(this.size=a.size),this):!1}};m.namespace("cache.storage.adapter."+k,q)})(window,window.app||{});(function(b,m,s){function f(b){this.adapter=null;this.type=g;this.dbName="merkel";this.dbVersion="1.0";this.dbTable="offline";this.dbDescription="Local cache";this.dbKey="key";this.init(b)}var g="indexedDatabase",e=m.helpers.utils.log,q=null;f.prototype=f.fn={isSupported:function(){null===q&&((q=!!b.indexedDB||!!b.webkitIndexedDB||!!b.mozIndexedDB||!!b.OIndexedDB||!!b.msIndexedDB)||e("["+g+" Adapter] "+g+" is not supported"));return q},create:function(b,f,a){var c=this.dbTable,d=this.dbName,n=this.adapter.transaction([c],
"readwrite");b=n.objectStore(c).put({key:b,content:f});n.onerror=function(c){e("["+g+" Adapter] Failed to init transaction while creating/updating database entry "+d+" "+c);a(!1,c)};b.onerror=function(c){e("["+g+" Adapter] Failed to create/update database entry "+d+" "+c);a(!1,c)};b.onsuccess=function(){a(!0)}},read:function(b,f){var a=this.dbTable,c=this.dbName,d=this.adapter.transaction([a],"readonly"),a=d.objectStore(a).get(b);d&&a?(d.onerror=function(a){e("["+g+" Adapter] Failed to init transaction while reading database "+
c+" "+a)},a.onerror=function(a){e("["+g+" Adapter] Failed to read database entry "+c+" "+a);f(!1,a)},a.onsuccess=function(a){a.target.result&&a.target.result.content?f(a.target.result.content):f(!1)}):f(!1)},update:function(b,e,a){this.create(b,e,a)},remove:function(b,f){var a=this.dbTable,c=this.dbName,d=this.adapter.transaction([a],"readwrite"),a=d.objectStore(a)(a).put({key:b,content:""});d.onerror=function(a){e("["+g+" Adapter] Failed to init transaction while deleting database entry "+c+" "+
a);f(!1,a)};a.onerror=function(a){e("["+g+" Adapter] Failed to delete database entry "+c+" "+a);f(!1,a)};a.onsuccess=function(){f(!0)}},open:function(f,h){var a=this,c=null,d=null,n=null,t=a.dbName,m=a.dbTable,r,p,l,y;h||(h=!1);if(null===a.adapter)if(c=b.indexedDB||b.webkitIndexedDB||b.mozIndexedDB||b.OIndexedDB||b.msIndexedDB){b.webkitIndexedDB!==s&&(b.IDBTransaction=b.webkitIDBTransaction,b.IDBKeyRange=b.webkitIDBKeyRange);r=function(c){var b=d.result;a.adapter=b;a.dbVersion===b.version||!b.setVersion&&
"function"!==typeof b.setVersion?f(b):(n=c.currentTarget.result.setVersion(a.dbVersion),n.onfailure=function(a){e("["+g+" Adapter] Failed to open database: "+t+" "+a);f(!1)},n.onsuccess=function(c){var b=d.result.createObjectStore(m,{keyPath:a.dbKey});e("["+g+" Adapter] Database needs upgrade: "+t+" "+c.oldVersion+" "+c.newVersion);b.createIndex("key","key",{unique:!0});b.createIndex("content","content",{unique:!1})})};p=function(c){var b=d.result.createObjectStore(m,{keyPath:a.dbKey});e("["+g+" Adapter] Database needs upgrade: "+
t+" "+c.oldVersion+" "+c.newVersion);b.createIndex("key","key",{unique:!0});b.createIndex("content","content",{unique:!1})};l=function(c){e("["+g+" Adapter] Failed to open database: "+t+" "+c);h||a.open(f,!0);f(!1)};y=function(a){e("["+g+" Adapter] Opening database request is blocked! "+t+" "+a);f(!1)};if(h)try{d=c.open(t,a.dbVersion)}catch(x){e(x),d=c.open(t)}else d=c.open(t);d.onsuccess=r;d.onupgradeneeded=p;d.onerror=l;d.onblocked=y}else f(!1);else f(a.adapter)},init:function(b){return this.isSupported()?
(b&&(b.name&&(this.dbName=b.name),b.version&&(this.dbVersion=b.version),b.table&&(this.dbTable=b.table),b.description&&(this.dbDescription=b.description),b.key&&(this.dbKey=b.key)),this):!1}};m.namespace("cache.storage.adapter."+g,f)})(window,window.app||{});(function(b,m,s){function f(a,c,d,b,f,e){!e&&a?a.transaction(function(a){a.executeSql(c,d,b,f)}):e?e.executeSql(c,d,b,f):f(null,{code:0,message:"The storage adapter isn't available"})}function g(a){var c="["+q+" Adapter] Errorcode: "+a.code+", Message: "+a.message;a.info&&(c=c+" - "+a.info);k(c)}function e(a){this.adapter=null;this.type=q;this.dbName="merkel";this.dbVersion="1.0";this.dbDescription="resource cache";this.dbTable="cache";this.dbSize=4194304;this.init(a)}var q="webSqlDatabase",k=m.helpers.utils.log,
h=null;e.prototype=e.fn={isSupported:function(){null===h&&((h=!!b.openDatabase)||k("["+q+" Adapter] "+q+" is not supported"));return h},create:function(a,c,d){f(this.adapter,"INSERT INTO "+this.dbTable+" (key, content) VALUES (?,?);",[a,c],function(){d(!0)},function(a,c){g(c);d(!1,c,{transaction:a})})},read:function(a,c){f(this.adapter,"SELECT content FROM "+this.dbTable+" WHERE key=?;",[a],function(a,b){var f=null;b&&(b.rows&&1===b.rows.length)&&(f=b.rows.item(0).content);c(f,null,{transaction:a})},
function(a,b){g(b);c(!1,b,{transaction:a})})},update:function(a,c,d){f(this.adapter,"UPDATE "+this.dbTable+" SET content = ?  WHERE key=?;",[c,a],function(){d(!0)},function(a,c){g(c);d(!1,c,{transaction:a})})},remove:function(a,c){f(this.adapter,"DELETE FROM "+this.dbTable+" WHERE key = ?;",[a],function(){c(!0)},function(a,b){g(b);c(!1,b,{transaction:a})})},open:function(a){var c=this,d=c.adapter,e=function(b,d){f(b,"CREATE TABLE IF NOT EXISTS "+c.dbTable+"(id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, key TEXT NOT NULL UNIQUE, content TEXT NOT NULL);",
[],function(){a(b)},function(c){g(c);a(!1)},d)},k=function(a){e(null,a)},h=function(c){c.info="Can't migrate to new database version and using localStorage instead. This may be caused by non-standard implementation of the changeVersion method. Please switch back your database version to use webSql on this device.";g(c);a(!1)};try{if(null===d&&c.isSupported())if(c.adapter=b.openDatabase(c.dbName,"",c.dbDescription,c.dbSize),String(c.adapter.version)!==String(c.dbVersion)&&c.adapter.changeVersion&&
"function"===typeof c.adapter.changeVersion)try{c.adapter.changeVersion(c.adapter.version,c.dbVersion,k,h)}catch(m){g(m),a(!1)}else c.adapter=b.openDatabase(c.dbName,c.dbVersion,c.dbDescription,c.dbSize),e(c.adapter);else c.isSupported()&&a(d)}catch(p){g(p),a(!1)}},init:function(a){return this.isSupported()?(a&&(a.description&&(this.dbDescription=a.description),a.name&&(this.dbName=a.name),a.size&&(this.dbSize=a.size),a.table&&(this.dbTable=a.table),a.version&&(this.dbVersion=String(a.version))),
this):!1}};m.namespace("cache.storage.adapter."+q,e)})(window,window.app||{});(function(b,m,s){function f(a){!a&&b.event&&(a=b.event);h("["+q+" Adapter] Event - key: "+(a.key||"no e.key event")+", url: "+(a.url||"no e.url event"))}function g(a){var b="localStorage";switch(a){case "local":b="localStorage";break;case "session":b="sessionStorage"}return b}function e(a){this.adapter=null;this.type=q;this.lifetime="local";this.init(a)}var q="webStorage";s=m.helpers.utils;var k=s.on,h=s.log,a=null;e.prototype=e.fn={isSupported:function(){var c=g(this.lifetime);if(null===a)try{a=
!!b[c].getItem}catch(d){h("["+q+" Adapter] "+q+" is not supported"),a=!1}return a},create:function(a,b,e){try{this.adapter.setItem(a,b),e(!0)}catch(k){f(k),e(!1,k)}},read:function(a,b){var e;try{(e=this.adapter.getItem(a))?b(e):b(!1)}catch(k){f(k),b(!1,k)}},update:function(a,b,f){this.create(a,b,f)},remove:function(a,b){try{this.adapter.removeItem(a),b(a)}catch(e){f(e),b(!1,e)}},open:function(a){var d=this,e=d.adapter,m=g(d.lifetime);if(null===e)try{e=d.adapter=b[m],k(b,"storage",f),h("["+q+" Adapter] Try to create test resource"),
d.create("test-item",'{test: "test-content"}',function(b){b?d.remove("test-item",function(){h("["+q+" Adapter] Test resource created and successfully deleted");a(e)}):a(!1)})}catch(z){a(!1)}else d.isSupported()&&a(e)},init:function(a){return this.isSupported()?(a&&a.lifetime&&(this.lifetime=a.lifetime),this):!1}};m.namespace("cache.storage.adapter."+q,e)})(window,window.app||{});(function(b,m,s,f){function g(){this.adapter=null;this.type=e;this.isLoaded=!1;this.delay=25;this.init()}var e="applicationCache",q=s.helpers.utils,k=q.on,h=q.log,a=q.callback,c=null,d=m.getElementsByTagName("html")[0];g.prototype=g.fn={isSupported:function(){null===c&&((c=!!b.applicationCache&&!!d.getAttribute("manifest"))||h("["+e+" Adapter] "+e+" is not supported"));return c},loaded:function(a){this.isLoaded||(this.isLoaded=!0,b.setTimeout(function(){a()},this.delay))},open:function(c){var d=this,
g=d.adapter,q=0,p;c=a(c);if(d.isSupported()&&null!==g){p=function(){h("["+e+" Adapter] Event updateready");try{g.swapCache()}catch(a){h("["+e+" Adapter] Event updateready: swapcache is not available")}confirm("A new version of this website is available. Do you want to an update?")?b.location.reload(!0):d.loaded(c);return!1};k(g,"checking",function(){h("["+e+" Adapter] Event checking");return!1});k(g,"noupdate",function(){h("["+e+" Adapter] Event noupdate");d.loaded(c);return!1});k(g,"downloading",
function(){h("["+e+" Adapter] Event downloading");q=0;return!1});k(g,"progress",function(a){h("["+e+" Adapter] Event progress");var c="",b=m.getElementById("layer-loading-bar");d.delay=500;q+=1;c=a&&a.lengthComputable!==f?" "+Math.round(100*a.loaded/a.total)+"%":" "+Math.round(100*q/20)+"%";b&&(b.style.width=c);return!1});k(g,"cached",function(){h("["+e+" Adapter] Event cached");d.loaded(c);return!1});k(g,"updateready",function(){p()});k(g,"obsolete",function(){h("["+e+" Adapter] Event obsolete");
b.location.reload(!0);return!1});k(g,"error",function(){h("["+e+" Adapter] Event error");d.loaded(c);return!1});switch(g.status){case g.UNCACHED:d.loaded(c);break;case g.IDLE:d.loaded(c);break;case g.UPDATEREADY:p();break;case g.OBSOLETE:d.loaded(c)}k(b,"online",function(){try{g.update()}catch(a){h("["+e+" Adapter] Window event online: update cache is not available")}});b.setTimeout(function(){d.isLoaded||d.loaded(c)},12E3)}else d.loaded(c)},init:function(){var a=this.adapter;this.isSupported()&&
null===a&&(this.adapter=b.applicationCache);return this}};s.namespace("cache.storage.adapter."+e,g)})(window,document,window.app||{});(function(b,m,s){function f(a){return z.jsonToString(a)}function g(a){var c=null;try{c=z.jsonToObject(a)}catch(b){r("["+d+" controller] Couldn't convert json string to object."+b)}return c}function e(a,c,d){if(t.hasCanvas()){var e=b.createElement("canvas"),f,g=new Image,p=null,k=0,l=0;d||(d="jpeg");g.onload=function(){k=e.height=g.height;l=e.width=g.width;f=e.getContext("2d");f.fillStyle="rgba(50, 50, 50, 0)";f.fillRect(0,0,l,k);f.drawImage(g,0,0);p=e.toDataURL("image/"+d);c(p)};g.src=a}else c(!1)}
function q(a){return{data:a.data,lifetime:a.lifetime||w.lifetime,expires:(new Date).getTime()+(a.lifetime||w.lifetime),group:a.group||w.group,lastmod:a.lastmod||w.lastmod,type:a.type||w.type,version:a.version||w.version}}function k(a){return A&&A[a]?!!A[a]:!1}function h(a,c){var b=null,e;a&&a.length?(e=a[0].type,r("["+d+" controller] Testing for storage adapter type: "+e),x[e]?b=new x[e](u):h(a.slice(1),c),b&&b.isSupported()?b.open(function(f){f?(B=e,A=a[0],r("["+d+" controller] Used storage adapter type: "+
B),c(b)):h(a.slice(1),c)}):h(a.slice(1),c)):B||c(!1)}function a(c,b){var e=null,f=0,g;if(b)try{r("["+d+" controller] Testing for storage adapter type: "+b),x[b]?e=new x[b](u):a(c),e&&e.isSupported()?e.open(function(p){if(p){B=b;g=C.length;for(f=0;f<g;f+=1)C[f].type===b&&(A=C[f]);A?(r("["+d+" controller] Used storage type: "+B),c(e)):(r("["+d+" controller] Storage config not found: "+B),a(c))}else a(c)}):a(c)}catch(p){r("["+d+" controller] Storage adapter could not be initialized: type "+b),a(c)}else h(C,
c)}function c(a,c){this.isEnabled=!0;this.appCacheAdapter=this.adapter=null;this.resourceDefaults=w;this.init(a,c)}var d="storage",n=m.helpers,t=n.client,z=n.utils,r=z.log,p=z.callback,l=z.getJson(),y=z.xhr,x=m.cache.storage.adapter,C=[{type:"fileSystem",css:!0,js:!0,html:!0,img:!0},{type:"indexedDatabase",css:!0,js:!0,html:!0,img:!0},{type:"webSqlDatabase",css:1,js:1,html:1,img:0},{type:"webStorage",css:!0,js:!0,html:!1,img:!1}],u={name:"localcache",table:"cache",description:"local resource cache",
size:4194304,version:"1.0",key:"key",lifetime:"local",offline:!0},B=null,A=null,w={lifetime:1E4,group:0,lastmod:(new Date).getTime(),type:"css",version:1};c.prototype=c.fn={create:function(a,c){var b=this,g=a.url,l=a.type,h=function(e){a.data=e;if(null!==b.adapter&&k(l)){e=f(g);var p=f(q(a));try{b.adapter.create(e,p,function(b){b?(r("["+d+" controller] Create new resource in storage adapter: type "+l+", url "+g),c(a)):(r("["+d+" controller] Create new resource in storage adapter failed"),c(!1))})}catch(h){c(a)}}else r("["+
d+" controller] Trying to create new resource, but resource type is not cachable or storage adapter is not available: type "+l+", url "+g),c(a)};c=p(c);"img"===l?e(g,h):y(g,h)},read:function(a,c){var b=this,e=a.url,l=a.type;c=p(c);if(null!==this.adapter&&k(l)){r("["+d+" controller] Trying to read resource from storage: type "+l+", url "+e);try{b.adapter.read(f(e),function(p){p?(a=g(p))?(a.url=e,r("["+d+" controller] Successfully read resource from storage: type "+l+", url "+e),c(a)):b.adapter.remove(f(e),
function(){r("["+d+" controller] Resource deleted from storage adapter to create a new one: type "+l+", url "+e);c(!1)}):(r("["+d+" controller] There is no data coming back from storage while reading: type "+l+", url "+e),c(!1))})}catch(h){y(e,function(b){a.data=b;r("["+d+" controller] Try to read resource from storage, but storage adapter is not available: type "+l+", url "+e);c(a)})}}else c(a)},update:function(a,c){var b=this,g=a.url,l=a.type,h=function(e){a.data=e;if(null!==b.adapter&&k(l)){e=
f(g);var p=f(q(a));try{b.adapter.update(e,p,function(b){b?(r("["+d+" controller] Update existing resource in storage adapter: type "+l+", url "+g),c(a)):(r("["+d+" controller] Updating resource in storage failed."),c(!1))})}catch(h){c(a)}}else r("["+d+" controller] Resource type is not cachable or storage adapter is not available: type "+l+", url "+g),c(a)};c=p(c);"img"===a.type?e(g,h):y(g,h)},remove:function(a,c){var b=a.url,e=a.type;c=p(c);null!==this.adapter&&k(e)?this.adapter.remove(f(b),function(f){(a=
g(f))?(a.url=b,r("["+d+" controller] Delete resource form storage: type "+e+", url "+b),c(a)):c(!1)}):(r("["+d+" controller] Delete resource from storage failed, resource type is not cachable or there is no storage adapter: type "+e+", url "+b),c(a))},init:function(c,b){var e=this,f=!1;b&&b.isEnabled!==s&&(e.isEnabled=!!b.isEnabled);e.isEnabled&&l?(b&&(b.description&&(u.description=String(b.description)),b.key&&(u.key=String(b.key)),b.lifetime&&(u.lifetime=String(b.lifetime)),b.name&&(u.name=String(b.name)),
b.size&&(u.size=parseInt(b.size,10)),b.table&&(u.table=String(b.table)),b.type&&(u.type=f=String(b.type)),b.version&&(u.version=b.version),b.offline&&(u.offline=b.offline)),u.offline&&x.applicationCache&&(e.appCacheAdapter=new x.applicationCache(u)),a(function(a){e.adapter=a;c(e)},f)):(l||r("["+d+" controller] There is no json support"),e.isEnabled||r("["+d+" controller] Caching data is disabled"),c(e))}};m.namespace("cache.storage.controller",c)})(document,window.app||{});(function(b,m,s,f){b=s.helpers;var g=b.append;b=b.utils;var e=b.log,q=b.callback;b={};b={storage:null,load:function(b,f){var a=this,c=(new Date).getTime(),d=function(){var a=0,c=0,b=null;return{init:function(d,e){b=e;a=d;c=0},loaded:function(){c+=1;c===a&&b()}}}(),n=function(a,c){var b=a.url,e=function(){d.loaded()},f=a.node||null;switch(a.type){case "js":g.appendJs(b,c,e,f);break;case "css":g.appendCss(b,c,e,f);break;case "img":g.appendImg(b,c,e,f);break;case "html":g.appendHtml(b,c,e,f)}},m=function(b){var d=
null,f=function(a){a&&a.data?n(a,a.data):n(a)},g=a.storage.resourceDefaults,k=!0;b.version=b.version?parseFloat(b.version):g.version;b.group=b.group?parseFloat(b.group):g.group;a.storage.read(b,function(h){b.lastmod&&h&&h.lastmod?(b.lastmod=parseInt(b.lastmod,10),k=h.lastmod===b.lastmod):b.lastmod=!b.lastmod&&h&&h.lastmod?h.lastmod:g.lastmod;if(h&&h.data){if(-1!==parseInt(h.lifetime,10)&&k&&b.version===h.version&&h.expires>c)e("[cache controller] Resource is up to date: type "+b.type+", url "+b.url),
d=h.data;else if(-1===parseInt(h.lifetime,10)&&k&&b.version===h.version)e("[cache controller] Resource is up to date: type "+b.type+", url "+b.url),d=h.data;else{e("[cache controller] Resource is outdated and needs update: type "+b.type+", url "+b.url);a.storage.update(b,f);return}d&&n(b,d)}else e("[cache controller] Resource or resource data is not available in storage adapter: type "+b.type+", url "+b.url),a.storage.create(b,f)})},s=function(a,b){var c=0,e=a.length,f=null;d.init(e,b);for(c=0;c<
e;c+=1)(f=a[c])&&f.url&&m(f)},r=function(a,b,c){var d=a.length;for(c||(c=0);!a[c]&&c<d;)c+=1;c>=d?b():(d=a[c],s(d,function(){r(a,b,c+1)}))};e("[cache controller] Load resource function called: resources count "+b.length);r(function(a){for(var b=[],c,d=0,e,f=a.length,d=0;d<f;d+=1)e=a[d],(c=e.group)||(c=0),c=b[c]?b[c]:b[c]=[],c.push(e);return b}(b),q(f))},init:function(b,f){var a=this;b=q(b);e("[cache controller] Cache initializing and checking for storage adapters");new s.cache.storage.controller(function(c){a.storage=
c;b(c)},f)}};s.namespace("cache.controller",b)})(window,document,window.app||{});(function(b,m,s){var f=m.cache.controller,g=m.helpers.utils.isArray,e=new m.helpers.queue,q=0,k=null;m.namespace("cacheLoad",function(b,a,c){var d=function(a,b,c){g(a)?f.load(a,b):"applicationCache"===a&&(k.appCacheAdapter?k.appCacheAdapter.open(b):b())};k?d(b,a,c):(e.add(function(){d(b,a,c)}),q+=1,1===q&&f.init(function(a){k=a;e.flush(this)},c));return this})})(window,window.app||{});
